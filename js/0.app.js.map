{"version":3,"sources":["webpack:///./src/js/utils/orbitControls.js","webpack:///./src/js/data/config.js","webpack:///./src/js/utils/detector.js","webpack:///./src/js/app/components/renderer.js","webpack:///./src/js/app/components/camera.js","webpack:///./src/js/app/components/light.js","webpack:///./src/js/app/components/controls.js","webpack:///./src/js/app/components/material.js","webpack:///./src/js/app/components/geometry.js","webpack:///./src/js/data/globalVars.js","webpack:///./src/js/app/classes/waist.js","webpack:///./src/js/data/math2.js","webpack:///./src/js/app/classes/arm.js","webpack:///./src/js/app/classes/leg.js","webpack:///./src/js/app/classes/head.js","webpack:///./src/js/app/components/walkman.js","webpack:///./src/js/app/components/cinemachine.js","webpack:///./src/js/app/helpers/stats.js","webpack:///./src/js/app/helpers/vertexNormalsHelper.js","webpack:///./src/js/app/loaders/GLTFLoader.js","webpack:///./src/js/app/managers/datGUI.js","webpack:///./src/js/app/main.js","webpack:///./src/js/app/components/ui.js","webpack:///./src/js/app.js"],"names":["module","exports","THREE","MOUSE","OrbitConstraint","object","this","target","Vector3","minDistance","maxDistance","Infinity","minZoom","maxZoom","minPolarAngle","maxPolarAngle","Math","PI","minAzimuthAngle","maxAzimuthAngle","enableDamping","dampingFactor","theta","phi","v","offset","quat","quatInverse","lastPosition","lastQuaternion","scope","EPS","phiDelta","thetaDelta","scale","panOffset","zoomChanged","getPolarAngle","getAzimuthalAngle","rotateLeft","angle","rotateUp","panLeft","distance","te","matrix","elements","set","multiplyScalar","add","panUp","pan","deltaX","deltaY","screenWidth","screenHeight","PerspectiveCamera","targetDistance","position","clone","sub","length","tan","fov","OrthographicCamera","right","left","top","bottom","console","warn","dollyIn","dollyScale","zoom","max","min","updateProjectionMatrix","dollyOut","update","Quaternion","setFromUnitVectors","up","inverse","copy","applyQuaternion","atan2","x","z","sqrt","y","radius","sin","cos","lookAt","distanceToSquared","dot","quaternion","OrbitControls","domElement","constraint","undefined","document","Object","defineProperty","get","enabled","center","enableZoom","zoomSpeed","enableRotate","rotateSpeed","enablePan","keyPanSpeed","autoRotate","autoRotateSpeed","enableKeys","keys","LEFT","UP","RIGHT","BOTTOM","mouseButtons","ORBIT","ZOOM","MIDDLE","PAN","rotateStart","Vector2","rotateEnd","rotateDelta","panStart","panEnd","panDelta","dollyStart","dollyEnd","dollyDelta","STATE","state","target0","position0","zoom0","changeEvent","type","startEvent","endEvent","element","body","clientWidth","clientHeight","getZoomScale","pow","onMouseDown","event","preventDefault","button","clientX","clientY","addEventListener","onMouseMove","onMouseUp","dispatchEvent","subVectors","removeEventListener","onMouseWheel","stopPropagation","delta","wheelDelta","detail","onKeyDown","keyCode","touchstart","touches","pageX","pageY","dx","dy","touchmove","touchend","contextmenu","reset","dispose","window","prototype","create","EventDispatcher","constructor","defineProperties","value","noZoom","noRotate","noPan","noKeys","staticMoving","dynamicDampingFactor","isDev","isShowingStats","isLoaded","isTweening","isRotating","isMouseMoving","isMouseOver","maxAnisotropy","dpr","easing","TWEEN","Easing","Quadratic","InOut","duration","model","selected","initialTypes","models","path","texture","imageFiles","name","image","mesh","enableHelper","wireframe","translucent","material","color","emissive","fog","near","camera","far","aspect","posX","posY","posZ","controls","ambientLight","directionalLight","intensity","shadow","helperEnabled","bias","mapWidth","mapHeight","pointLight","hemiLight","groundColor","canvas","CanvasRenderingContext2D","webgl","createElement","WebGLRenderingContext","getContext","e","workers","Worker","fileapi","File","FileReader","FileList","Blob","getWebGLErrorMessage","id","style","fontFamily","fontSize","fontWeight","textAlign","background","padding","width","margin","innerHTML","join","addGetWebGLMessage","parameters","parent","appendChild","Renderer","scene","container","threeRenderer","antialias","setClearColor","setPixelRatio","devicePixelRatio","shadowMap","Config","capabilities","getMaxAnisotropy","updateSize","setSize","offsetWidth","offsetHeight","render","Camera","renderer","height","threeCamera","Light","init","visible","castShadow","mapSize","directionalLightHelper","lightName","Controls","orbitControls","threeControls","Material","basic","side","standard","shading","roughness","metalness","wire","Geometry","geo","widthSegments","heightSegments","rotation","receiveShadow","t","Waist","_material","alpha","obj","lowObj","_waistGeometry","waist","upObj","_backPivot","_backGeomtry","_back","_backPivot2","_backGeomtry2","_back2","_backPivot3","_backGeomtry3","_back3","_backPivot4","_backGeomtry4","_back4","_backPivot5","_backGeomtry5","_headObj","GlobalVars","yy","a","Arm","d","Math2","_upperArmGeometry","_upperLeg","lowPivot","_lowerLegGeometry","_lowerLeg","handPivot","_fingerGeometry","_finger","_handGeometry","_hand","Leg","_upperLegGeometry","footPivot","_footGeometry","_foot","Head","_headGeometry","_head","Walkman","_waist","_leftArm","_rightArm","_leftLeg","_rightLeg","mouse","l_mouse","camX","Cinemachine","app","cam","man","camGO","mousemove","moveX","sign","innerWidth","innerHeight","rS","bS","glS","tS","Stats","start","tick","frame","end","BrowserStats","glStats","threeStats","rStats","CSSPath","userTimingAPI","values","caption","over","average","avgMs","fps","below","calls","raf","rstats","groups","fractions","base","steps","plugins","_v1","_v2","_normalMatrix","Matrix3","_keys","VertexNormalsHelper","size","hex","nNormals","objGeometry","geometry","isGeometry","faces","isBufferGeometry","attributes","normal","count","BufferGeometry","positions","Float32BufferAttribute","setAttribute","LineSegments","call","LineBasicMaterial","toneMapped","matrixAutoUpdate","idx","updateMatrixWorld","getNormalMatrix","matrixWorld","vertices","i","l","face","j","jl","vertexNormals","vertex","applyMatrix4","applyMatrix3","normalize","setXYZ","objPos","objNorm","getX","getY","getZ","needsUpdate","GLTFLoader","manager","Loader","dracoLoader","ddsLoader","GLTFRegistry","objects","key","remove","removeAll","assign","load","url","onLoad","onProgress","onError","resourcePath","LoaderUtils","extractUrlBase","itemStart","_onError","error","itemError","itemEnd","loader","FileLoader","setPath","setResponseType","crossOrigin","setWithCredentials","data","parse","gltf","setDRACOLoader","setDDSLoader","content","extensions","decodeText","Uint8Array","BINARY_EXTENSION_HEADER_MAGIC","EXTENSIONS","KHR_BINARY_GLTF","GLTFBinaryExtension","json","JSON","asset","version","Error","extensionsUsed","extensionName","extensionsRequired","KHR_LIGHTS_PUNCTUAL","GLTFLightsExtension","KHR_MATERIALS_CLEARCOAT","GLTFMaterialsClearcoatExtension","KHR_MATERIALS_UNLIT","GLTFMaterialsUnlitExtension","KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS","GLTFMaterialsPbrSpecularGlossinessExtension","KHR_DRACO_MESH_COMPRESSION","GLTFDracoMeshCompressionExtension","MSFT_TEXTURE_DDS","GLTFTextureDDSExtension","KHR_TEXTURE_TRANSFORM","GLTFTextureTransformExtension","KHR_MESH_QUANTIZATION","GLTFMeshQuantizationExtension","indexOf","GLTFParser","extension","lightDefs","lights","loadLight","lightIndex","lightNode","lightDef","Color","fromArray","range","DirectionalLight","PointLight","SpotLight","spot","innerConeAngle","outerConeAngle","penumbra","decay","Promise","resolve","getMaterialType","MeshBasicMaterial","extendParams","materialParams","materialDef","parser","pending","opacity","metallicRoughness","pbrMetallicRoughness","Array","isArray","baseColorFactor","array","baseColorTexture","push","assignTexture","all","MeshPhysicalMaterial","clearcoatFactor","clearcoat","clearcoatTexture","clearcoatRoughnessFactor","clearcoatRoughness","clearcoatRoughnessTexture","clearcoatNormalTexture","clearcoatNormalScale","BINARY_EXTENSION_CHUNK_TYPES","headerView","DataView","header","magic","slice","getUint32","chunkView","chunkIndex","byteLength","chunkLength","chunkType","contentArray","byteOffset","preload","GLTFMeshStandardSGMaterial","params","MeshStandardMaterial","isGLTFSpecularGlossinessMaterial","specularMapParsFragmentChunk","glossinessMapParsFragmentChunk","specularMapFragmentChunk","glossinessMapFragmentChunk","lightPhysicalFragmentChunk","uniforms","specular","setHex","glossiness","specularMap","glossinessMap","_extraUniforms","onBeforeCompile","shader","uniformName","fragmentShader","replace","defines","USE_GLOSSINESSMAP","USE_ROUGHNESSMAP","metalnessMap","roughnessMap","setValues","specularGlossinessParams","pbrSpecularGlossiness","diffuseFactor","diffuseTexture","glossinessFactor","specularFactor","specularGlossinessTexture","specGlossMapDef","createMaterial","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","TangentSpaceNormalMap","normalScale","displacementMap","displacementScale","displacementBias","alphaMap","envMap","envMapIntensity","refractionRatio","GLTFCubicSplineInterpolant","parameterPositions","sampleValues","sampleSize","resultBuffer","Interpolant","decodePrimitive","primitive","bufferViewIndex","bufferView","gltfAttributeMap","threeAttributeMap","attributeNormalizedMap","attributeTypeMap","attributeName","threeAttributeName","ATTRIBUTES","toLowerCase","accessorDef","accessors","componentType","WEBGL_COMPONENT_TYPES","normalized","getDependency","then","decodeDracoFile","attribute","extendTexture","transform","repeat","texCoord","source","copySampleValue_","index","result","valueSize","beforeStart_","afterEnd_","interpolate_","i1","t0","t1","stride","stride2","stride3","td","p","pp","ppp","offset1","offset0","s2","s3","s0","s1","p0","m0","p1","m1","WEBGL_CONSTANTS","5120","Int8Array","5121","5122","Int16Array","5123","Uint16Array","5125","Uint32Array","5126","Float32Array","WEBGL_FILTERS","9728","NearestFilter","9729","LinearFilter","9984","NearestMipmapNearestFilter","9985","LinearMipmapNearestFilter","9986","NearestMipmapLinearFilter","9987","LinearMipmapLinearFilter","WEBGL_WRAPPINGS","33071","ClampToEdgeWrapping","33648","MirroredRepeatWrapping","10497","RepeatWrapping","WEBGL_TYPE_SIZES","SCALAR","VEC2","VEC3","VEC4","MAT2","MAT3","MAT4","POSITION","NORMAL","TANGENT","TEXCOORD_0","TEXCOORD_1","COLOR_0","WEIGHTS_0","JOINTS_0","PATH_PROPERTIES","translation","weights","INTERPOLATION","CUBICSPLINE","LINEAR","InterpolateLinear","STEP","InterpolateDiscrete","ALPHA_MODES","MIME_TYPE_FORMATS","RGBAFormat","RGBFormat","resolveURL","test","addUnknownExtensionsToUserData","knownExtensions","objectDef","userData","gltfExtensions","assignExtrasToUserData","gltfDef","extras","updateMorphTargets","meshDef","il","morphTargetInfluences","targetNames","morphTargetDictionary","createAttributesKey","attributesKey","sort","options","cache","primitiveCache","textureLoader","TextureLoader","setCrossOrigin","fileLoader","addPrimitiveAttributes","primitiveDef","assignAttributeAccessor","accessorIndex","accessor","gltfAttributeName","indices","setIndex","box","Box3","targets","maxDisplacement","vector","setX","abs","setY","setZ","expandByVector","boundingBox","sphere","Sphere","getCenter","distanceTo","boundingSphere","computeBounds","hasMorphPosition","hasMorphNormal","pendingPositionAccessors","pendingNormalAccessors","pendingAccessor","morphPositions","morphNormals","morphAttributes","morphTargetsRelative","addMorphTargets","toTrianglesDrawMode","drawMode","getIndex","getAttribute","numberOfTriangles","newIndices","TriangleFanDrawMode","newGeometry","markDefs","getDependencies","dependencies","scenes","animations","cameras","nodeDefs","nodes","skinDefs","skins","meshDefs","meshes","meshReferences","meshUses","skinIndex","skinLength","joints","isBone","nodeIndex","nodeLength","nodeDef","skin","isSkinnedMesh","cacheKey","dependency","loadScene","loadNode","loadMesh","loadAccessor","loadBufferView","loadBuffer","loadMaterial","loadTexture","loadSkin","loadAnimation","loadCamera","defs","def","bufferIndex","bufferDef","buffers","uri","reject","bufferViewDef","bufferViews","buffer","sparse","pendingBufferViews","bufferAttribute","itemSize","TypedArray","elementBytes","BYTES_PER_ELEMENT","itemBytes","byteStride","ibSlice","floor","ibCacheKey","ib","InterleavedBuffer","InterleavedBufferAttribute","BufferAttribute","itemSizeIndices","TypedArrayIndices","byteOffsetIndices","byteOffsetValues","sparseIndices","sparseValues","setW","textureIndex","URL","self","webkitURL","textureDef","textures","textureExtensions","sourceURI","images","isObjectURL","blob","mimeType","createObjectURL","getHandler","revokeObjectURL","flipY","format","sampler","samplers","magFilter","minFilter","wrapS","wrapT","mapName","mapDef","isCompressedTexture","assignFinalMaterial","useVertexTangents","tangent","useVertexColors","useFlatShading","useSkinning","useMorphTargets","useMorphNormals","isPoints","uuid","pointsMaterial","PointsMaterial","sizeAttenuation","isLine","lineMaterial","cachedMaterial","skinning","vertexTangents","vertexColors","flatShading","morphTargets","uv2","uv","materialIndex","materialType","materials","materialExtensions","sgExtension","kmuExtension","metallicFactor","roughnessFactor","metallicRoughnessTexture","doubleSided","DoubleSide","alphaMode","transparent","depthWrite","alphaTest","alphaCutoff","normalTexture","occlusionTexture","strength","emissiveFactor","emissiveTexture","clearcoatExtension","encoding","sRGBEncoding","loadGeometries","primitives","createDracoPrimitive","dracoExtension","geometryPromise","mode","cached","promise","meshIndex","depthTest","FrontSide","results","geometries","SkinnedMesh","Mesh","skinWeight","normalizeSkinWeights","TriangleStripDrawMode","Line","LineLoop","Points","group","Group","cameraIndex","cameraDef","MathUtils","radToDeg","yfov","aspectRatio","znear","zfar","xmag","ymag","skinDef","skinEntry","inverseBindMatrices","animationIndex","animationDef","pendingNodes","pendingInputAccessors","pendingOutputAccessors","pendingSamplers","pendingTargets","channels","channel","node","input","output","inputAccessors","outputAccessors","tracks","inputAccessor","outputAccessor","TypedKeyframeTrack","updateMatrix","NumberKeyframeTrack","QuaternionKeyframeTrack","VectorKeyframeTrack","targetName","interpolation","traverse","isMesh","outputArray","scaled","track","createInterpolant","times","getValueSize","isInterpolantFactoryMethodGLTFCubicSpline","AnimationClip","instanceNum","o","light","Bone","Object3D","PropertyBinding","sanitizeNodeName","Matrix4","buildNodeHierachy","nodeId","parentObject","pendingJoints","jointNodes","bones","boneInverses","jointNode","mat","bind","Skeleton","children","child","sceneIndex","sceneDef","nodeIds","DatGUI","main","gui","dat","GUI","meshHelper","cameraFolder","addFolder","cameraFOVGui","onChange","onFinishChange","cameraAspectGui","addColor","cameraFogNearGui","density","controlsFolder","controlsAutoRotateSpeedGui","disable","unload","meshFolder","enable","ambientLightFolder","directionalLightFolder","directionalLightIntensityGui","directionalLightPositionXGui","directionalLightPositionYGui","directionalLightPositionZGui","shadowFolder","shadowNearGui","shadowFarGui","shadowTopGui","shadowRightGui","shadowBottomGui","shadowLeftGui","shadowBiasGui","pointLightFolder","pointLightIntensityGui","pointLightDistanceGui","pointLightPositionXGui","pointLightPositionYGui","pointLightPositionZGui","hemiLightFolder","hemiLightIntensityGui","hemiLightPositionXGui","hemiLightPositionYGui","hemiLightPositionZGui","destroy","vis","Main","clock","currentCam","forEach","place","make","stats","setUp","querySelector","display","man_chido","WalkMan","superman","man2","manChido2","_donutGeo","donut","switchElmnts","cinemachine","which","switchV","switchCam","requestAnimationFrame","UI","$","ready","infoDiv","html","info","css","append","Detector","getElementById"],"mappings":"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","file":"0.app.js","sourcesContent":["module.exports = function (THREE) {\r\n  var MOUSE = THREE.MOUSE;\r\n  if (!MOUSE) MOUSE = { LEFT: 0, MIDDLE: 1, RIGHT: 2 };\r\n\r\n  /**\r\n   * @author qiao / https://github.com/qiao\r\n   * @author mrdoob / http://mrdoob.com\r\n   * @author alteredq / http://alteredqualia.com/\r\n   * @author WestLangley / http://github.com/WestLangley\r\n   * @author erich666 / http://erichaines.com\r\n   */\r\n  /*global THREE, console */\r\n\r\n  function OrbitConstraint(object) {\r\n    this.object = object;\r\n\r\n    // \"target\" sets the location of focus, where the object orbits around\r\n    // and where it pans with respect to.\r\n    this.target = new THREE.Vector3();\r\n\r\n    // Limits to how far you can dolly in and out ( PerspectiveCamera only )\r\n    this.minDistance = 0;\r\n    this.maxDistance = Infinity;\r\n\r\n    // Limits to how far you can zoom in and out ( OrthographicCamera only )\r\n    this.minZoom = 0;\r\n    this.maxZoom = Infinity;\r\n\r\n    // How far you can orbit vertically, upper and lower limits.\r\n    // Range is 0 to Math.PI radians.\r\n    this.minPolarAngle = 0; // radians\r\n    this.maxPolarAngle = Math.PI; // radians\r\n\r\n    // How far you can orbit horizontally, upper and lower limits.\r\n    // If set, must be a sub-interval of the interval [ - Math.PI, Math.PI ].\r\n    this.minAzimuthAngle = -Infinity; // radians\r\n    this.maxAzimuthAngle = Infinity; // radians\r\n\r\n    // Set to true to enable damping (inertia)\r\n    // If damping is enabled, you must call controls.update() in your animation loop\r\n    this.enableDamping = false;\r\n    this.dampingFactor = 0.25;\r\n\r\n    ////////////\r\n    // internals\r\n\r\n    var scope = this;\r\n\r\n    var EPS = 0.000001;\r\n\r\n    // Current position in spherical coordinate system.\r\n    var theta;\r\n    var phi;\r\n\r\n    // Pending changes\r\n    var phiDelta = 0;\r\n    var thetaDelta = 0;\r\n    var scale = 1;\r\n    var panOffset = new THREE.Vector3();\r\n    var zoomChanged = false;\r\n\r\n    // API\r\n\r\n    this.getPolarAngle = function () {\r\n      return phi;\r\n    };\r\n\r\n    this.getAzimuthalAngle = function () {\r\n      return theta;\r\n    };\r\n\r\n    this.rotateLeft = function (angle) {\r\n      thetaDelta -= angle;\r\n    };\r\n\r\n    this.rotateUp = function (angle) {\r\n      phiDelta -= angle;\r\n    };\r\n\r\n    // pass in distance in world space to move left\r\n    this.panLeft = (function () {\r\n      var v = new THREE.Vector3();\r\n\r\n      return function panLeft(distance) {\r\n        var te = this.object.matrix.elements;\r\n\r\n        // get X column of matrix\r\n        v.set(te[0], te[1], te[2]);\r\n        v.multiplyScalar(-distance);\r\n\r\n        panOffset.add(v);\r\n      };\r\n    })();\r\n\r\n    // pass in distance in world space to move up\r\n    this.panUp = (function () {\r\n      var v = new THREE.Vector3();\r\n\r\n      return function panUp(distance) {\r\n        var te = this.object.matrix.elements;\r\n\r\n        // get Y column of matrix\r\n        v.set(te[4], te[5], te[6]);\r\n        v.multiplyScalar(distance);\r\n\r\n        panOffset.add(v);\r\n      };\r\n    })();\r\n\r\n    // pass in x,y of change desired in pixel space,\r\n    // right and down are positive\r\n    this.pan = function (deltaX, deltaY, screenWidth, screenHeight) {\r\n      if (scope.object instanceof THREE.PerspectiveCamera) {\r\n        // perspective\r\n        var position = scope.object.position;\r\n        var offset = position.clone().sub(scope.target);\r\n        var targetDistance = offset.length();\r\n\r\n        // half of the fov is center to top of screen\r\n        targetDistance *= Math.tan(((scope.object.fov / 2) * Math.PI) / 180.0);\r\n\r\n        // we actually don't use screenWidth, since perspective camera is fixed to screen height\r\n        scope.panLeft((2 * deltaX * targetDistance) / screenHeight);\r\n        scope.panUp((2 * deltaY * targetDistance) / screenHeight);\r\n      } else if (scope.object instanceof THREE.OrthographicCamera) {\r\n        // orthographic\r\n        scope.panLeft((deltaX * (scope.object.right - scope.object.left)) / screenWidth);\r\n        scope.panUp((deltaY * (scope.object.top - scope.object.bottom)) / screenHeight);\r\n      } else {\r\n        // camera neither orthographic or perspective\r\n        console.warn(\r\n          'WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.'\r\n        );\r\n      }\r\n    };\r\n\r\n    this.dollyIn = function (dollyScale) {\r\n      if (scope.object instanceof THREE.PerspectiveCamera) {\r\n        scale /= dollyScale;\r\n      } else if (scope.object instanceof THREE.OrthographicCamera) {\r\n        scope.object.zoom = Math.max(\r\n          this.minZoom,\r\n          Math.min(this.maxZoom, this.object.zoom * dollyScale)\r\n        );\r\n        scope.object.updateProjectionMatrix();\r\n        zoomChanged = true;\r\n      } else {\r\n        console.warn(\r\n          'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.'\r\n        );\r\n      }\r\n    };\r\n\r\n    this.dollyOut = function (dollyScale) {\r\n      if (scope.object instanceof THREE.PerspectiveCamera) {\r\n        scale *= dollyScale;\r\n      } else if (scope.object instanceof THREE.OrthographicCamera) {\r\n        scope.object.zoom = Math.max(\r\n          this.minZoom,\r\n          Math.min(this.maxZoom, this.object.zoom / dollyScale)\r\n        );\r\n        scope.object.updateProjectionMatrix();\r\n        zoomChanged = true;\r\n      } else {\r\n        console.warn(\r\n          'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.'\r\n        );\r\n      }\r\n    };\r\n\r\n    this.update = (function () {\r\n      var offset = new THREE.Vector3();\r\n\r\n      // so camera.up is the orbit axis\r\n      var quat = new THREE.Quaternion().setFromUnitVectors(object.up, new THREE.Vector3(0, 1, 0));\r\n      var quatInverse = quat.clone().inverse();\r\n\r\n      var lastPosition = new THREE.Vector3();\r\n      var lastQuaternion = new THREE.Quaternion();\r\n\r\n      return function () {\r\n        var position = this.object.position;\r\n\r\n        offset.copy(position).sub(this.target);\r\n\r\n        // rotate offset to \"y-axis-is-up\" space\r\n        offset.applyQuaternion(quat);\r\n\r\n        // angle from z-axis around y-axis\r\n\r\n        theta = Math.atan2(offset.x, offset.z);\r\n\r\n        // angle from y-axis\r\n\r\n        phi = Math.atan2(Math.sqrt(offset.x * offset.x + offset.z * offset.z), offset.y);\r\n\r\n        theta += thetaDelta;\r\n        phi += phiDelta;\r\n\r\n        // restrict theta to be between desired limits\r\n        theta = Math.max(this.minAzimuthAngle, Math.min(this.maxAzimuthAngle, theta));\r\n\r\n        // restrict phi to be between desired limits\r\n        phi = Math.max(this.minPolarAngle, Math.min(this.maxPolarAngle, phi));\r\n\r\n        // restrict phi to be betwee EPS and PI-EPS\r\n        phi = Math.max(EPS, Math.min(Math.PI - EPS, phi));\r\n\r\n        var radius = offset.length() * scale;\r\n\r\n        // restrict radius to be between desired limits\r\n        radius = Math.max(this.minDistance, Math.min(this.maxDistance, radius));\r\n\r\n        // move target to panned location\r\n        this.target.add(panOffset);\r\n\r\n        offset.x = radius * Math.sin(phi) * Math.sin(theta);\r\n        offset.y = radius * Math.cos(phi);\r\n        offset.z = radius * Math.sin(phi) * Math.cos(theta);\r\n\r\n        // rotate offset back to \"camera-up-vector-is-up\" space\r\n        offset.applyQuaternion(quatInverse);\r\n\r\n        position.copy(this.target).add(offset);\r\n\r\n        this.object.lookAt(this.target);\r\n\r\n        if (this.enableDamping === true) {\r\n          thetaDelta *= 1 - this.dampingFactor;\r\n          phiDelta *= 1 - this.dampingFactor;\r\n        } else {\r\n          thetaDelta = 0;\r\n          phiDelta = 0;\r\n        }\r\n\r\n        scale = 1;\r\n        panOffset.set(0, 0, 0);\r\n\r\n        // update condition is:\r\n        // min(camera displacement, camera rotation in radians)^2 > EPS\r\n        // using small-angle approximation cos(x/2) = 1 - x^2 / 8\r\n\r\n        if (\r\n          zoomChanged ||\r\n          lastPosition.distanceToSquared(this.object.position) > EPS ||\r\n          8 * (1 - lastQuaternion.dot(this.object.quaternion)) > EPS\r\n        ) {\r\n          lastPosition.copy(this.object.position);\r\n          lastQuaternion.copy(this.object.quaternion);\r\n          zoomChanged = false;\r\n\r\n          return true;\r\n        }\r\n\r\n        return false;\r\n      };\r\n    })();\r\n  }\r\n\r\n  // This set of controls performs orbiting, dollying (zooming), and panning. It maintains\r\n  // the \"up\" direction as +Y, unlike the TrackballControls. Touch on tablet and phones is\r\n  // supported.\r\n  //\r\n  //    Orbit - left mouse / touch: one finger move\r\n  //    Zoom - middle mouse, or mousewheel / touch: two finger spread or squish\r\n  //    Pan - right mouse, or arrow keys / touch: three finter swipe\r\n\r\n  function OrbitControls(object, domElement) {\r\n    var constraint = new OrbitConstraint(object);\r\n\r\n    this.domElement = domElement !== undefined ? domElement : document;\r\n\r\n    // API\r\n\r\n    Object.defineProperty(this, 'constraint', {\r\n      get: function () {\r\n        return constraint;\r\n      },\r\n    });\r\n\r\n    this.getPolarAngle = function () {\r\n      return constraint.getPolarAngle();\r\n    };\r\n\r\n    this.getAzimuthalAngle = function () {\r\n      return constraint.getAzimuthalAngle();\r\n    };\r\n\r\n    // Set to false to disable this control\r\n    this.enabled = true;\r\n\r\n    // center is old, deprecated; use \"target\" instead\r\n    this.center = this.target;\r\n\r\n    // This option actually enables dollying in and out; left as \"zoom\" for\r\n    // backwards compatibility.\r\n    // Set to false to disable zooming\r\n    this.enableZoom = true;\r\n    this.zoomSpeed = 1.0;\r\n\r\n    // Set to false to disable rotating\r\n    this.enableRotate = true;\r\n    this.rotateSpeed = 1.0;\r\n\r\n    // Set to false to disable panning\r\n    this.enablePan = true;\r\n    this.keyPanSpeed = 7.0; // pixels moved per arrow key push\r\n\r\n    // Set to true to automatically rotate around the target\r\n    // If auto-rotate is enabled, you must call controls.update() in your animation loop\r\n    this.autoRotate = false;\r\n    this.autoRotateSpeed = 2.0; // 30 seconds per round when fps is 60\r\n\r\n    // Set to false to disable use of the keys\r\n    this.enableKeys = true;\r\n\r\n    // The four arrow keys\r\n    this.keys = { LEFT: 37, UP: 38, RIGHT: 39, BOTTOM: 40 };\r\n\r\n    // Mouse buttons\r\n    this.mouseButtons = {\r\n      ORBIT: THREE.MOUSE.LEFT,\r\n      ZOOM: THREE.MOUSE.MIDDLE,\r\n      PAN: THREE.MOUSE.RIGHT,\r\n    };\r\n\r\n    ////////////\r\n    // internals\r\n\r\n    var scope = this;\r\n\r\n    var rotateStart = new THREE.Vector2();\r\n    var rotateEnd = new THREE.Vector2();\r\n    var rotateDelta = new THREE.Vector2();\r\n\r\n    var panStart = new THREE.Vector2();\r\n    var panEnd = new THREE.Vector2();\r\n    var panDelta = new THREE.Vector2();\r\n\r\n    var dollyStart = new THREE.Vector2();\r\n    var dollyEnd = new THREE.Vector2();\r\n    var dollyDelta = new THREE.Vector2();\r\n\r\n    var STATE = {\r\n      NONE: -1,\r\n      ROTATE: 0,\r\n      DOLLY: 1,\r\n      PAN: 2,\r\n      TOUCH_ROTATE: 3,\r\n      TOUCH_DOLLY: 4,\r\n      TOUCH_PAN: 5,\r\n    };\r\n\r\n    var state = STATE.NONE;\r\n\r\n    // for reset\r\n\r\n    this.target0 = this.target.clone();\r\n    this.position0 = this.object.position.clone();\r\n    this.zoom0 = this.object.zoom;\r\n\r\n    // events\r\n\r\n    var changeEvent = { type: 'change' };\r\n    var startEvent = { type: 'start' };\r\n    var endEvent = { type: 'end' };\r\n\r\n    // pass in x,y of change desired in pixel space,\r\n    // right and down are positive\r\n    function pan(deltaX, deltaY) {\r\n      var element = scope.domElement === document ? scope.domElement.body : scope.domElement;\r\n\r\n      constraint.pan(deltaX, deltaY, element.clientWidth, element.clientHeight);\r\n    }\r\n\r\n    this.update = function () {\r\n      if (this.autoRotate && state === STATE.NONE) {\r\n        constraint.rotateLeft(getAutoRotationAngle());\r\n      }\r\n\r\n      if (constraint.update() === true) {\r\n        this.dispatchEvent(changeEvent);\r\n      }\r\n    };\r\n\r\n    this.reset = function () {\r\n      state = STATE.NONE;\r\n\r\n      this.target.copy(this.target0);\r\n      this.object.position.copy(this.position0);\r\n      this.object.zoom = this.zoom0;\r\n\r\n      this.object.updateProjectionMatrix();\r\n      this.dispatchEvent(changeEvent);\r\n\r\n      this.update();\r\n    };\r\n\r\n    function getAutoRotationAngle() {\r\n      return ((2 * Math.PI) / 60 / 60) * scope.autoRotateSpeed;\r\n    }\r\n\r\n    function getZoomScale() {\r\n      return Math.pow(0.95, scope.zoomSpeed);\r\n    }\r\n\r\n    function onMouseDown(event) {\r\n      if (scope.enabled === false) return;\r\n\r\n      event.preventDefault();\r\n\r\n      if (event.button === scope.mouseButtons.ORBIT) {\r\n        if (scope.enableRotate === false) return;\r\n\r\n        state = STATE.ROTATE;\r\n\r\n        rotateStart.set(event.clientX, event.clientY);\r\n      } else if (event.button === scope.mouseButtons.ZOOM) {\r\n        if (scope.enableZoom === false) return;\r\n\r\n        state = STATE.DOLLY;\r\n\r\n        dollyStart.set(event.clientX, event.clientY);\r\n      } else if (event.button === scope.mouseButtons.PAN) {\r\n        if (scope.enablePan === false) return;\r\n\r\n        state = STATE.PAN;\r\n\r\n        panStart.set(event.clientX, event.clientY);\r\n      }\r\n\r\n      if (state !== STATE.NONE) {\r\n        document.addEventListener('mousemove', onMouseMove, false);\r\n        document.addEventListener('mouseup', onMouseUp, false);\r\n        scope.dispatchEvent(startEvent);\r\n      }\r\n    }\r\n\r\n    function onMouseMove(event) {\r\n      if (scope.enabled === false) return;\r\n\r\n      event.preventDefault();\r\n\r\n      var element = scope.domElement === document ? scope.domElement.body : scope.domElement;\r\n\r\n      if (state === STATE.ROTATE) {\r\n        if (scope.enableRotate === false) return;\r\n\r\n        rotateEnd.set(event.clientX, event.clientY);\r\n        rotateDelta.subVectors(rotateEnd, rotateStart);\r\n\r\n        // rotating across whole screen goes 360 degrees around\r\n        constraint.rotateLeft(\r\n          ((2 * Math.PI * rotateDelta.x) / element.clientWidth) * scope.rotateSpeed\r\n        );\r\n\r\n        // rotating up and down along whole screen attempts to go 360, but limited to 180\r\n        constraint.rotateUp(\r\n          ((2 * Math.PI * rotateDelta.y) / element.clientHeight) * scope.rotateSpeed\r\n        );\r\n\r\n        rotateStart.copy(rotateEnd);\r\n      } else if (state === STATE.DOLLY) {\r\n        if (scope.enableZoom === false) return;\r\n\r\n        dollyEnd.set(event.clientX, event.clientY);\r\n        dollyDelta.subVectors(dollyEnd, dollyStart);\r\n\r\n        if (dollyDelta.y > 0) {\r\n          constraint.dollyIn(getZoomScale());\r\n        } else if (dollyDelta.y < 0) {\r\n          constraint.dollyOut(getZoomScale());\r\n        }\r\n\r\n        dollyStart.copy(dollyEnd);\r\n      } else if (state === STATE.PAN) {\r\n        if (scope.enablePan === false) return;\r\n\r\n        panEnd.set(event.clientX, event.clientY);\r\n        panDelta.subVectors(panEnd, panStart);\r\n\r\n        pan(panDelta.x, panDelta.y);\r\n\r\n        panStart.copy(panEnd);\r\n      }\r\n\r\n      if (state !== STATE.NONE) scope.update();\r\n    }\r\n\r\n    function onMouseUp(/* event */) {\r\n      if (scope.enabled === false) return;\r\n\r\n      document.removeEventListener('mousemove', onMouseMove, false);\r\n      document.removeEventListener('mouseup', onMouseUp, false);\r\n      scope.dispatchEvent(endEvent);\r\n      state = STATE.NONE;\r\n    }\r\n\r\n    function onMouseWheel(event) {\r\n      if (scope.enabled === false || scope.enableZoom === false || state !== STATE.NONE) return;\r\n\r\n      event.preventDefault();\r\n      event.stopPropagation();\r\n\r\n      var delta = 0;\r\n\r\n      if (event.wheelDelta !== undefined) {\r\n        // WebKit / Opera / Explorer 9\r\n\r\n        delta = event.wheelDelta;\r\n      } else if (event.detail !== undefined) {\r\n        // Firefox\r\n\r\n        delta = -event.detail;\r\n      }\r\n\r\n      if (delta > 0) {\r\n        constraint.dollyOut(getZoomScale());\r\n      } else if (delta < 0) {\r\n        constraint.dollyIn(getZoomScale());\r\n      }\r\n\r\n      scope.update();\r\n      scope.dispatchEvent(startEvent);\r\n      scope.dispatchEvent(endEvent);\r\n    }\r\n\r\n    function onKeyDown(event) {\r\n      if (scope.enabled === false || scope.enableKeys === false || scope.enablePan === false)\r\n        return;\r\n\r\n      switch (event.keyCode) {\r\n        case scope.keys.UP:\r\n          pan(0, scope.keyPanSpeed);\r\n          scope.update();\r\n          break;\r\n\r\n        case scope.keys.BOTTOM:\r\n          pan(0, -scope.keyPanSpeed);\r\n          scope.update();\r\n          break;\r\n\r\n        case scope.keys.LEFT:\r\n          pan(scope.keyPanSpeed, 0);\r\n          scope.update();\r\n          break;\r\n\r\n        case scope.keys.RIGHT:\r\n          pan(-scope.keyPanSpeed, 0);\r\n          scope.update();\r\n          break;\r\n      }\r\n    }\r\n\r\n    function touchstart(event) {\r\n      if (scope.enabled === false) return;\r\n\r\n      switch (event.touches.length) {\r\n        case 1: // one-fingered touch: rotate\r\n          if (scope.enableRotate === false) return;\r\n\r\n          state = STATE.TOUCH_ROTATE;\r\n\r\n          rotateStart.set(event.touches[0].pageX, event.touches[0].pageY);\r\n          break;\r\n\r\n        case 2: // two-fingered touch: dolly\r\n          if (scope.enableZoom === false) return;\r\n\r\n          state = STATE.TOUCH_DOLLY;\r\n\r\n          var dx = event.touches[0].pageX - event.touches[1].pageX;\r\n          var dy = event.touches[0].pageY - event.touches[1].pageY;\r\n          var distance = Math.sqrt(dx * dx + dy * dy);\r\n          dollyStart.set(0, distance);\r\n          break;\r\n\r\n        case 3: // three-fingered touch: pan\r\n          if (scope.enablePan === false) return;\r\n\r\n          state = STATE.TOUCH_PAN;\r\n\r\n          panStart.set(event.touches[0].pageX, event.touches[0].pageY);\r\n          break;\r\n\r\n        default:\r\n          state = STATE.NONE;\r\n      }\r\n\r\n      if (state !== STATE.NONE) scope.dispatchEvent(startEvent);\r\n    }\r\n\r\n    function touchmove(event) {\r\n      if (scope.enabled === false) return;\r\n\r\n      event.preventDefault();\r\n      event.stopPropagation();\r\n\r\n      var element = scope.domElement === document ? scope.domElement.body : scope.domElement;\r\n\r\n      switch (event.touches.length) {\r\n        case 1: // one-fingered touch: rotate\r\n          if (scope.enableRotate === false) return;\r\n          if (state !== STATE.TOUCH_ROTATE) return;\r\n\r\n          rotateEnd.set(event.touches[0].pageX, event.touches[0].pageY);\r\n          rotateDelta.subVectors(rotateEnd, rotateStart);\r\n\r\n          // rotating across whole screen goes 360 degrees around\r\n          constraint.rotateLeft(\r\n            ((2 * Math.PI * rotateDelta.x) / element.clientWidth) * scope.rotateSpeed\r\n          );\r\n          // rotating up and down along whole screen attempts to go 360, but limited to 180\r\n          constraint.rotateUp(\r\n            ((2 * Math.PI * rotateDelta.y) / element.clientHeight) * scope.rotateSpeed\r\n          );\r\n\r\n          rotateStart.copy(rotateEnd);\r\n\r\n          scope.update();\r\n          break;\r\n\r\n        case 2: // two-fingered touch: dolly\r\n          if (scope.enableZoom === false) return;\r\n          if (state !== STATE.TOUCH_DOLLY) return;\r\n\r\n          var dx = event.touches[0].pageX - event.touches[1].pageX;\r\n          var dy = event.touches[0].pageY - event.touches[1].pageY;\r\n          var distance = Math.sqrt(dx * dx + dy * dy);\r\n\r\n          dollyEnd.set(0, distance);\r\n          dollyDelta.subVectors(dollyEnd, dollyStart);\r\n\r\n          if (dollyDelta.y > 0) {\r\n            constraint.dollyOut(getZoomScale());\r\n          } else if (dollyDelta.y < 0) {\r\n            constraint.dollyIn(getZoomScale());\r\n          }\r\n\r\n          dollyStart.copy(dollyEnd);\r\n\r\n          scope.update();\r\n          break;\r\n\r\n        case 3: // three-fingered touch: pan\r\n          if (scope.enablePan === false) return;\r\n          if (state !== STATE.TOUCH_PAN) return;\r\n\r\n          panEnd.set(event.touches[0].pageX, event.touches[0].pageY);\r\n          panDelta.subVectors(panEnd, panStart);\r\n\r\n          pan(panDelta.x, panDelta.y);\r\n\r\n          panStart.copy(panEnd);\r\n\r\n          scope.update();\r\n          break;\r\n\r\n        default:\r\n          state = STATE.NONE;\r\n      }\r\n    }\r\n\r\n    function touchend(/* event */) {\r\n      if (scope.enabled === false) return;\r\n\r\n      scope.dispatchEvent(endEvent);\r\n      state = STATE.NONE;\r\n    }\r\n\r\n    function contextmenu(event) {\r\n      event.preventDefault();\r\n    }\r\n\r\n    this.dispose = function () {\r\n      this.domElement.removeEventListener('contextmenu', contextmenu, false);\r\n      this.domElement.removeEventListener('mousedown', onMouseDown, false);\r\n      this.domElement.removeEventListener('mousewheel', onMouseWheel, false);\r\n      this.domElement.removeEventListener('MozMousePixelScroll', onMouseWheel, false); // firefox\r\n\r\n      this.domElement.removeEventListener('touchstart', touchstart, false);\r\n      this.domElement.removeEventListener('touchend', touchend, false);\r\n      this.domElement.removeEventListener('touchmove', touchmove, false);\r\n\r\n      document.removeEventListener('mousemove', onMouseMove, false);\r\n      document.removeEventListener('mouseup', onMouseUp, false);\r\n\r\n      window.removeEventListener('keydown', onKeyDown, false);\r\n    };\r\n\r\n    this.domElement.addEventListener('contextmenu', contextmenu, false);\r\n\r\n    this.domElement.addEventListener('mousedown', onMouseDown, false);\r\n    this.domElement.addEventListener('mousewheel', onMouseWheel, false);\r\n    this.domElement.addEventListener('MozMousePixelScroll', onMouseWheel, false); // firefox\r\n\r\n    this.domElement.addEventListener('touchstart', touchstart, false);\r\n    this.domElement.addEventListener('touchend', touchend, false);\r\n    this.domElement.addEventListener('touchmove', touchmove, false);\r\n\r\n    window.addEventListener('keydown', onKeyDown, false);\r\n\r\n    // force an update at start\r\n    this.update();\r\n  }\r\n\r\n  OrbitControls.prototype = Object.create(THREE.EventDispatcher.prototype);\r\n  OrbitControls.prototype.constructor = OrbitControls;\r\n\r\n  Object.defineProperties(OrbitControls.prototype, {\r\n    object: {\r\n      get: function () {\r\n        return this.constraint.object;\r\n      },\r\n    },\r\n\r\n    target: {\r\n      get: function () {\r\n        return this.constraint.target;\r\n      },\r\n\r\n      set: function (value) {\r\n        console.warn('THREE.OrbitControls: target is now immutable. Use target.set() instead.');\r\n        this.constraint.target.copy(value);\r\n      },\r\n    },\r\n\r\n    minDistance: {\r\n      get: function () {\r\n        return this.constraint.minDistance;\r\n      },\r\n\r\n      set: function (value) {\r\n        this.constraint.minDistance = value;\r\n      },\r\n    },\r\n\r\n    maxDistance: {\r\n      get: function () {\r\n        return this.constraint.maxDistance;\r\n      },\r\n\r\n      set: function (value) {\r\n        this.constraint.maxDistance = value;\r\n      },\r\n    },\r\n\r\n    minZoom: {\r\n      get: function () {\r\n        return this.constraint.minZoom;\r\n      },\r\n\r\n      set: function (value) {\r\n        this.constraint.minZoom = value;\r\n      },\r\n    },\r\n\r\n    maxZoom: {\r\n      get: function () {\r\n        return this.constraint.maxZoom;\r\n      },\r\n\r\n      set: function (value) {\r\n        this.constraint.maxZoom = value;\r\n      },\r\n    },\r\n\r\n    minPolarAngle: {\r\n      get: function () {\r\n        return this.constraint.minPolarAngle;\r\n      },\r\n\r\n      set: function (value) {\r\n        this.constraint.minPolarAngle = value;\r\n      },\r\n    },\r\n\r\n    maxPolarAngle: {\r\n      get: function () {\r\n        return this.constraint.maxPolarAngle;\r\n      },\r\n\r\n      set: function (value) {\r\n        this.constraint.maxPolarAngle = value;\r\n      },\r\n    },\r\n\r\n    minAzimuthAngle: {\r\n      get: function () {\r\n        return this.constraint.minAzimuthAngle;\r\n      },\r\n\r\n      set: function (value) {\r\n        this.constraint.minAzimuthAngle = value;\r\n      },\r\n    },\r\n\r\n    maxAzimuthAngle: {\r\n      get: function () {\r\n        return this.constraint.maxAzimuthAngle;\r\n      },\r\n\r\n      set: function (value) {\r\n        this.constraint.maxAzimuthAngle = value;\r\n      },\r\n    },\r\n\r\n    enableDamping: {\r\n      get: function () {\r\n        return this.constraint.enableDamping;\r\n      },\r\n\r\n      set: function (value) {\r\n        this.constraint.enableDamping = value;\r\n      },\r\n    },\r\n\r\n    dampingFactor: {\r\n      get: function () {\r\n        return this.constraint.dampingFactor;\r\n      },\r\n\r\n      set: function (value) {\r\n        this.constraint.dampingFactor = value;\r\n      },\r\n    },\r\n\r\n    // backward compatibility\r\n\r\n    noZoom: {\r\n      get: function () {\r\n        console.warn('THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.');\r\n        return !this.enableZoom;\r\n      },\r\n\r\n      set: function (value) {\r\n        console.warn('THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.');\r\n        this.enableZoom = !value;\r\n      },\r\n    },\r\n\r\n    noRotate: {\r\n      get: function () {\r\n        console.warn(\r\n          'THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.'\r\n        );\r\n        return !this.enableRotate;\r\n      },\r\n\r\n      set: function (value) {\r\n        console.warn(\r\n          'THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.'\r\n        );\r\n        this.enableRotate = !value;\r\n      },\r\n    },\r\n\r\n    noPan: {\r\n      get: function () {\r\n        console.warn('THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.');\r\n        return !this.enablePan;\r\n      },\r\n\r\n      set: function (value) {\r\n        console.warn('THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.');\r\n        this.enablePan = !value;\r\n      },\r\n    },\r\n\r\n    noKeys: {\r\n      get: function () {\r\n        console.warn('THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.');\r\n        return !this.enableKeys;\r\n      },\r\n\r\n      set: function (value) {\r\n        console.warn('THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.');\r\n        this.enableKeys = !value;\r\n      },\r\n    },\r\n\r\n    staticMoving: {\r\n      get: function () {\r\n        console.warn(\r\n          'THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.'\r\n        );\r\n        return !this.constraint.enableDamping;\r\n      },\r\n\r\n      set: function (value) {\r\n        console.warn(\r\n          'THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.'\r\n        );\r\n        this.constraint.enableDamping = !value;\r\n      },\r\n    },\r\n\r\n    dynamicDampingFactor: {\r\n      get: function () {\r\n        console.warn(\r\n          'THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.'\r\n        );\r\n        return this.constraint.dampingFactor;\r\n      },\r\n\r\n      set: function (value) {\r\n        console.warn(\r\n          'THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.'\r\n        );\r\n        this.constraint.dampingFactor = value;\r\n      },\r\n    },\r\n  });\r\n\r\n  return OrbitControls;\r\n};\r\n","import TWEEN from '@tweenjs/tween.js';\r\n\r\n// This object contains the state of the app\r\nexport default {\r\n  isDev: false,\r\n  isShowingStats: true,\r\n  isLoaded: false,\r\n  isTweening: false,\r\n  isRotating: true,\r\n  isMouseMoving: false,\r\n  isMouseOver: false,\r\n  maxAnisotropy: 1,\r\n  dpr: 1,\r\n  easing: TWEEN.Easing.Quadratic.InOut,\r\n  duration: 500,\r\n  model: {\r\n    selected: 0,\r\n    initialTypes: ['gltf', 'object'],\r\n    type: 'gltf'\r\n  },\r\n  models: [\r\n    {\r\n      path: './assets/models/duck.gltf',\r\n      scale: 20,\r\n      type: 'gltf'\r\n    },\r\n    {\r\n      path: './assets/models/Teapot.json',\r\n      scale: 20,\r\n      type: 'object'\r\n    }\r\n  ],\r\n  texture: {\r\n    path: './assets/textures/',\r\n    imageFiles: [\r\n      { name: 'UV', image: 'UV_Grid_Sm.jpg' }\r\n    ]\r\n  },\r\n  mesh: {\r\n    enableHelper: false,\r\n    wireframe: false,\r\n    translucent: false,\r\n    material: {\r\n      color: 0xffffff,\r\n      emissive: 0xffffff\r\n    }\r\n  },\r\n  fog: {\r\n    color: 0xffffff,\r\n    near: 0.0008\r\n  },\r\n  camera: {\r\n    fov: 40,\r\n    near: 0.1,\r\n    far: 1000,\r\n    aspect: 1,\r\n    posX: 0,\r\n    posY: 10,\r\n    posZ: 100\r\n  },\r\n  controls: {\r\n    autoRotate: true,\r\n    autoRotateSpeed: -0.5,\r\n    rotateSpeed: 0.5,\r\n    zoomSpeed: 0.8,\r\n    minDistance: 10,\r\n    maxDistance: 200,\r\n    minPolarAngle: Math.PI / 5,\r\n    maxPolarAngle: Math.PI / 2,\r\n    minAzimuthAngle: -Infinity,\r\n    maxAzimuthAngle: Infinity,\r\n    enableDamping: true,\r\n    dampingFactor: 0.5,\r\n    enableZoom: true,\r\n    target: {\r\n      x: 0,\r\n      y: 0,\r\n      z: 0\r\n    }\r\n  },\r\n  ambientLight: {\r\n    enabled: true,\r\n    color: 0x141414\r\n  },\r\n  directionalLight: {\r\n    enabled: true,\r\n    color: 0xf0f0f0,\r\n    intensity: 0.4,\r\n    x: -75,\r\n    y: 280,\r\n    z: 150\r\n  },\r\n  shadow: {\r\n    enabled: true,\r\n    helperEnabled: false,\r\n    bias: 0,\r\n    mapWidth: 2048,\r\n    mapHeight: 2048,\r\n    near: 250,\r\n    far: 400,\r\n    top: 100,\r\n    right: 100,\r\n    bottom: -100,\r\n    left: -100\r\n  },\r\n  pointLight: {\r\n    enabled: true,\r\n    color: 0xffffff,\r\n    intensity: 0.34,\r\n    distance: 115,\r\n    x: 0,\r\n    y: 0,\r\n    z: 0\r\n  },\r\n  hemiLight: {\r\n    enabled: true,\r\n    color: 0xc8c8c8,\r\n    groundColor: 0xffffff,\r\n    intensity: 0.55,\r\n    x: 0,\r\n    y: 0,\r\n    z: 0\r\n  }\r\n};\r\n","/**\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author mr.doob / http://mrdoob.com/\r\n */\r\n\r\nexport default {\r\n  canvas: !!window.CanvasRenderingContext2D,\r\n  webgl: (function() {\r\n    try {\r\n      var canvas = document.createElement('canvas');\r\n\r\n      return !!(window.WebGLRenderingContext && (canvas.getContext('webgl') || canvas.getContext('experimental-webgl')));\r\n    } catch(e) {\r\n      return false;\r\n    }\r\n  })(),\r\n\r\n  workers: !!window.Worker,\r\n  fileapi: window.File && window.FileReader && window.FileList && window.Blob,\r\n\r\n  getWebGLErrorMessage: function() {\r\n    var element = document.createElement('div');\r\n    element.id = 'webgl-error-message';\r\n    element.style.fontFamily = 'monospace';\r\n    element.style.fontSize = '13px';\r\n    element.style.fontWeight = 'normal';\r\n    element.style.textAlign = 'center';\r\n    element.style.background = '#fff';\r\n    element.style.color = '#000';\r\n    element.style.padding = '1.5em';\r\n    element.style.width = '400px';\r\n    element.style.margin = '5em auto 0';\r\n\r\n    if(!this.webgl) {\r\n      element.innerHTML = window.WebGLRenderingContext ? [\r\n        'Your graphics card does not seem to support <a href=\"http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation\" style=\"color:#000000\">WebGL</a>.<br />',\r\n        'Find out how to get it <a href=\"http://get.webgl.org/\" style=\"color:#000000\">here</a>.'\r\n      ].join('\\n') : [\r\n        'Your browser does not seem to support <a href=\"http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation\" style=\"color:#000000\">WebGL</a>.<br/>',\r\n        'Find out how to get it <a href=\"http://get.webgl.org/\" style=\"color:#000000\">here</a>.'\r\n      ].join('\\n');\r\n    }\r\n\r\n    return element;\r\n  },\r\n\r\n  addGetWebGLMessage: function(parameters) {\r\n    var parent, id, element;\r\n\r\n    parameters = parameters || {};\r\n\r\n    parent = parameters.parent !== undefined ? parameters.parent : document.body;\r\n    id = parameters.id !== undefined ? parameters.id : 'oldie';\r\n\r\n    element = this.getWebGLErrorMessage();\r\n    element.id = id;\r\n\r\n    parent.appendChild(element);\r\n  }\r\n};\r\n","import * as THREE from 'three';\r\n\r\nimport Config from '../../data/config';\r\n\r\n// Main webGL renderer class\r\nexport default class Renderer {\r\n  constructor(scene, container) {\r\n    // Properties\r\n    this.scene = scene;\r\n    this.container = container;\r\n\r\n    // Create WebGL renderer and set its antialias\r\n    this.threeRenderer = new THREE.WebGLRenderer({antialias: true});\r\n\r\n    // Set clear color to fog to enable fog or to hex color for no fog\r\n    this.threeRenderer.setClearColor(scene.fog.color);\r\n    this.threeRenderer.setPixelRatio(window.devicePixelRatio); // For retina\r\n\r\n    // Appends canvas\r\n    container.appendChild(this.threeRenderer.domElement);\r\n\r\n    // Shadow map options\r\n    this.threeRenderer.shadowMap.enabled = true;\r\n    this.threeRenderer.shadowMap.type = THREE.PCFSoftShadowMap;\r\n\r\n    // Get anisotropy for textures\r\n    Config.maxAnisotropy = this.threeRenderer.capabilities.getMaxAnisotropy();\r\n\r\n    // Initial size update set to canvas container\r\n    this.updateSize();\r\n\r\n    // Listeners\r\n    document.addEventListener('DOMContentLoaded', () => this.updateSize(), false);\r\n    window.addEventListener('resize', () => this.updateSize(), true);\r\n  }\r\n\r\n  updateSize() {\r\n    this.threeRenderer.setSize(this.container.offsetWidth, this.container.offsetHeight);\r\n  }\r\n\r\n  render(scene, camera) {\r\n    // Renders scene to canvas target\r\n    this.threeRenderer.render(scene, camera);\r\n  }\r\n}\r\n","import * as THREE from 'three';\r\n\r\nimport Config from '../../data/config';\r\n\r\n// Class that creates and updates the main camera\r\nexport default class Camera {\r\n  constructor(renderer) {\r\n    const width = renderer.domElement.width;\r\n    const height = renderer.domElement.height;\r\n\r\n    // Create and position a Perspective Camera\r\n    this.threeCamera = new THREE.PerspectiveCamera(Config.camera.fov, width / height, Config.camera.near, Config.camera.far);\r\n    this.threeCamera.position.set(Config.camera.posX, Config.camera.posY, Config.camera.posZ);\r\n\r\n    // Initial sizing\r\n    this.updateSize(renderer);\r\n\r\n    // Listeners\r\n    window.addEventListener('resize', () => this.updateSize(renderer), false);\r\n  }\r\n\r\n  updateSize(renderer) {\r\n    // Update camera aspect ratio with window aspect ratio\r\n    this.threeCamera.aspect = renderer.domElement.width / renderer.domElement.height;\r\n\r\n    // Always call updateProjectionMatrix on camera change\r\n    this.threeCamera.updateProjectionMatrix();\r\n  }\r\n}\r\n","import * as THREE from 'three';\r\n\r\nimport Config from '../../data/config';\r\n\r\n// Sets up and places all lights in scene\r\nexport default class Light {\r\n  constructor(scene) {\r\n    this.scene = scene;\r\n\r\n    this.init();\r\n  }\r\n\r\n  init() {\r\n    // Ambient\r\n    this.ambientLight = new THREE.AmbientLight(Config.ambientLight.color);\r\n    this.ambientLight.visible = Config.ambientLight.enabled;\r\n\r\n    // Point light\r\n    this.pointLight = new THREE.PointLight(Config.pointLight.color, Config.pointLight.intensity, Config.pointLight.distance);\r\n    this.pointLight.position.set(Config.pointLight.x, Config.pointLight.y, Config.pointLight.z);\r\n    this.pointLight.visible = Config.pointLight.enabled;\r\n\r\n    // Directional light\r\n    this.directionalLight = new THREE.DirectionalLight(Config.directionalLight.color, Config.directionalLight.intensity);\r\n    this.directionalLight.position.set(Config.directionalLight.x, Config.directionalLight.y, Config.directionalLight.z);\r\n    this.directionalLight.visible = Config.directionalLight.enabled;\r\n\r\n    // Shadow map\r\n    this.directionalLight.castShadow = Config.shadow.enabled;\r\n    this.directionalLight.shadow.bias = Config.shadow.bias;\r\n    this.directionalLight.shadow.camera.near = Config.shadow.near;\r\n    this.directionalLight.shadow.camera.far = Config.shadow.far;\r\n    this.directionalLight.shadow.camera.left = Config.shadow.left;\r\n    this.directionalLight.shadow.camera.right = Config.shadow.right;\r\n    this.directionalLight.shadow.camera.top = Config.shadow.top;\r\n    this.directionalLight.shadow.camera.bottom = Config.shadow.bottom;\r\n    this.directionalLight.shadow.mapSize.width = Config.shadow.mapWidth;\r\n    this.directionalLight.shadow.mapSize.height = Config.shadow.mapHeight;\r\n\r\n    // Shadow camera helper\r\n    this.directionalLightHelper = new THREE.CameraHelper(this.directionalLight.shadow.camera);\r\n    this.directionalLightHelper.visible = Config.shadow.helperEnabled;\r\n\r\n    // Hemisphere light\r\n    this.hemiLight = new THREE.HemisphereLight(Config.hemiLight.color, Config.hemiLight.groundColor, Config.hemiLight.intensity);\r\n    this.hemiLight.position.set(Config.hemiLight.x, Config.hemiLight.y, Config.hemiLight.z);\r\n    this.hemiLight.visible = Config.hemiLight.enabled;\r\n  }\r\n\r\n  place(lightName) {\r\n    switch(lightName) {\r\n      case 'ambient':\r\n        this.scene.add(this.ambientLight);\r\n        break;\r\n\r\n      case 'directional':\r\n        this.scene.add(this.directionalLight);\r\n        this.scene.add(this.directionalLightHelper);\r\n        break;\r\n\r\n      case 'point':\r\n        this.scene.add(this.pointLight);\r\n        break;\r\n\r\n      case 'hemi':\r\n        this.scene.add(this.hemiLight);\r\n        break;\r\n    }\r\n  }\r\n}\r\n","import * as THREE from 'three';\r\n\r\nimport OrbitControls from '../../utils/orbitControls';\r\nimport Config from '../../data/config';\r\n\r\n// Controls based on orbit controls\r\nexport default class Controls {\r\n  constructor(camera, container) {\r\n    // Orbit controls first needs to pass in THREE to constructor\r\n    const orbitControls = new OrbitControls(THREE);\r\n    this.threeControls = new orbitControls(camera, container);\r\n\r\n    this.init();\r\n  }\r\n\r\n  init() {\r\n    this.threeControls.target.set(Config.controls.target.x, Config.controls.target.y, Config.controls.target.z);\r\n    this.threeControls.autoRotate = Config.controls.autoRotate;\r\n    this.threeControls.autoRotateSpeed = Config.controls.autoRotateSpeed;\r\n    this.threeControls.rotateSpeed = Config.controls.rotateSpeed;\r\n    this.threeControls.zoomSpeed = Config.controls.zoomSpeed;\r\n    this.threeControls.minDistance = Config.controls.minDistance;\r\n    this.threeControls.maxDistance = Config.controls.maxDistance;\r\n    this.threeControls.minPolarAngle = Config.controls.minPolarAngle;\r\n    this.threeControls.maxPolarAngle = Config.controls.maxPolarAngle;\r\n    this.threeControls.enableDamping = Config.controls.enableDamping;\r\n    this.threeControls.enableZoom = Config.controls.enableZoom;\r\n    this.threeControls.dampingFactor = Config.controls.dampingFactor;\r\n  }\r\n}\r\n","import * as THREE from 'three';\r\n\r\n// USe this class as a helper to set up some default materials\r\nexport default class Material {\r\n  constructor(color) {\r\n    this.basic = new THREE.MeshBasicMaterial({\r\n      color,\r\n      side: THREE.DoubleSide\r\n    });\r\n\r\n    this.standard = new THREE.MeshStandardMaterial({\r\n      color,\r\n      shading: THREE.FlatShading,\r\n      roughness: 1,\r\n      metalness: 0,\r\n      side: THREE.DoubleSide\r\n    });\r\n\r\n    this.wire = new THREE.MeshBasicMaterial({wireframe: true});\r\n  }\r\n}\r\n\r\n","import * as THREE from 'three';\r\n\r\nimport Material from './material';\r\nimport Config from '../../data/config';\r\n\r\n// This helper class can be used to create and then place geometry in the scene\r\nexport default class Geometry {\r\n  constructor(scene) {\r\n    this.scene = scene;\r\n    this.geo = null;\r\n  }\r\n\r\n  make(type) {\r\n    if(type === 'plane') {\r\n      return (width, height, widthSegments = 1, heightSegments = 1) => {\r\n        this.geo = new THREE.PlaneGeometry(width, height, widthSegments, heightSegments);\r\n      };\r\n    }\r\n\r\n    if(type === 'sphere') {\r\n      return (radius, widthSegments = 32, heightSegments = 32) => {\r\n        this.geo = new THREE.SphereGeometry(radius, widthSegments, heightSegments);\r\n      };\r\n    }\r\n  }\r\n\r\n  place(position, rotation) {\r\n    const material = new Material(0xeeeeee).standard;\r\n    this.mesh = new THREE.Mesh(this.geo, material);\r\n\r\n    // Use ES6 spread to set position and rotation from passed in array\r\n    this.mesh.position.set(...position);\r\n    this.mesh.rotation.set(...rotation);\r\n\r\n    if(Config.shadow.enabled) {\r\n      this.mesh.receiveShadow = true;\r\n    }\r\n\r\n    this.scene.add(this.mesh);\r\n  }\r\n}\r\n","export default {\r\n    t: 0\r\n}\r\n","import * as THREE from 'three';\r\n\r\nimport GlobalVars from \"../../data/globalVars\";\r\n\r\nexport default class Waist {\r\n\r\n    constructor(scene) {\r\n\r\n        const _material = new THREE.MeshStandardMaterial();\r\n        _material.color = new THREE.Color(0x64ede2);\r\n        _material.wireframe = false;\r\n\r\n        this.alpha = 0;\r\n\r\n        this.obj = new THREE.Object3D();\r\n        //this.obj.add(new THREE.Mesh(new THREE.SphereGeometry(.3, 32, 32), _material));\r\n\r\n\r\n        /* ----------------------------- */\r\n        /* ----------------------------- */\r\n        /* ----------------------------- */\r\n        this.lowObj = new THREE.Object3D();\r\n        this.lowObj.position.set(0, 0, 0);\r\n\r\n        //create waist cube\r\n        const _waistGeometry = new THREE.BoxGeometry(1, 1, 1.3);\r\n        this.waist = new THREE.Mesh( _waistGeometry, _material);\r\n        this.lowObj.add(this.waist);\r\n        this.obj.add(this.lowObj);\r\n\r\n\r\n\r\n\r\n\r\n\r\n        /* ----------------------------- */\r\n        /* ----------------------------- */\r\n        /* ----------------------------- */\r\n        this.upObj = new THREE.Object3D();\r\n        this.obj.add(this.upObj);\r\n        //this.upObj.add(new THREE.Mesh(new THREE.SphereGeometry(.3, 32, 32), _material));\r\n        //this.upObj.position.add(this.lowObj.getWorldPosition(new THREE.Vector3(0, 0.5, 0)));\r\n\r\n\r\n        //create back pivot\r\n        this._backPivot = new THREE.Object3D();\r\n        this._backPivot.position.set(0, 1/2, 0);\r\n        this.upObj.add(this._backPivot);\r\n\r\n        //create back cube\r\n        const _backGeomtry = new THREE.BoxGeometry(1.1, 0.5, 1.3);\r\n        this._back = new THREE.Mesh( _backGeomtry, _material);\r\n        this._back.position.set(0, 0.5/2 + 0.2, 0);\r\n        this._backPivot.add(this._back);\r\n\r\n\r\n\r\n        //create back pivot\r\n        this._backPivot2 = new THREE.Object3D();\r\n        this._backPivot2.position.set(0, (0.6), 0);\r\n        this._backPivot.add(this._backPivot2);\r\n\r\n        //create back cube\r\n        const _backGeomtry2 = new THREE.BoxGeometry(1.3, 0.5, 1.5);\r\n        this._back2 = new THREE.Mesh( _backGeomtry2, _material);\r\n        this._back2.position.set(0, 0.5/2 + 0.2, 0);\r\n        this._backPivot2.add(this._back2);\r\n\r\n\r\n\r\n        //create back pivot\r\n        this._backPivot3 = new THREE.Object3D();\r\n        this._backPivot3.position.set(0, (0.6), 0);\r\n        this._backPivot2.add(this._backPivot3);\r\n\r\n        //create back cube\r\n        const _backGeomtry3 = new THREE.BoxGeometry(1.5, 0.5, 1.7);\r\n        this._back3 = new THREE.Mesh( _backGeomtry3, _material);\r\n        this._back3.position.set(0, 0.5/2 + 0.2, 0);\r\n        this._backPivot3.add(this._back3);\r\n\r\n\r\n        //create back pivot\r\n        this._backPivot4 = new THREE.Object3D();\r\n        this._backPivot4.position.set(0, (0.6), 0);\r\n        this._backPivot3.add(this._backPivot4);\r\n\r\n        //create back cube\r\n        const _backGeomtry4 = new THREE.BoxGeometry(1.7, 0.5, 1.9);\r\n        this._back4 = new THREE.Mesh( _backGeomtry4, _material);\r\n        this._back4.position.set(0, 0.5/2 + 0.2, 0);\r\n        this._backPivot4.add(this._back4);\r\n\r\n        //create back pivot\r\n        this._backPivot5 = new THREE.Object3D();\r\n        this._backPivot5.position.set(0, (0.6), 0);\r\n        this._backPivot4.add(this._backPivot5);\r\n\r\n        //create back cube\r\n        const _backGeomtry5 = new THREE.BoxGeometry(1.1, 0.4, 1.5);\r\n        this._back4 = new THREE.Mesh( _backGeomtry5, _material);\r\n        this._back4.position.set(0, 0.4/2, 0);\r\n        this._backPivot5.add(this._back4);\r\n\r\n        this._headObj = new THREE.Object3D();\r\n        this._headObj.position.set(0, 0.6, 0);\r\n        //this._headObj.add(new THREE.Mesh(new THREE.SphereGeometry(.3, 32, 32), _material));\r\n        this._backPivot5.add(this._headObj);\r\n\r\n\r\n        scene.add(this.obj);\r\n    }\r\n\r\n    update(){\r\n\r\n        const y = 0.3 * Math.sin(2*GlobalVars.t + Math.PI) + this.yy;\r\n        this.obj.position.set(0, y, 0);\r\n\r\n\r\n        this.lowObj.rotation.y = a * Math.sin(GlobalVars.t); //waist rotation\r\n        this.upObj.rotation.y = a * Math.sin(GlobalVars.t + Math.PI); //shoulder rotation\r\n\r\n    }\r\n}\r\n\r\nconst a = 0.15;\r\n","export default {\r\n    deg2rad: Math.PI/180,\r\n    rad2deg: 180/Math.PI\r\n}\r\n","import * as THREE from 'three';\r\n\r\nimport GlobalVars from \"../../data/globalVars\";\r\nimport Math2 from \"../../data/math2\";\r\n\r\nexport default class Arm {\r\n\r\n    constructor(scene, d) {\r\n\r\n        const _material = new THREE.MeshStandardMaterial();\r\n        _material.color = new THREE.Color(0x64ede2);\r\n        _material.wireframe = false;\r\n\r\n        this.alpha = 0;\r\n\r\n        //create container object\r\n        this.obj = new THREE.Object3D();\r\n        //this.obj.position.set(0, 3.75, 0);\r\n        this.obj.rotation.x = -20 * Math2.deg2rad * d;\r\n        this.obj.position.set(0, 0, 0);\r\n\r\n        //DEBUG\r\n        //this.obj.add(new THREE.Mesh(new THREE.SphereGeometry(.35, 32, 32), _material));\r\n\r\n\r\n        //create upper cube\r\n        const _upperArmGeometry = new THREE.BoxGeometry(0.35, 1.5, 0.35);\r\n        this._upperLeg = new THREE.Mesh( _upperArmGeometry, _material);\r\n        this._upperLeg.position.add(new THREE.Vector3(0, -1.5/2, 0));\r\n        this.obj.add(this._upperLeg);\r\n\r\n        //create lower pivot\r\n        this.lowPivot = new THREE.Object3D();\r\n        this.lowPivot.position.set(0, -1.5, 0);\r\n        this.lowPivot.rotation.y = -15 * Math2.deg2rad * d;\r\n        this.obj.add(this.lowPivot);\r\n\r\n        //create lower cube\r\n        const _lowerLegGeometry = new THREE.BoxGeometry(0.35, 1, 0.35);\r\n        this._lowerLeg = new THREE.Mesh( _lowerLegGeometry, _material);\r\n        this._lowerLeg.position.add(new THREE.Vector3(0, -1/2, 0));\r\n        this.lowPivot.add(this._lowerLeg);\r\n\r\n        //create hand pivot\r\n        this.handPivot = new THREE.Object3D();\r\n        this.handPivot.position.set(0, -1, 0);\r\n        this.handPivot.rotation.y = 15*Math2.deg2rad * d;\r\n        this.lowPivot.add(this.handPivot);\r\n\r\n\r\n        //create finger cube\r\n        const _fingerGeometry = new THREE.BoxGeometry(0.15, .35, 0.15);\r\n        this._finger = new THREE.Mesh( _fingerGeometry, _material);\r\n        this._finger.position.add(new THREE.Vector3(-0.35, -0.25/2, 0));\r\n        this._finger.rotation.z =  -30 * Math2.deg2rad;\r\n        this.handPivot.add(this._finger);\r\n\r\n        //create foot cube\r\n        const _handGeometry = new THREE.BoxGeometry(0.4, .75, 0.15);\r\n        this._hand = new THREE.Mesh( _handGeometry, _material);\r\n        this._hand.position.add(new THREE.Vector3(0, -0.25/2, 0));\r\n        this.handPivot.add(this._hand);\r\n\r\n\r\n        scene.add(this.obj);\r\n    }\r\n\r\n    update(){\r\n\r\n        //hands\r\n        this.obj.rotation.z = 0.5 * Math.sin(GlobalVars.t + this.alpha);\r\n        this.lowPivot.rotation.z = 0.5 * Math.sin(GlobalVars.t + this.alpha) + (-90 * Math2.deg2rad);\r\n\r\n    }\r\n}\r\n","import * as THREE from 'three';\r\n\r\nimport GlobalVars from \"../../data/globalVars\";\r\nimport Math2 from \"../../data/math2\";\r\n\r\nexport default class Leg {\r\n\r\n    constructor(scene) {\r\n\r\n        const _material = new THREE.MeshStandardMaterial();\r\n        _material.color = new THREE.Color(0x64ede2);\r\n\r\n\r\n        this.alpha = 0;\r\n\r\n        //create container object\r\n        this.obj = new THREE.Object3D();\r\n        //this.obj.position.set(0, 3.75, 0);\r\n        this.obj.position.set(0, 0, 0);\r\n\r\n        //DEBUG\r\n        //this.obj.add(new THREE.Mesh(new THREE.SphereGeometry(0.2, 32, 32), _material));\r\n\r\n\r\n        //create upper cube\r\n        const _upperLegGeometry = new THREE.BoxGeometry(0.5, 2, 0.5);\r\n        this._upperLeg = new THREE.Mesh( _upperLegGeometry, _material);\r\n        this._upperLeg.position.add(new THREE.Vector3(0, -1, 0));\r\n        this.obj.add(this._upperLeg);\r\n\r\n        //create lower pivot\r\n        this.lowPivot = new THREE.Object3D();\r\n        this.lowPivot.position.set(0, -2, 0);\r\n        this.obj.add(this.lowPivot);\r\n\r\n        //create lower cube\r\n        const _lowerLegGeometry = new THREE.BoxGeometry(0.5, 1.5, 0.5);\r\n        this._lowerLeg = new THREE.Mesh( _lowerLegGeometry, _material);\r\n        this._lowerLeg.position.add(new THREE.Vector3(0, -1.5/2, 0));\r\n        this.lowPivot.add(this._lowerLeg);\r\n\r\n        //create foot pivot\r\n        this.footPivot = new THREE.Object3D();\r\n        this.footPivot.position.set(0, -1.5, 0);\r\n        this.lowPivot.add(this.footPivot);\r\n\r\n        //create foot cube\r\n        const _footGeometry = new THREE.BoxGeometry(1, 0.25, 0.5);\r\n        this._foot = new THREE.Mesh( _footGeometry, _material);\r\n        this._foot.position.add(new THREE.Vector3(-.5 + .25, -0.25/2, 0));\r\n        this.footPivot.add(this._foot);\r\n\r\n\r\n        scene.add(this.obj);\r\n    }\r\n\r\n    update(){\r\n\r\n\r\n        this.obj.rotation.z = 1 * Math.sin(GlobalVars.t + this.alpha);\r\n        this.lowPivot.rotation.z = 0.75 * Math.sin(GlobalVars.t + Math.PI/2 * this.d) + (45*Math2.deg2rad);   //the phase must be the middle of the upper\r\n        this.footPivot.rotation.z = 0.5 * Math.sin(GlobalVars.t + Math.PI/2 * this.d) + (20*Math2.deg2rad);   //the pase must be the middle of the upper\r\n\r\n\r\n\r\n        //hands\r\n        /*this.obj.rotation.z = 0.5 * Math.sin(GlobalVars.t + this.alpha);\r\n        this.lowPivot.rotation.z = 0.5 * Math.sin(GlobalVars.t) + 30;*/\r\n\r\n    }\r\n}\r\n","import * as THREE from 'three';\r\n\r\nimport GlobalVars from \"../../data/globalVars\";\r\n\r\nexport default class Head {\r\n\r\n    constructor(scene) {\r\n\r\n        const _material = new THREE.MeshStandardMaterial();\r\n        _material.color = new THREE.Color(0x64ede2);\r\n        _material.wireframe = false;\r\n\r\n        this.alpha = 0;\r\n\r\n        this.obj = new THREE.Object3D();\r\n\r\n        const _headGeometry = new THREE.SphereGeometry(0.75, 32, 32);\r\n        this._head = new THREE.Mesh( _headGeometry, _material)\r\n        this._head.scale.set(1, 1.1, 0.8);\r\n        this._head.position.set(0, 0.5, 0);\r\n        this.obj.add(this._head);\r\n\r\n\r\n\r\n\r\n        scene.add(this.obj);\r\n    }\r\n\r\n    update(){\r\n\r\n\r\n    }\r\n}\r\n","import * as THREE from 'three';\r\n\r\nimport GlobalVars from \"../../data/globalVars\";\r\n\r\nimport Waist from '../classes/waist';\r\nimport Arm from '../classes/arm';\r\nimport Leg from '../classes/leg';\r\nimport Head from '../classes/head'\r\n\r\nexport default class Walkman {\r\n\r\n    constructor(scene) {\r\n\r\n        const dist = 0.8;\r\n\r\n        this._waist  = new Waist(scene);\r\n        this._waist.yy = 4;\r\n        this._waist.obj.rotation.z = 10 * Math.PI/180;\r\n\r\n        // ----------\r\n        this._leftArm = new Arm(this._waist.upObj, 1);\r\n        this._leftArm.alpha = Math.PI;\r\n\r\n        this._rightArm = new Arm(this._waist.upObj, -1);\r\n\r\n        this._leftArm.obj.position.add(new THREE.Vector3(0, 3, dist));\r\n        this._rightArm.obj.position.add(new THREE.Vector3(0, 3, -dist));\r\n\r\n        // ----------\r\n        this._leftLeg = new Leg(this._waist.lowObj);\r\n        this._leftLeg.d = -1;\r\n\r\n        this._rightLeg = new Leg(this._waist.lowObj);\r\n        this._rightLeg.alpha = Math.PI;\r\n        this._rightLeg.d = 1;\r\n\r\n        this._leftLeg.obj.position.add(new THREE.Vector3(0, 0, dist));\r\n        this._rightLeg.obj.position.add(new THREE.Vector3(0, 0, -dist));\r\n\r\n        // ----------\r\n        this._head = new Head(this._waist._headObj);\r\n\r\n\r\n    }\r\n\r\n    update(){\r\n\r\n\r\n        this._waist.update();\r\n        //this._waist.obj.rotation.z = GlobalVars.t;\r\n\r\n        this._leftLeg.update();\r\n        this._rightLeg.update();\r\n\r\n        this._leftArm.update();\r\n        this._rightArm.update();\r\n\r\n    }\r\n}\r\n","import * as THREE from 'three';\r\n\r\nimport GlobalVars from \"../../data/globalVars\";\r\nimport Math2 from \"../../data/math2\";\r\nimport Camera from './camera';\r\nimport Controls from './controls';\r\n\r\nlet g_app = null;\r\nconst mouse = new THREE.Vector2();\r\nvar l_mouse = new THREE.Vector2();\r\nvar dx = 0;\r\nvar camX = 0;\r\n\r\n\r\nexport default class Cinemachine {\r\n\r\n    constructor(app) {\r\n\r\n        g_app = app;\r\n        this.cam = new Camera(app.renderer.threeRenderer);\r\n        this.cam = this.cam.threeCamera;\r\n\r\n        app.man.add(this.cam);\r\n        this.cam.position.set(5, 3, 0);\r\n        this.cam.rotation.x = -15*Math2.deg2rad;\r\n        //this.cam.position.z = 10;\r\n        // this.cam.rotation.y = Math.PI/2;\r\n\r\n        this.camGO = new THREE.Object3D();\r\n        this.camGO.position.z = 0;\r\n        this.camGO.position.x = 15;\r\n        this.camGO.position.y = 7;\r\n\r\n        this.camGO.rotation.y = Math.PI/2;\r\n        //this.camGO.add(new THREE.Mesh(new THREE.SphereGeometry(1, 32, 32), new THREE.MeshNormalMaterial()));\r\n        this.camGO.add(this.cam);\r\n        app.man.add(this.camGO);\r\n\r\n\r\n\r\n\r\n        window.addEventListener('mousemove', mousemove);\r\n\r\n    }\r\n\r\n    update(){\r\n\r\n        this.moveX();\r\n\r\n\r\n        //this.cam.lookAt(g_app.man_chido._waist.obj.position);\r\n\r\n\r\n\r\n    }\r\n\r\n    moveX(){\r\n\r\n        camX += Math.sign(dx) * 0.2;\r\n        this.cam.position.x = camX;\r\n\r\n        if(camX > 6)\r\n            camX = 6;\r\n\r\n        if(camX < -6)\r\n            camX = -6;\r\n\r\n\r\n        dx = 0;\r\n    }\r\n\r\n    \r\n}\r\n\r\n\r\nfunction mousemove(e){\r\n\r\n    mouse.x = ( event.clientX / window.innerWidth ) * 2 - 1;\r\n    mouse.y = - ( event.clientY / window.innerHeight ) * 2 + 1;\r\n\r\n    dx = mouse.x - l_mouse.x;\r\n\r\n    l_mouse.x = mouse.x;\r\n    l_mouse.y = mouse.y;\r\n}\r\n\r\nvar lerp = ( x, y, t ) => ( 1 - t ) * x + t * y;\r\n","// Local vars for rStats\r\nlet rS, bS, glS, tS;\r\n\r\nexport default class Stats {\r\n  constructor(renderer) {\r\n    this.renderer = renderer;\r\n  }\r\n\r\n  setUp() {\r\n    bS = new BrowserStats();\r\n    glS = new glStats();\r\n    tS = new threeStats(this.renderer.threeRenderer);\r\n\r\n    rS = new rStats({\r\n      CSSPath: './css/',\r\n      userTimingAPI: true,\r\n      values: {\r\n        frame: { caption: 'Total frame time (ms)', over: 16, average: true, avgMs: 100 },\r\n        fps: { caption: 'Framerate (FPS)', below: 30 },\r\n        calls: { caption: 'Calls (three.js)', over: 3000 },\r\n        raf: { caption: 'Time since last rAF (ms)', average: true, avgMs: 100 },\r\n        rstats: { caption: 'rStats update (ms)', average: true, avgMs: 100 },\r\n        texture: { caption: 'GenTex', average: true, avgMs: 100 }\r\n      },\r\n      groups: [\r\n        { caption: 'Framerate', values: ['fps', 'raf'] },\r\n        { caption: 'Frame Budget', values: ['frame', 'texture', 'setup', 'render'] }\r\n      ],\r\n      fractions: [\r\n        { base: 'frame', steps: ['texture', 'setup', 'render'] }\r\n      ],\r\n      plugins: [bS, tS]\r\n    });\r\n  }\r\n\r\n  static start() {\r\n    rS('frame').start();\r\n    glS.start();\r\n\r\n    rS('rAF').tick();\r\n    rS('FPS').frame();\r\n\r\n    rS('render').start();\r\n  }\r\n\r\n  static end() {\r\n    rS('render').end(); // render finished\r\n    rS('frame').end(); // frame finished\r\n\r\n    // Local rStats update\r\n    rS('rStats').start();\r\n    rS().update();\r\n    rS('rStats').end();\r\n  }\r\n}\r\n","/**\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n */\r\n\r\nimport {\r\n  BufferGeometry,\r\n  Float32BufferAttribute,\r\n  LineSegments,\r\n  LineBasicMaterial,\r\n  Matrix3,\r\n  Vector3,\r\n} from 'three';\r\n\r\nconst _v1 = new Vector3();\r\nconst _v2 = new Vector3();\r\nconst _normalMatrix = new Matrix3();\r\nconst _keys = ['a', 'b', 'c'];\r\n\r\nfunction VertexNormalsHelper(object, size, hex) {\r\n  this.object = object;\r\n  this.size = size !== undefined ? size : 0.1;\r\n\r\n  const color = hex !== undefined ? hex : 0xff0000;\r\n\r\n  //\r\n\r\n  let nNormals = 0;\r\n\r\n  const objGeometry = this.object.geometry;\r\n\r\n  if (objGeometry && objGeometry.isGeometry) {\r\n    nNormals = objGeometry.faces.length * 3;\r\n  } else if (objGeometry && objGeometry.isBufferGeometry) {\r\n    nNormals = objGeometry.attributes.normal.count;\r\n  }\r\n\r\n  //\r\n\r\n  const geometry = new BufferGeometry();\r\n  const positions = new Float32BufferAttribute(nNormals * 2 * 3, 3);\r\n\r\n  geometry.setAttribute('position', positions);\r\n\r\n  LineSegments.call(this, geometry, new LineBasicMaterial({ color: color, toneMapped: false }));\r\n\r\n  this.type = 'VertexNormalsHelper';\r\n\r\n  //\r\n\r\n  this.matrixAutoUpdate = false;\r\n\r\n  this.update();\r\n}\r\n\r\nVertexNormalsHelper.prototype = Object.create(LineSegments.prototype);\r\nVertexNormalsHelper.prototype.constructor = VertexNormalsHelper;\r\n\r\nVertexNormalsHelper.prototype.update = function () {\r\n  let idx;\r\n  this.object.updateMatrixWorld(true);\r\n\r\n  _normalMatrix.getNormalMatrix(this.object.matrixWorld);\r\n\r\n  const matrixWorld = this.object.matrixWorld;\r\n  const position = this.geometry.attributes.position;\r\n\r\n  //\r\n\r\n  const objGeometry = this.object.geometry;\r\n\r\n  if (objGeometry && objGeometry.isGeometry) {\r\n    const vertices = objGeometry.vertices;\r\n\r\n    const faces = objGeometry.faces;\r\n\r\n    idx = 0;\r\n\r\n    for (let i = 0, l = faces.length; i < l; i++) {\r\n      const face = faces[i];\r\n\r\n      for (let j = 0, jl = face.vertexNormals.length; j < jl; j++) {\r\n        const vertex = vertices[face[_keys[j]]];\r\n        const normal = face.vertexNormals[j];\r\n\r\n        _v1.copy(vertex).applyMatrix4(matrixWorld);\r\n        _v2.copy(normal).applyMatrix3(_normalMatrix).normalize().multiplyScalar(this.size).add(_v1);\r\n\r\n        position.setXYZ(idx, _v1.x, _v1.y, _v1.z);\r\n\r\n        idx = idx + 1;\r\n\r\n        position.setXYZ(idx, _v2.x, _v2.y, _v2.z);\r\n\r\n        idx = idx + 1;\r\n      }\r\n    }\r\n  } else if (objGeometry && objGeometry.isBufferGeometry) {\r\n    const objPos = objGeometry.attributes.position;\r\n    const objNorm = objGeometry.attributes.normal;\r\n\r\n    idx = 0;\r\n\r\n    // for simplicity, ignore index and drawcalls, and render every normal\r\n\r\n    for (var j = 0, jl = objPos.count; j < jl; j++) {\r\n      _v1.set(objPos.getX(j), objPos.getY(j), objPos.getZ(j)).applyMatrix4(matrixWorld);\r\n      _v2.set(objNorm.getX(j), objNorm.getY(j), objNorm.getZ(j));\r\n      _v2.applyMatrix3(_normalMatrix).normalize().multiplyScalar(this.size).add(_v1);\r\n\r\n      position.setXYZ(idx, _v1.x, _v1.y, _v1.z);\r\n\r\n      idx = idx + 1;\r\n\r\n      position.setXYZ(idx, _v2.x, _v2.y, _v2.z);\r\n\r\n      idx = idx + 1;\r\n    }\r\n  }\r\n\r\n  position.needsUpdate = true;\r\n};\r\n\r\nexport { VertexNormalsHelper };\r\n","/**\r\n * @author Rich Tibbett / https://github.com/richtr\r\n * @author mrdoob / http://mrdoob.com/\r\n * @author Tony Parisi / http://www.tonyparisi.com/\r\n * @author Takahiro / https://github.com/takahirox\r\n * @author Don McCurdy / https://www.donmccurdy.com\r\n */\r\n\r\nimport {\r\n  AnimationClip,\r\n  Bone,\r\n  Box3,\r\n  BufferAttribute,\r\n  BufferGeometry,\r\n  ClampToEdgeWrapping,\r\n  Color,\r\n  DirectionalLight,\r\n  DoubleSide,\r\n  FileLoader,\r\n  FrontSide,\r\n  Group,\r\n  InterleavedBuffer,\r\n  InterleavedBufferAttribute,\r\n  Interpolant,\r\n  InterpolateDiscrete,\r\n  InterpolateLinear,\r\n  Line,\r\n  LineBasicMaterial,\r\n  LineLoop,\r\n  LineSegments,\r\n  LinearFilter,\r\n  LinearMipmapLinearFilter,\r\n  LinearMipmapNearestFilter,\r\n  Loader,\r\n  LoaderUtils,\r\n  Material,\r\n  MathUtils,\r\n  Matrix4,\r\n  Mesh,\r\n  MeshBasicMaterial,\r\n  MeshPhysicalMaterial,\r\n  MeshStandardMaterial,\r\n  MirroredRepeatWrapping,\r\n  NearestFilter,\r\n  NearestMipmapLinearFilter,\r\n  NearestMipmapNearestFilter,\r\n  NumberKeyframeTrack,\r\n  Object3D,\r\n  OrthographicCamera,\r\n  PerspectiveCamera,\r\n  PointLight,\r\n  Points,\r\n  PointsMaterial,\r\n  PropertyBinding,\r\n  QuaternionKeyframeTrack,\r\n  RGBAFormat,\r\n  RGBFormat,\r\n  RepeatWrapping,\r\n  Skeleton,\r\n  SkinnedMesh,\r\n  Sphere,\r\n  SpotLight,\r\n  TangentSpaceNormalMap,\r\n  TextureLoader,\r\n  TriangleFanDrawMode,\r\n  TriangleStripDrawMode,\r\n  Vector2,\r\n  Vector3,\r\n  VectorKeyframeTrack,\r\n  sRGBEncoding\r\n} from 'three';\r\n\r\nconst GLTFLoader = (function () {\r\n  function GLTFLoader(manager) {\r\n    Loader.call(this, manager);\r\n\r\n    this.dracoLoader = null;\r\n    this.ddsLoader = null;\r\n  }\r\n\r\n  GLTFLoader.prototype = Object.assign(Object.create(Loader.prototype), {\r\n    constructor: GLTFLoader,\r\n\r\n    load: function (url, onLoad, onProgress, onError) {\r\n      var scope = this;\r\n\r\n      var resourcePath;\r\n\r\n      if (this.resourcePath !== '') {\r\n        resourcePath = this.resourcePath;\r\n      } else if (this.path !== '') {\r\n        resourcePath = this.path;\r\n      } else {\r\n        resourcePath = LoaderUtils.extractUrlBase(url);\r\n      }\r\n\r\n      // Tells the LoadingManager to track an extra item, which resolves after\r\n      // the model is fully loaded. This means the count of items loaded will\r\n      // be incorrect, but ensures manager.onLoad() does not fire early.\r\n      scope.manager.itemStart(url);\r\n\r\n      var _onError = function (e) {\r\n        if (onError) {\r\n          onError(e);\r\n        } else {\r\n          console.error(e);\r\n        }\r\n\r\n        scope.manager.itemError(url);\r\n        scope.manager.itemEnd(url);\r\n      };\r\n\r\n      var loader = new FileLoader(scope.manager);\r\n\r\n      loader.setPath(this.path);\r\n      loader.setResponseType('arraybuffer');\r\n\r\n      if (scope.crossOrigin === 'use-credentials') {\r\n        loader.setWithCredentials(true);\r\n      }\r\n\r\n      loader.load(\r\n        url,\r\n        function (data) {\r\n          try {\r\n            scope.parse(\r\n              data,\r\n              resourcePath,\r\n              function (gltf) {\r\n                onLoad(gltf);\r\n\r\n                scope.manager.itemEnd(url);\r\n              },\r\n              _onError\r\n            );\r\n          } catch (e) {\r\n            _onError(e);\r\n          }\r\n        },\r\n        onProgress,\r\n        _onError\r\n      );\r\n    },\r\n\r\n    setDRACOLoader: function (dracoLoader) {\r\n      this.dracoLoader = dracoLoader;\r\n      return this;\r\n    },\r\n\r\n    setDDSLoader: function (ddsLoader) {\r\n      this.ddsLoader = ddsLoader;\r\n      return this;\r\n    },\r\n\r\n    parse: function (data, path, onLoad, onError) {\r\n      var content;\r\n      var extensions = {};\r\n\r\n      if (typeof data === 'string') {\r\n        content = data;\r\n      } else {\r\n        var magic = LoaderUtils.decodeText(new Uint8Array(data, 0, 4));\r\n\r\n        if (magic === BINARY_EXTENSION_HEADER_MAGIC) {\r\n          try {\r\n            extensions[EXTENSIONS.KHR_BINARY_GLTF] = new GLTFBinaryExtension(data);\r\n          } catch (error) {\r\n            if (onError) onError(error);\r\n            return;\r\n          }\r\n\r\n          content = extensions[EXTENSIONS.KHR_BINARY_GLTF].content;\r\n        } else {\r\n          content = LoaderUtils.decodeText(new Uint8Array(data));\r\n        }\r\n      }\r\n\r\n      var json = JSON.parse(content);\r\n\r\n      if (json.asset === undefined || json.asset.version[0] < 2) {\r\n        if (onError)\r\n          onError(\r\n            new Error('THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.')\r\n          );\r\n        return;\r\n      }\r\n\r\n      if (json.extensionsUsed) {\r\n        for (var i = 0; i < json.extensionsUsed.length; ++i) {\r\n          var extensionName = json.extensionsUsed[i];\r\n          var extensionsRequired = json.extensionsRequired || [];\r\n\r\n          switch (extensionName) {\r\n            case EXTENSIONS.KHR_LIGHTS_PUNCTUAL:\r\n              extensions[extensionName] = new GLTFLightsExtension(json);\r\n              break;\r\n\r\n            case EXTENSIONS.KHR_MATERIALS_CLEARCOAT:\r\n              extensions[extensionName] = new GLTFMaterialsClearcoatExtension();\r\n              break;\r\n\r\n            case EXTENSIONS.KHR_MATERIALS_UNLIT:\r\n              extensions[extensionName] = new GLTFMaterialsUnlitExtension();\r\n              break;\r\n\r\n            case EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:\r\n              extensions[extensionName] = new GLTFMaterialsPbrSpecularGlossinessExtension();\r\n              break;\r\n\r\n            case EXTENSIONS.KHR_DRACO_MESH_COMPRESSION:\r\n              extensions[extensionName] = new GLTFDracoMeshCompressionExtension(\r\n                json,\r\n                this.dracoLoader\r\n              );\r\n              break;\r\n\r\n            case EXTENSIONS.MSFT_TEXTURE_DDS:\r\n              extensions[extensionName] = new GLTFTextureDDSExtension(this.ddsLoader);\r\n              break;\r\n\r\n            case EXTENSIONS.KHR_TEXTURE_TRANSFORM:\r\n              extensions[extensionName] = new GLTFTextureTransformExtension();\r\n              break;\r\n\r\n            case EXTENSIONS.KHR_MESH_QUANTIZATION:\r\n              extensions[extensionName] = new GLTFMeshQuantizationExtension();\r\n              break;\r\n\r\n            default:\r\n              if (extensionsRequired.indexOf(extensionName) >= 0) {\r\n                console.warn('THREE.GLTFLoader: Unknown extension \"' + extensionName + '\".');\r\n              }\r\n          }\r\n        }\r\n      }\r\n\r\n      var parser = new GLTFParser(json, extensions, {\r\n        path: path || this.resourcePath || '',\r\n        crossOrigin: this.crossOrigin,\r\n        manager: this.manager\r\n      });\r\n\r\n      parser.parse(onLoad, onError);\r\n    },\r\n  });\r\n\r\n  /* GLTFREGISTRY */\r\n\r\n  function GLTFRegistry() {\r\n    var objects = {};\r\n\r\n    return {\r\n      get: function (key) {\r\n        return objects[key];\r\n      },\r\n\r\n      add: function (key, object) {\r\n        objects[key] = object;\r\n      },\r\n\r\n      remove: function (key) {\r\n        delete objects[key];\r\n      },\r\n\r\n      removeAll: function () {\r\n        objects = {};\r\n      },\r\n    };\r\n  }\r\n\r\n  /*********************************/\r\n  /********** EXTENSIONS ***********/\r\n  /*********************************/\r\n\r\n  var EXTENSIONS = {\r\n    KHR_BINARY_GLTF: 'KHR_binary_glTF',\r\n    KHR_DRACO_MESH_COMPRESSION: 'KHR_draco_mesh_compression',\r\n    KHR_LIGHTS_PUNCTUAL: 'KHR_lights_punctual',\r\n    KHR_MATERIALS_CLEARCOAT: 'KHR_materials_clearcoat',\r\n    KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS: 'KHR_materials_pbrSpecularGlossiness',\r\n    KHR_MATERIALS_UNLIT: 'KHR_materials_unlit',\r\n    KHR_TEXTURE_TRANSFORM: 'KHR_texture_transform',\r\n    KHR_MESH_QUANTIZATION: 'KHR_mesh_quantization',\r\n    MSFT_TEXTURE_DDS: 'MSFT_texture_dds'\r\n  };\r\n\r\n  /**\r\n   * DDS Texture Extension\r\n   *\r\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/MSFT_texture_dds\r\n   *\r\n   */\r\n  function GLTFTextureDDSExtension(ddsLoader) {\r\n    if (!ddsLoader) {\r\n      throw new Error(\r\n        'THREE.GLTFLoader: Attempting to load .dds texture without importing DDSLoader'\r\n      );\r\n    }\r\n\r\n    this.name = EXTENSIONS.MSFT_TEXTURE_DDS;\r\n    this.ddsLoader = ddsLoader;\r\n  }\r\n\r\n  /**\r\n   * Punctual Lights Extension\r\n   *\r\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_lights_punctual\r\n   */\r\n  function GLTFLightsExtension(json) {\r\n    this.name = EXTENSIONS.KHR_LIGHTS_PUNCTUAL;\r\n\r\n    var extension = (json.extensions && json.extensions[EXTENSIONS.KHR_LIGHTS_PUNCTUAL]) || {};\r\n    this.lightDefs = extension.lights || [];\r\n  }\r\n\r\n  GLTFLightsExtension.prototype.loadLight = function (lightIndex) {\r\n    var lightDef = this.lightDefs[lightIndex];\r\n    var lightNode;\r\n\r\n    var color = new Color(0xffffff);\r\n    if (lightDef.color !== undefined) color.fromArray(lightDef.color);\r\n\r\n    var range = lightDef.range !== undefined ? lightDef.range : 0;\r\n\r\n    switch (lightDef.type) {\r\n      case 'directional':\r\n        lightNode = new DirectionalLight(color);\r\n        lightNode.target.position.set(0, 0, -1);\r\n        lightNode.add(lightNode.target);\r\n        break;\r\n\r\n      case 'point':\r\n        lightNode = new PointLight(color);\r\n        lightNode.distance = range;\r\n        break;\r\n\r\n      case 'spot':\r\n        lightNode = new SpotLight(color);\r\n        lightNode.distance = range;\r\n        // Handle spotlight properties.\r\n        lightDef.spot = lightDef.spot || {};\r\n        lightDef.spot.innerConeAngle =\r\n          lightDef.spot.innerConeAngle !== undefined ? lightDef.spot.innerConeAngle : 0;\r\n        lightDef.spot.outerConeAngle =\r\n          lightDef.spot.outerConeAngle !== undefined ? lightDef.spot.outerConeAngle : Math.PI / 4.0;\r\n        lightNode.angle = lightDef.spot.outerConeAngle;\r\n        lightNode.penumbra = 1.0 - lightDef.spot.innerConeAngle / lightDef.spot.outerConeAngle;\r\n        lightNode.target.position.set(0, 0, -1);\r\n        lightNode.add(lightNode.target);\r\n        break;\r\n\r\n      default:\r\n        throw new Error('THREE.GLTFLoader: Unexpected light type, \"' + lightDef.type + '\".');\r\n    }\r\n\r\n    // Some lights (e.g. spot) default to a position other than the origin. Reset the position\r\n    // here, because node-level parsing will only override position if explicitly specified.\r\n    lightNode.position.set(0, 0, 0);\r\n\r\n    lightNode.decay = 2;\r\n\r\n    if (lightDef.intensity !== undefined) lightNode.intensity = lightDef.intensity;\r\n\r\n    lightNode.name = lightDef.name || 'light_' + lightIndex;\r\n\r\n    return Promise.resolve(lightNode);\r\n  };\r\n\r\n  /**\r\n   * Unlit Materials Extension\r\n   *\r\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_unlit\r\n   */\r\n  function GLTFMaterialsUnlitExtension() {\r\n    this.name = EXTENSIONS.KHR_MATERIALS_UNLIT;\r\n  }\r\n\r\n  GLTFMaterialsUnlitExtension.prototype.getMaterialType = function () {\r\n    return MeshBasicMaterial;\r\n  };\r\n\r\n  GLTFMaterialsUnlitExtension.prototype.extendParams = function (\r\n    materialParams,\r\n    materialDef,\r\n    parser\r\n  ) {\r\n    var pending = [];\r\n\r\n    materialParams.color = new Color(1.0, 1.0, 1.0);\r\n    materialParams.opacity = 1.0;\r\n\r\n    var metallicRoughness = materialDef.pbrMetallicRoughness;\r\n\r\n    if (metallicRoughness) {\r\n      if (Array.isArray(metallicRoughness.baseColorFactor)) {\r\n        var array = metallicRoughness.baseColorFactor;\r\n\r\n        materialParams.color.fromArray(array);\r\n        materialParams.opacity = array[3];\r\n      }\r\n\r\n      if (metallicRoughness.baseColorTexture !== undefined) {\r\n        pending.push(\r\n          parser.assignTexture(materialParams, 'map', metallicRoughness.baseColorTexture)\r\n        );\r\n      }\r\n    }\r\n\r\n    return Promise.all(pending);\r\n  };\r\n\r\n  /**\r\n   * Clearcoat Materials Extension\r\n   *\r\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_clearcoat\r\n   */\r\n  function GLTFMaterialsClearcoatExtension() {\r\n    this.name = EXTENSIONS.KHR_MATERIALS_CLEARCOAT;\r\n  }\r\n\r\n  GLTFMaterialsClearcoatExtension.prototype.getMaterialType = function () {\r\n    return MeshPhysicalMaterial;\r\n  };\r\n\r\n  GLTFMaterialsClearcoatExtension.prototype.extendParams = function (\r\n    materialParams,\r\n    materialDef,\r\n    parser\r\n  ) {\r\n    var pending = [];\r\n\r\n    var extension = materialDef.extensions[this.name];\r\n\r\n    if (extension.clearcoatFactor !== undefined) {\r\n      materialParams.clearcoat = extension.clearcoatFactor;\r\n    }\r\n\r\n    if (extension.clearcoatTexture !== undefined) {\r\n      pending.push(\r\n        parser.assignTexture(materialParams, 'clearcoatMap', extension.clearcoatTexture)\r\n      );\r\n    }\r\n\r\n    if (extension.clearcoatRoughnessFactor !== undefined) {\r\n      materialParams.clearcoatRoughness = extension.clearcoatRoughnessFactor;\r\n    }\r\n\r\n    if (extension.clearcoatRoughnessTexture !== undefined) {\r\n      pending.push(\r\n        parser.assignTexture(\r\n          materialParams,\r\n          'clearcoatRoughnessMap',\r\n          extension.clearcoatRoughnessTexture\r\n        )\r\n      );\r\n    }\r\n\r\n    if (extension.clearcoatNormalTexture !== undefined) {\r\n      pending.push(\r\n        parser.assignTexture(\r\n          materialParams,\r\n          'clearcoatNormalMap',\r\n          extension.clearcoatNormalTexture\r\n        )\r\n      );\r\n\r\n      if (extension.clearcoatNormalTexture.scale !== undefined) {\r\n        var scale = extension.clearcoatNormalTexture.scale;\r\n\r\n        materialParams.clearcoatNormalScale = new Vector2(scale, scale);\r\n      }\r\n    }\r\n\r\n    return Promise.all(pending);\r\n  };\r\n\r\n  /* BINARY EXTENSION */\r\n  var BINARY_EXTENSION_HEADER_MAGIC = 'glTF';\r\n  var BINARY_EXTENSION_HEADER_LENGTH = 12;\r\n  var BINARY_EXTENSION_CHUNK_TYPES = { JSON: 0x4e4f534a, BIN: 0x004e4942 };\r\n\r\n  function GLTFBinaryExtension(data) {\r\n    this.name = EXTENSIONS.KHR_BINARY_GLTF;\r\n    this.content = null;\r\n    this.body = null;\r\n\r\n    var headerView = new DataView(data, 0, BINARY_EXTENSION_HEADER_LENGTH);\r\n\r\n    this.header = {\r\n      magic: LoaderUtils.decodeText(new Uint8Array(data.slice(0, 4))),\r\n      version: headerView.getUint32(4, true),\r\n      length: headerView.getUint32(8, true)\r\n    };\r\n\r\n    if (this.header.magic !== BINARY_EXTENSION_HEADER_MAGIC) {\r\n      throw new Error('THREE.GLTFLoader: Unsupported glTF-Binary header.');\r\n    } else if (this.header.version < 2.0) {\r\n      throw new Error('THREE.GLTFLoader: Legacy binary file detected.');\r\n    }\r\n\r\n    var chunkView = new DataView(data, BINARY_EXTENSION_HEADER_LENGTH);\r\n    var chunkIndex = 0;\r\n\r\n    while (chunkIndex < chunkView.byteLength) {\r\n      var chunkLength = chunkView.getUint32(chunkIndex, true);\r\n      chunkIndex += 4;\r\n\r\n      var chunkType = chunkView.getUint32(chunkIndex, true);\r\n      chunkIndex += 4;\r\n\r\n      if (chunkType === BINARY_EXTENSION_CHUNK_TYPES.JSON) {\r\n        var contentArray = new Uint8Array(\r\n          data,\r\n          BINARY_EXTENSION_HEADER_LENGTH + chunkIndex,\r\n          chunkLength\r\n        );\r\n        this.content = LoaderUtils.decodeText(contentArray);\r\n      } else if (chunkType === BINARY_EXTENSION_CHUNK_TYPES.BIN) {\r\n        var byteOffset = BINARY_EXTENSION_HEADER_LENGTH + chunkIndex;\r\n        this.body = data.slice(byteOffset, byteOffset + chunkLength);\r\n      }\r\n\r\n      // Clients must ignore chunks with unknown types.\r\n\r\n      chunkIndex += chunkLength;\r\n    }\r\n\r\n    if (this.content === null) {\r\n      throw new Error('THREE.GLTFLoader: JSON content not found.');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * DRACO Mesh Compression Extension\r\n   *\r\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_draco_mesh_compression\r\n   */\r\n  function GLTFDracoMeshCompressionExtension(json, dracoLoader) {\r\n    if (!dracoLoader) {\r\n      throw new Error('THREE.GLTFLoader: No DRACOLoader instance provided.');\r\n    }\r\n\r\n    this.name = EXTENSIONS.KHR_DRACO_MESH_COMPRESSION;\r\n    this.json = json;\r\n    this.dracoLoader = dracoLoader;\r\n    this.dracoLoader.preload();\r\n  }\r\n\r\n  GLTFDracoMeshCompressionExtension.prototype.decodePrimitive = function (primitive, parser) {\r\n    var json = this.json;\r\n    var dracoLoader = this.dracoLoader;\r\n    var bufferViewIndex = primitive.extensions[this.name].bufferView;\r\n    var gltfAttributeMap = primitive.extensions[this.name].attributes;\r\n    var threeAttributeMap = {};\r\n    var attributeNormalizedMap = {};\r\n    var attributeTypeMap = {};\r\n\r\n    for (var attributeName in gltfAttributeMap) {\r\n      var threeAttributeName = ATTRIBUTES[attributeName] || attributeName.toLowerCase();\r\n\r\n      threeAttributeMap[threeAttributeName] = gltfAttributeMap[attributeName];\r\n    }\r\n\r\n    for (attributeName in primitive.attributes) {\r\n      var threeAttributeName = ATTRIBUTES[attributeName] || attributeName.toLowerCase();\r\n\r\n      if (gltfAttributeMap[attributeName] !== undefined) {\r\n        var accessorDef = json.accessors[primitive.attributes[attributeName]];\r\n        var componentType = WEBGL_COMPONENT_TYPES[accessorDef.componentType];\r\n\r\n        attributeTypeMap[threeAttributeName] = componentType;\r\n        attributeNormalizedMap[threeAttributeName] = accessorDef.normalized === true;\r\n      }\r\n    }\r\n\r\n    return parser.getDependency('bufferView', bufferViewIndex).then(function (bufferView) {\r\n      return new Promise(function (resolve) {\r\n        dracoLoader.decodeDracoFile(\r\n          bufferView,\r\n          function (geometry) {\r\n            for (var attributeName in geometry.attributes) {\r\n              var attribute = geometry.attributes[attributeName];\r\n              var normalized = attributeNormalizedMap[attributeName];\r\n\r\n              if (normalized !== undefined) attribute.normalized = normalized;\r\n            }\r\n\r\n            resolve(geometry);\r\n          },\r\n          threeAttributeMap,\r\n          attributeTypeMap\r\n        );\r\n      });\r\n    });\r\n  };\r\n\r\n  /**\r\n   * Texture Transform Extension\r\n   *\r\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_texture_transform\r\n   */\r\n  function GLTFTextureTransformExtension() {\r\n    this.name = EXTENSIONS.KHR_TEXTURE_TRANSFORM;\r\n  }\r\n\r\n  GLTFTextureTransformExtension.prototype.extendTexture = function (texture, transform) {\r\n    texture = texture.clone();\r\n\r\n    if (transform.offset !== undefined) {\r\n      texture.offset.fromArray(transform.offset);\r\n    }\r\n\r\n    if (transform.rotation !== undefined) {\r\n      texture.rotation = transform.rotation;\r\n    }\r\n\r\n    if (transform.scale !== undefined) {\r\n      texture.repeat.fromArray(transform.scale);\r\n    }\r\n\r\n    if (transform.texCoord !== undefined) {\r\n      console.warn(\r\n        'THREE.GLTFLoader: Custom UV sets in \"' + this.name + '\" extension not yet supported.'\r\n      );\r\n    }\r\n\r\n    texture.needsUpdate = true;\r\n\r\n    return texture;\r\n  };\r\n\r\n  /**\r\n   * Specular-Glossiness Extension\r\n   *\r\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_pbrSpecularGlossiness\r\n   */\r\n\r\n  /**\r\n   * A sub class of StandardMaterial with some of the functionality\r\n   * changed via the `onBeforeCompile` callback\r\n   * @pailhead\r\n   */\r\n\r\n  function GLTFMeshStandardSGMaterial(params) {\r\n    MeshStandardMaterial.call(this);\r\n\r\n    this.isGLTFSpecularGlossinessMaterial = true;\r\n\r\n    //various chunks that need replacing\r\n    var specularMapParsFragmentChunk = [\r\n      '#ifdef USE_SPECULARMAP',\r\n      '\tuniform sampler2D specularMap;',\r\n      '#endif',\r\n    ].join('\\n');\r\n\r\n    var glossinessMapParsFragmentChunk = [\r\n      '#ifdef USE_GLOSSINESSMAP',\r\n      '\tuniform sampler2D glossinessMap;',\r\n      '#endif',\r\n    ].join('\\n');\r\n\r\n    var specularMapFragmentChunk = [\r\n      'vec3 specularFactor = specular;',\r\n      '#ifdef USE_SPECULARMAP',\r\n      '\tvec4 texelSpecular = texture2D( specularMap, vUv );',\r\n      '\ttexelSpecular = sRGBToLinear( texelSpecular );',\r\n      '\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture',\r\n      '\tspecularFactor *= texelSpecular.rgb;',\r\n      '#endif',\r\n    ].join('\\n');\r\n\r\n    var glossinessMapFragmentChunk = [\r\n      'float glossinessFactor = glossiness;',\r\n      '#ifdef USE_GLOSSINESSMAP',\r\n      '\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );',\r\n      '\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture',\r\n      '\tglossinessFactor *= texelGlossiness.a;',\r\n      '#endif',\r\n    ].join('\\n');\r\n\r\n    var lightPhysicalFragmentChunk = [\r\n      'PhysicalMaterial material;',\r\n      'material.diffuseColor = diffuseColor.rgb;',\r\n      'vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );',\r\n      'float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );',\r\n      'material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.',\r\n      'material.specularRoughness += geometryRoughness;',\r\n      'material.specularRoughness = min( material.specularRoughness, 1.0 );',\r\n      'material.specularColor = specularFactor.rgb;',\r\n    ].join('\\n');\r\n\r\n    var uniforms = {\r\n      specular: { value: new Color().setHex(0xffffff) },\r\n      glossiness: { value: 1 },\r\n      specularMap: { value: null },\r\n      glossinessMap: { value: null },\r\n    };\r\n\r\n    this._extraUniforms = uniforms;\r\n\r\n    // please see #14031 or #13198 for an alternate approach\r\n    this.onBeforeCompile = function (shader) {\r\n      for (var uniformName in uniforms) {\r\n        shader.uniforms[uniformName] = uniforms[uniformName];\r\n      }\r\n\r\n      shader.fragmentShader = shader.fragmentShader.replace(\r\n        'uniform float roughness;',\r\n        'uniform vec3 specular;'\r\n      );\r\n      shader.fragmentShader = shader.fragmentShader.replace(\r\n        'uniform float metalness;',\r\n        'uniform float glossiness;'\r\n      );\r\n      shader.fragmentShader = shader.fragmentShader.replace(\r\n        '#include <roughnessmap_pars_fragment>',\r\n        specularMapParsFragmentChunk\r\n      );\r\n      shader.fragmentShader = shader.fragmentShader.replace(\r\n        '#include <metalnessmap_pars_fragment>',\r\n        glossinessMapParsFragmentChunk\r\n      );\r\n      shader.fragmentShader = shader.fragmentShader.replace(\r\n        '#include <roughnessmap_fragment>',\r\n        specularMapFragmentChunk\r\n      );\r\n      shader.fragmentShader = shader.fragmentShader.replace(\r\n        '#include <metalnessmap_fragment>',\r\n        glossinessMapFragmentChunk\r\n      );\r\n      shader.fragmentShader = shader.fragmentShader.replace(\r\n        '#include <lights_physical_fragment>',\r\n        lightPhysicalFragmentChunk\r\n      );\r\n    };\r\n\r\n    /*eslint-disable*/\r\n    Object.defineProperties(this, {\r\n      specular: {\r\n        get: function () {\r\n          return uniforms.specular.value;\r\n        },\r\n        set: function (v) {\r\n          uniforms.specular.value = v;\r\n        },\r\n      },\r\n      specularMap: {\r\n        get: function () {\r\n          return uniforms.specularMap.value;\r\n        },\r\n        set: function (v) {\r\n          uniforms.specularMap.value = v;\r\n        },\r\n      },\r\n      glossiness: {\r\n        get: function () {\r\n          return uniforms.glossiness.value;\r\n        },\r\n        set: function (v) {\r\n          uniforms.glossiness.value = v;\r\n        },\r\n      },\r\n      glossinessMap: {\r\n        get: function () {\r\n          return uniforms.glossinessMap.value;\r\n        },\r\n        set: function (v) {\r\n          uniforms.glossinessMap.value = v;\r\n          //how about something like this - @pailhead\r\n          if (v) {\r\n            this.defines.USE_GLOSSINESSMAP = '';\r\n            // set USE_ROUGHNESSMAP to enable vUv\r\n            this.defines.USE_ROUGHNESSMAP = '';\r\n          } else {\r\n            delete this.defines.USE_ROUGHNESSMAP;\r\n            delete this.defines.USE_GLOSSINESSMAP;\r\n          }\r\n        },\r\n      },\r\n    });\r\n\r\n    /*eslint-enable*/\r\n    delete this.metalness;\r\n    delete this.roughness;\r\n    delete this.metalnessMap;\r\n    delete this.roughnessMap;\r\n\r\n    this.setValues(params);\r\n  }\r\n\r\n  GLTFMeshStandardSGMaterial.prototype = Object.create(MeshStandardMaterial.prototype);\r\n  GLTFMeshStandardSGMaterial.prototype.constructor = GLTFMeshStandardSGMaterial;\r\n\r\n  GLTFMeshStandardSGMaterial.prototype.copy = function (source) {\r\n    MeshStandardMaterial.prototype.copy.call(this, source);\r\n    this.specularMap = source.specularMap;\r\n    this.specular.copy(source.specular);\r\n    this.glossinessMap = source.glossinessMap;\r\n    this.glossiness = source.glossiness;\r\n    delete this.metalness;\r\n    delete this.roughness;\r\n    delete this.metalnessMap;\r\n    delete this.roughnessMap;\r\n    return this;\r\n  };\r\n\r\n  function GLTFMaterialsPbrSpecularGlossinessExtension() {\r\n    return {\r\n      name: EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,\r\n\r\n      specularGlossinessParams: [\r\n        'color',\r\n        'map',\r\n        'lightMap',\r\n        'lightMapIntensity',\r\n        'aoMap',\r\n        'aoMapIntensity',\r\n        'emissive',\r\n        'emissiveIntensity',\r\n        'emissiveMap',\r\n        'bumpMap',\r\n        'bumpScale',\r\n        'normalMap',\r\n        'normalMapType',\r\n        'displacementMap',\r\n        'displacementScale',\r\n        'displacementBias',\r\n        'specularMap',\r\n        'specular',\r\n        'glossinessMap',\r\n        'glossiness',\r\n        'alphaMap',\r\n        'envMap',\r\n        'envMapIntensity',\r\n        'refractionRatio',\r\n      ],\r\n\r\n      getMaterialType: function () {\r\n        return GLTFMeshStandardSGMaterial;\r\n      },\r\n\r\n      extendParams: function (materialParams, materialDef, parser) {\r\n        var pbrSpecularGlossiness = materialDef.extensions[this.name];\r\n\r\n        materialParams.color = new Color(1.0, 1.0, 1.0);\r\n        materialParams.opacity = 1.0;\r\n\r\n        var pending = [];\r\n\r\n        if (Array.isArray(pbrSpecularGlossiness.diffuseFactor)) {\r\n          var array = pbrSpecularGlossiness.diffuseFactor;\r\n\r\n          materialParams.color.fromArray(array);\r\n          materialParams.opacity = array[3];\r\n        }\r\n\r\n        if (pbrSpecularGlossiness.diffuseTexture !== undefined) {\r\n          pending.push(\r\n            parser.assignTexture(materialParams, 'map', pbrSpecularGlossiness.diffuseTexture)\r\n          );\r\n        }\r\n\r\n        materialParams.emissive = new Color(0.0, 0.0, 0.0);\r\n        materialParams.glossiness =\r\n          pbrSpecularGlossiness.glossinessFactor !== undefined\r\n            ? pbrSpecularGlossiness.glossinessFactor\r\n            : 1.0;\r\n        materialParams.specular = new Color(1.0, 1.0, 1.0);\r\n\r\n        if (Array.isArray(pbrSpecularGlossiness.specularFactor)) {\r\n          materialParams.specular.fromArray(pbrSpecularGlossiness.specularFactor);\r\n        }\r\n\r\n        if (pbrSpecularGlossiness.specularGlossinessTexture !== undefined) {\r\n          var specGlossMapDef = pbrSpecularGlossiness.specularGlossinessTexture;\r\n          pending.push(parser.assignTexture(materialParams, 'glossinessMap', specGlossMapDef));\r\n          pending.push(parser.assignTexture(materialParams, 'specularMap', specGlossMapDef));\r\n        }\r\n\r\n        return Promise.all(pending);\r\n      },\r\n\r\n      createMaterial: function (materialParams) {\r\n        var material = new GLTFMeshStandardSGMaterial(materialParams);\r\n        material.fog = true;\r\n\r\n        material.color = materialParams.color;\r\n\r\n        material.map = materialParams.map === undefined ? null : materialParams.map;\r\n\r\n        material.lightMap = null;\r\n        material.lightMapIntensity = 1.0;\r\n\r\n        material.aoMap = materialParams.aoMap === undefined ? null : materialParams.aoMap;\r\n        material.aoMapIntensity = 1.0;\r\n\r\n        material.emissive = materialParams.emissive;\r\n        material.emissiveIntensity = 1.0;\r\n        material.emissiveMap =\r\n          materialParams.emissiveMap === undefined ? null : materialParams.emissiveMap;\r\n\r\n        material.bumpMap = materialParams.bumpMap === undefined ? null : materialParams.bumpMap;\r\n        material.bumpScale = 1;\r\n\r\n        material.normalMap =\r\n          materialParams.normalMap === undefined ? null : materialParams.normalMap;\r\n        material.normalMapType = TangentSpaceNormalMap;\r\n\r\n        if (materialParams.normalScale) material.normalScale = materialParams.normalScale;\r\n\r\n        material.displacementMap = null;\r\n        material.displacementScale = 1;\r\n        material.displacementBias = 0;\r\n\r\n        material.specularMap =\r\n          materialParams.specularMap === undefined ? null : materialParams.specularMap;\r\n        material.specular = materialParams.specular;\r\n\r\n        material.glossinessMap =\r\n          materialParams.glossinessMap === undefined ? null : materialParams.glossinessMap;\r\n        material.glossiness = materialParams.glossiness;\r\n\r\n        material.alphaMap = null;\r\n\r\n        material.envMap = materialParams.envMap === undefined ? null : materialParams.envMap;\r\n        material.envMapIntensity = 1.0;\r\n\r\n        material.refractionRatio = 0.98;\r\n\r\n        return material;\r\n      },\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Mesh Quantization Extension\r\n   *\r\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_mesh_quantization\r\n   */\r\n  function GLTFMeshQuantizationExtension() {\r\n    this.name = EXTENSIONS.KHR_MESH_QUANTIZATION;\r\n  }\r\n\r\n  /*********************************/\r\n  /********** INTERPOLATION ********/\r\n  /*********************************/\r\n\r\n  // Spline Interpolation\r\n  // Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#appendix-c-spline-interpolation\r\n  function GLTFCubicSplineInterpolant(parameterPositions, sampleValues, sampleSize, resultBuffer) {\r\n    Interpolant.call(this, parameterPositions, sampleValues, sampleSize, resultBuffer);\r\n  }\r\n\r\n  GLTFCubicSplineInterpolant.prototype = Object.create(Interpolant.prototype);\r\n  GLTFCubicSplineInterpolant.prototype.constructor = GLTFCubicSplineInterpolant;\r\n\r\n  GLTFCubicSplineInterpolant.prototype.copySampleValue_ = function (index) {\r\n    // Copies a sample value to the result buffer. See description of glTF\r\n    // CUBICSPLINE values layout in interpolate_() function below.\r\n\r\n    var result = this.resultBuffer,\r\n        values = this.sampleValues,\r\n        valueSize = this.valueSize,\r\n        offset = index * valueSize * 3 + valueSize;\r\n\r\n    for (var i = 0; i !== valueSize; i++) {\r\n      result[i] = values[offset + i];\r\n    }\r\n\r\n    return result;\r\n  };\r\n\r\n  GLTFCubicSplineInterpolant.prototype.beforeStart_ =\r\n    GLTFCubicSplineInterpolant.prototype.copySampleValue_;\r\n\r\n  GLTFCubicSplineInterpolant.prototype.afterEnd_ =\r\n    GLTFCubicSplineInterpolant.prototype.copySampleValue_;\r\n\r\n  GLTFCubicSplineInterpolant.prototype.interpolate_ = function (i1, t0, t, t1) {\r\n    var result = this.resultBuffer;\r\n    var values = this.sampleValues;\r\n    var stride = this.valueSize;\r\n\r\n    var stride2 = stride * 2;\r\n    var stride3 = stride * 3;\r\n\r\n    var td = t1 - t0;\r\n\r\n    var p = (t - t0) / td;\r\n    var pp = p * p;\r\n    var ppp = pp * p;\r\n\r\n    var offset1 = i1 * stride3;\r\n    var offset0 = offset1 - stride3;\r\n\r\n    var s2 = -2 * ppp + 3 * pp;\r\n    var s3 = ppp - pp;\r\n    var s0 = 1 - s2;\r\n    var s1 = s3 - pp + p;\r\n\r\n    // Layout of keyframe output values for CUBICSPLINE animations:\r\n    //   [ inTangent_1, splineVertex_1, outTangent_1, inTangent_2, splineVertex_2, ... ]\r\n    for (var i = 0; i !== stride; i++) {\r\n      var p0 = values[offset0 + i + stride]; // splineVertex_k\r\n      var m0 = values[offset0 + i + stride2] * td; // outTangent_k * (t_k+1 - t_k)\r\n      var p1 = values[offset1 + i + stride]; // splineVertex_k+1\r\n      var m1 = values[offset1 + i] * td; // inTangent_k+1 * (t_k+1 - t_k)\r\n\r\n      result[i] = s0 * p0 + s1 * m0 + s2 * p1 + s3 * m1;\r\n    }\r\n\r\n    return result;\r\n  };\r\n\r\n  /*********************************/\r\n  /********** INTERNALS ************/\r\n  /*********************************/\r\n\r\n  /* CONSTANTS */\r\n\r\n  var WEBGL_CONSTANTS = {\r\n    FLOAT: 5126,\r\n    //FLOAT_MAT2: 35674,\r\n    FLOAT_MAT3: 35675,\r\n    FLOAT_MAT4: 35676,\r\n    FLOAT_VEC2: 35664,\r\n    FLOAT_VEC3: 35665,\r\n    FLOAT_VEC4: 35666,\r\n    LINEAR: 9729,\r\n    REPEAT: 10497,\r\n    SAMPLER_2D: 35678,\r\n    POINTS: 0,\r\n    LINES: 1,\r\n    LINE_LOOP: 2,\r\n    LINE_STRIP: 3,\r\n    TRIANGLES: 4,\r\n    TRIANGLE_STRIP: 5,\r\n    TRIANGLE_FAN: 6,\r\n    UNSIGNED_BYTE: 5121,\r\n    UNSIGNED_SHORT: 5123,\r\n  };\r\n\r\n  var WEBGL_COMPONENT_TYPES = {\r\n    5120: Int8Array,\r\n    5121: Uint8Array,\r\n    5122: Int16Array,\r\n    5123: Uint16Array,\r\n    5125: Uint32Array,\r\n    5126: Float32Array,\r\n  };\r\n\r\n  var WEBGL_FILTERS = {\r\n    9728: NearestFilter,\r\n    9729: LinearFilter,\r\n    9984: NearestMipmapNearestFilter,\r\n    9985: LinearMipmapNearestFilter,\r\n    9986: NearestMipmapLinearFilter,\r\n    9987: LinearMipmapLinearFilter,\r\n  };\r\n\r\n  var WEBGL_WRAPPINGS = {\r\n    33071: ClampToEdgeWrapping,\r\n    33648: MirroredRepeatWrapping,\r\n    10497: RepeatWrapping,\r\n  };\r\n\r\n  var WEBGL_TYPE_SIZES = {\r\n    SCALAR: 1,\r\n    VEC2: 2,\r\n    VEC3: 3,\r\n    VEC4: 4,\r\n    MAT2: 4,\r\n    MAT3: 9,\r\n    MAT4: 16,\r\n  };\r\n\r\n  var ATTRIBUTES = {\r\n    POSITION: 'position',\r\n    NORMAL: 'normal',\r\n    TANGENT: 'tangent',\r\n    TEXCOORD_0: 'uv',\r\n    TEXCOORD_1: 'uv2',\r\n    COLOR_0: 'color',\r\n    WEIGHTS_0: 'skinWeight',\r\n    JOINTS_0: 'skinIndex',\r\n  };\r\n\r\n  var PATH_PROPERTIES = {\r\n    scale: 'scale',\r\n    translation: 'position',\r\n    rotation: 'quaternion',\r\n    weights: 'morphTargetInfluences',\r\n  };\r\n\r\n  var INTERPOLATION = {\r\n    CUBICSPLINE: undefined, // We use a custom interpolant (GLTFCubicSplineInterpolation) for CUBICSPLINE tracks. Each\r\n    // keyframe track will be initialized with a default interpolation type, then modified.\r\n    LINEAR: InterpolateLinear,\r\n    STEP: InterpolateDiscrete,\r\n  };\r\n\r\n  var ALPHA_MODES = {\r\n    OPAQUE: 'OPAQUE',\r\n    MASK: 'MASK',\r\n    BLEND: 'BLEND',\r\n  };\r\n\r\n  var MIME_TYPE_FORMATS = {\r\n    'image/png': RGBAFormat,\r\n    'image/jpeg': RGBFormat,\r\n  };\r\n\r\n  /* UTILITY FUNCTIONS */\r\n\r\n  function resolveURL(url, path) {\r\n    // Invalid URL\r\n    if (typeof url !== 'string' || url === '') return '';\r\n\r\n    // Host Relative URL\r\n    if (/^https?:\\/\\//i.test(path) && /^\\//.test(url)) {\r\n      // eslint-disable-next-line no-useless-escape\r\n      path = path.replace(/(^https?:\\/\\/[^\\/]+).*/i, '$1');\r\n    }\r\n\r\n    // Absolute URL http://,https://,//\r\n    if (/^(https?:)?\\/\\//i.test(url)) return url;\r\n\r\n    // Data URI\r\n    if (/^data:.*,.*$/i.test(url)) return url;\r\n\r\n    // Blob URL\r\n    if (/^blob:.*$/i.test(url)) return url;\r\n\r\n    // Relative URL\r\n    return path + url;\r\n  }\r\n\r\n  /**\r\n   * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#default-material\r\n   */\r\n  function createDefaultMaterial(cache) {\r\n    if (cache['DefaultMaterial'] === undefined) {\r\n      cache['DefaultMaterial'] = new MeshStandardMaterial({\r\n        color: 0xffffff,\r\n        emissive: 0x000000,\r\n        metalness: 1,\r\n        roughness: 1,\r\n        transparent: false,\r\n        depthTest: true,\r\n        side: FrontSide,\r\n      });\r\n    }\r\n\r\n    return cache['DefaultMaterial'];\r\n  }\r\n\r\n  function addUnknownExtensionsToUserData(knownExtensions, object, objectDef) {\r\n    // Add unknown glTF extensions to an object's userData.\r\n\r\n    for (var name in objectDef.extensions) {\r\n      if (knownExtensions[name] === undefined) {\r\n        object.userData.gltfExtensions = object.userData.gltfExtensions || {};\r\n        object.userData.gltfExtensions[name] = objectDef.extensions[name];\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @param {Object3D|Material|BufferGeometry} object\r\n   * @param {GLTF.definition} gltfDef\r\n   */\r\n  function assignExtrasToUserData(object, gltfDef) {\r\n    if (gltfDef.extras !== undefined) {\r\n      if (typeof gltfDef.extras === 'object') {\r\n        Object.assign(object.userData, gltfDef.extras);\r\n      } else {\r\n        console.warn('THREE.GLTFLoader: Ignoring primitive type .extras, ' + gltfDef.extras);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#morph-targets\r\n   *\r\n   * @param {BufferGeometry} geometry\r\n   * @param {Array<GLTF.Target>} targets\r\n   * @param {GLTFParser} parser\r\n   * @return {Promise<BufferGeometry>}\r\n   */\r\n  function addMorphTargets(geometry, targets, parser) {\r\n    var hasMorphPosition = false;\r\n    var hasMorphNormal = false;\r\n\r\n    for (var i = 0, il = targets.length; i < il; i++) {\r\n      var target = targets[i];\r\n\r\n      if (target.POSITION !== undefined) hasMorphPosition = true;\r\n      if (target.NORMAL !== undefined) hasMorphNormal = true;\r\n\r\n      if (hasMorphPosition && hasMorphNormal) break;\r\n    }\r\n\r\n    if (!hasMorphPosition && !hasMorphNormal) return Promise.resolve(geometry);\r\n\r\n    var pendingPositionAccessors = [];\r\n    var pendingNormalAccessors = [];\r\n\r\n    for (var i = 0, il = targets.length; i < il; i++) {\r\n      var target = targets[i];\r\n\r\n      if (hasMorphPosition) {\r\n        var pendingAccessor =\r\n              target.POSITION !== undefined\r\n                ? parser.getDependency('accessor', target.POSITION)\r\n                : geometry.attributes.position;\r\n\r\n        pendingPositionAccessors.push(pendingAccessor);\r\n      }\r\n\r\n      if (hasMorphNormal) {\r\n        var pendingAccessor =\r\n              target.NORMAL !== undefined\r\n                ? parser.getDependency('accessor', target.NORMAL)\r\n                : geometry.attributes.normal;\r\n\r\n        pendingNormalAccessors.push(pendingAccessor);\r\n      }\r\n    }\r\n\r\n    return Promise.all([\r\n      Promise.all(pendingPositionAccessors),\r\n      Promise.all(pendingNormalAccessors),\r\n    ]).then(function (accessors) {\r\n      var morphPositions = accessors[0];\r\n      var morphNormals = accessors[1];\r\n\r\n      if (hasMorphPosition) geometry.morphAttributes.position = morphPositions;\r\n      if (hasMorphNormal) geometry.morphAttributes.normal = morphNormals;\r\n      geometry.morphTargetsRelative = true;\r\n\r\n      return geometry;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * @param {Mesh} mesh\r\n   * @param {GLTF.Mesh} meshDef\r\n   */\r\n  function updateMorphTargets(mesh, meshDef) {\r\n    mesh.updateMorphTargets();\r\n\r\n    if (meshDef.weights !== undefined) {\r\n      for (var i = 0, il = meshDef.weights.length; i < il; i++) {\r\n        mesh.morphTargetInfluences[i] = meshDef.weights[i];\r\n      }\r\n    }\r\n\r\n    // .extras has user-defined data, so check that .extras.targetNames is an array.\r\n    if (meshDef.extras && Array.isArray(meshDef.extras.targetNames)) {\r\n      var targetNames = meshDef.extras.targetNames;\r\n\r\n      if (mesh.morphTargetInfluences.length === targetNames.length) {\r\n        mesh.morphTargetDictionary = {};\r\n\r\n        for (var i = 0, il = targetNames.length; i < il; i++) {\r\n          mesh.morphTargetDictionary[targetNames[i]] = i;\r\n        }\r\n      } else {\r\n        console.warn('THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.');\r\n      }\r\n    }\r\n  }\r\n\r\n  function createPrimitiveKey(primitiveDef) {\r\n    var dracoExtension =\r\n          primitiveDef.extensions && primitiveDef.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION];\r\n    var geometryKey;\r\n\r\n    if (dracoExtension) {\r\n      geometryKey =\r\n        'draco:' +\r\n        dracoExtension.bufferView +\r\n        ':' +\r\n        dracoExtension.indices +\r\n        ':' +\r\n        createAttributesKey(dracoExtension.attributes);\r\n    } else {\r\n      geometryKey =\r\n        primitiveDef.indices +\r\n        ':' +\r\n        createAttributesKey(primitiveDef.attributes) +\r\n        ':' +\r\n        primitiveDef.mode;\r\n    }\r\n\r\n    return geometryKey;\r\n  }\r\n\r\n  function createAttributesKey(attributes) {\r\n    var attributesKey = '';\r\n\r\n    var keys = Object.keys(attributes).sort();\r\n\r\n    for (var i = 0, il = keys.length; i < il; i++) {\r\n      attributesKey += keys[i] + ':' + attributes[keys[i]] + ';';\r\n    }\r\n\r\n    return attributesKey;\r\n  }\r\n\r\n  /* GLTF PARSER */\r\n\r\n  function GLTFParser(json, extensions, options) {\r\n    this.json = json || {};\r\n    this.extensions = extensions || {};\r\n    this.options = options || {};\r\n\r\n    // loader object cache\r\n    this.cache = new GLTFRegistry();\r\n\r\n    // BufferGeometry caching\r\n    this.primitiveCache = {};\r\n\r\n    this.textureLoader = new TextureLoader(this.options.manager);\r\n    this.textureLoader.setCrossOrigin(this.options.crossOrigin);\r\n\r\n    this.fileLoader = new FileLoader(this.options.manager);\r\n    this.fileLoader.setResponseType('arraybuffer');\r\n\r\n    if (this.options.crossOrigin === 'use-credentials') {\r\n      this.fileLoader.setWithCredentials(true);\r\n    }\r\n  }\r\n\r\n  GLTFParser.prototype.parse = function (onLoad, onError) {\r\n    var parser = this;\r\n    var json = this.json;\r\n    var extensions = this.extensions;\r\n\r\n    // Clear the loader cache\r\n    this.cache.removeAll();\r\n\r\n    // Mark the special nodes/meshes in json for efficient parse\r\n    this.markDefs();\r\n\r\n    Promise.all([\r\n      this.getDependencies('scene'),\r\n      this.getDependencies('animation'),\r\n      this.getDependencies('camera'),\r\n    ])\r\n      .then(function (dependencies) {\r\n        var result = {\r\n          scene: dependencies[0][json.scene || 0],\r\n          scenes: dependencies[0],\r\n          animations: dependencies[1],\r\n          cameras: dependencies[2],\r\n          asset: json.asset,\r\n          parser: parser,\r\n          userData: {},\r\n        };\r\n\r\n        addUnknownExtensionsToUserData(extensions, result, json);\r\n\r\n        assignExtrasToUserData(result, json);\r\n\r\n        onLoad(result);\r\n      })\r\n      .catch(onError);\r\n  };\r\n\r\n  /**\r\n   * Marks the special nodes/meshes in json for efficient parse.\r\n   */\r\n  GLTFParser.prototype.markDefs = function () {\r\n    var nodeDefs = this.json.nodes || [];\r\n    var skinDefs = this.json.skins || [];\r\n    var meshDefs = this.json.meshes || [];\r\n\r\n    var meshReferences = {};\r\n    var meshUses = {};\r\n\r\n    // Nothing in the node definition indicates whether it is a Bone or an\r\n    // Object3D. Use the skins' joint references to mark bones.\r\n    for (var skinIndex = 0, skinLength = skinDefs.length; skinIndex < skinLength; skinIndex++) {\r\n      var joints = skinDefs[skinIndex].joints;\r\n\r\n      for (var i = 0, il = joints.length; i < il; i++) {\r\n        nodeDefs[joints[i]].isBone = true;\r\n      }\r\n    }\r\n\r\n    // Meshes can (and should) be reused by multiple nodes in a glTF asset. To\r\n    // avoid having more than one Mesh with the same name, count\r\n    // references and rename instances below.\r\n    //\r\n    // Example: CesiumMilkTruck sample model reuses \"Wheel\" meshes.\r\n    for (var nodeIndex = 0, nodeLength = nodeDefs.length; nodeIndex < nodeLength; nodeIndex++) {\r\n      var nodeDef = nodeDefs[nodeIndex];\r\n\r\n      if (nodeDef.mesh !== undefined) {\r\n        if (meshReferences[nodeDef.mesh] === undefined) {\r\n          meshReferences[nodeDef.mesh] = meshUses[nodeDef.mesh] = 0;\r\n        }\r\n\r\n        meshReferences[nodeDef.mesh]++;\r\n\r\n        // Nothing in the mesh definition indicates whether it is\r\n        // a SkinnedMesh or Mesh. Use the node's mesh reference\r\n        // to mark SkinnedMesh if node has skin.\r\n        if (nodeDef.skin !== undefined) {\r\n          meshDefs[nodeDef.mesh].isSkinnedMesh = true;\r\n        }\r\n      }\r\n    }\r\n\r\n    this.json.meshReferences = meshReferences;\r\n    this.json.meshUses = meshUses;\r\n  };\r\n\r\n  /**\r\n   * Requests the specified dependency asynchronously, with caching.\r\n   * @param {string} type\r\n   * @param {number} index\r\n   * @return {Promise<Object3D|Material|THREE.Texture|AnimationClip|ArrayBuffer|Object>}\r\n   */\r\n  GLTFParser.prototype.getDependency = function (type, index) {\r\n    var cacheKey = type + ':' + index;\r\n    var dependency = this.cache.get(cacheKey);\r\n\r\n    if (!dependency) {\r\n      switch (type) {\r\n        case 'scene':\r\n          dependency = this.loadScene(index);\r\n          break;\r\n\r\n        case 'node':\r\n          dependency = this.loadNode(index);\r\n          break;\r\n\r\n        case 'mesh':\r\n          dependency = this.loadMesh(index);\r\n          break;\r\n\r\n        case 'accessor':\r\n          dependency = this.loadAccessor(index);\r\n          break;\r\n\r\n        case 'bufferView':\r\n          dependency = this.loadBufferView(index);\r\n          break;\r\n\r\n        case 'buffer':\r\n          dependency = this.loadBuffer(index);\r\n          break;\r\n\r\n        case 'material':\r\n          dependency = this.loadMaterial(index);\r\n          break;\r\n\r\n        case 'texture':\r\n          dependency = this.loadTexture(index);\r\n          break;\r\n\r\n        case 'skin':\r\n          dependency = this.loadSkin(index);\r\n          break;\r\n\r\n        case 'animation':\r\n          dependency = this.loadAnimation(index);\r\n          break;\r\n\r\n        case 'camera':\r\n          dependency = this.loadCamera(index);\r\n          break;\r\n\r\n        case 'light':\r\n          dependency = this.extensions[EXTENSIONS.KHR_LIGHTS_PUNCTUAL].loadLight(index);\r\n          break;\r\n\r\n        default:\r\n          throw new Error('Unknown type: ' + type);\r\n      }\r\n\r\n      this.cache.add(cacheKey, dependency);\r\n    }\r\n\r\n    return dependency;\r\n  };\r\n\r\n  /**\r\n   * Requests all dependencies of the specified type asynchronously, with caching.\r\n   * @param {string} type\r\n   * @return {Promise<Array<Object>>}\r\n   */\r\n  GLTFParser.prototype.getDependencies = function (type) {\r\n    var dependencies = this.cache.get(type);\r\n\r\n    if (!dependencies) {\r\n      var parser = this;\r\n      var defs = this.json[type + (type === 'mesh' ? 'es' : 's')] || [];\r\n\r\n      dependencies = Promise.all(\r\n        defs.map(function (def, index) {\r\n          return parser.getDependency(type, index);\r\n        })\r\n      );\r\n\r\n      this.cache.add(type, dependencies);\r\n    }\r\n\r\n    return dependencies;\r\n  };\r\n\r\n  /**\r\n   * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\r\n   * @param {number} bufferIndex\r\n   * @return {Promise<ArrayBuffer>}\r\n   */\r\n  GLTFParser.prototype.loadBuffer = function (bufferIndex) {\r\n    var bufferDef = this.json.buffers[bufferIndex];\r\n    var loader = this.fileLoader;\r\n\r\n    if (bufferDef.type && bufferDef.type !== 'arraybuffer') {\r\n      throw new Error('THREE.GLTFLoader: ' + bufferDef.type + ' buffer type is not supported.');\r\n    }\r\n\r\n    // If present, GLB container is required to be the first buffer.\r\n    if (bufferDef.uri === undefined && bufferIndex === 0) {\r\n      return Promise.resolve(this.extensions[EXTENSIONS.KHR_BINARY_GLTF].body);\r\n    }\r\n\r\n    var options = this.options;\r\n\r\n    return new Promise(function (resolve, reject) {\r\n      loader.load(resolveURL(bufferDef.uri, options.path), resolve, undefined, function () {\r\n        reject(new Error('THREE.GLTFLoader: Failed to load buffer \"' + bufferDef.uri + '\".'));\r\n      });\r\n    });\r\n  };\r\n\r\n  /**\r\n   * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\r\n   * @param {number} bufferViewIndex\r\n   * @return {Promise<ArrayBuffer>}\r\n   */\r\n  GLTFParser.prototype.loadBufferView = function (bufferViewIndex) {\r\n    var bufferViewDef = this.json.bufferViews[bufferViewIndex];\r\n\r\n    return this.getDependency('buffer', bufferViewDef.buffer).then(function (buffer) {\r\n      var byteLength = bufferViewDef.byteLength || 0;\r\n      var byteOffset = bufferViewDef.byteOffset || 0;\r\n      return buffer.slice(byteOffset, byteOffset + byteLength);\r\n    });\r\n  };\r\n\r\n  /**\r\n   * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#accessors\r\n   * @param {number} accessorIndex\r\n   * @return {Promise<BufferAttribute|InterleavedBufferAttribute>}\r\n   */\r\n  GLTFParser.prototype.loadAccessor = function (accessorIndex) {\r\n    var parser = this;\r\n    var json = this.json;\r\n\r\n    var accessorDef = this.json.accessors[accessorIndex];\r\n\r\n    if (accessorDef.bufferView === undefined && accessorDef.sparse === undefined) {\r\n      // Ignore empty accessors, which may be used to declare runtime\r\n      // information about attributes coming from another source (e.g. Draco\r\n      // compression extension).\r\n      return Promise.resolve(null);\r\n    }\r\n\r\n    var pendingBufferViews = [];\r\n\r\n    if (accessorDef.bufferView !== undefined) {\r\n      pendingBufferViews.push(this.getDependency('bufferView', accessorDef.bufferView));\r\n    } else {\r\n      pendingBufferViews.push(null);\r\n    }\r\n\r\n    if (accessorDef.sparse !== undefined) {\r\n      pendingBufferViews.push(\r\n        this.getDependency('bufferView', accessorDef.sparse.indices.bufferView)\r\n      );\r\n      pendingBufferViews.push(\r\n        this.getDependency('bufferView', accessorDef.sparse.values.bufferView)\r\n      );\r\n    }\r\n\r\n    return Promise.all(pendingBufferViews).then(function (bufferViews) {\r\n      var bufferView = bufferViews[0];\r\n\r\n      var itemSize = WEBGL_TYPE_SIZES[accessorDef.type];\r\n      var TypedArray = WEBGL_COMPONENT_TYPES[accessorDef.componentType];\r\n\r\n      // For VEC3: itemSize is 3, elementBytes is 4, itemBytes is 12.\r\n      var elementBytes = TypedArray.BYTES_PER_ELEMENT;\r\n      var itemBytes = elementBytes * itemSize;\r\n      var byteOffset = accessorDef.byteOffset || 0;\r\n      var byteStride =\r\n            accessorDef.bufferView !== undefined\r\n              ? json.bufferViews[accessorDef.bufferView].byteStride\r\n              : undefined;\r\n      var normalized = accessorDef.normalized === true;\r\n      var array, bufferAttribute;\r\n\r\n      // The buffer is not interleaved if the stride is the item size in bytes.\r\n      if (byteStride && byteStride !== itemBytes) {\r\n        // Each \"slice\" of the buffer, as defined by 'count' elements of 'byteStride' bytes, gets its own InterleavedBuffer\r\n        // This makes sure that IBA.count reflects accessor.count properly\r\n        var ibSlice = Math.floor(byteOffset / byteStride);\r\n        var ibCacheKey =\r\n              'InterleavedBuffer:' +\r\n              accessorDef.bufferView +\r\n              ':' +\r\n              accessorDef.componentType +\r\n              ':' +\r\n              ibSlice +\r\n              ':' +\r\n              accessorDef.count;\r\n        var ib = parser.cache.get(ibCacheKey);\r\n\r\n        if (!ib) {\r\n          array = new TypedArray(\r\n            bufferView,\r\n            ibSlice * byteStride,\r\n            (accessorDef.count * byteStride) / elementBytes\r\n          );\r\n\r\n          // Integer parameters to IB/IBA are in array elements, not bytes.\r\n          ib = new InterleavedBuffer(array, byteStride / elementBytes);\r\n\r\n          parser.cache.add(ibCacheKey, ib);\r\n        }\r\n\r\n        bufferAttribute = new InterleavedBufferAttribute(\r\n          ib,\r\n          itemSize,\r\n          (byteOffset % byteStride) / elementBytes,\r\n          normalized\r\n        );\r\n      } else {\r\n        if (bufferView === null) {\r\n          array = new TypedArray(accessorDef.count * itemSize);\r\n        } else {\r\n          array = new TypedArray(bufferView, byteOffset, accessorDef.count * itemSize);\r\n        }\r\n\r\n        bufferAttribute = new BufferAttribute(array, itemSize, normalized);\r\n      }\r\n\r\n      // https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#sparse-accessors\r\n      if (accessorDef.sparse !== undefined) {\r\n        var itemSizeIndices = WEBGL_TYPE_SIZES.SCALAR;\r\n        var TypedArrayIndices = WEBGL_COMPONENT_TYPES[accessorDef.sparse.indices.componentType];\r\n\r\n        var byteOffsetIndices = accessorDef.sparse.indices.byteOffset || 0;\r\n        var byteOffsetValues = accessorDef.sparse.values.byteOffset || 0;\r\n\r\n        var sparseIndices = new TypedArrayIndices(\r\n          bufferViews[1],\r\n          byteOffsetIndices,\r\n          accessorDef.sparse.count * itemSizeIndices\r\n        );\r\n        var sparseValues = new TypedArray(\r\n          bufferViews[2],\r\n          byteOffsetValues,\r\n          accessorDef.sparse.count * itemSize\r\n        );\r\n\r\n        if (bufferView !== null) {\r\n          // Avoid modifying the original ArrayBuffer, if the bufferView wasn't initialized with zeroes.\r\n          bufferAttribute = new BufferAttribute(\r\n            bufferAttribute.array.slice(),\r\n            bufferAttribute.itemSize,\r\n            bufferAttribute.normalized\r\n          );\r\n        }\r\n\r\n        for (var i = 0, il = sparseIndices.length; i < il; i++) {\r\n          var index = sparseIndices[i];\r\n\r\n          bufferAttribute.setX(index, sparseValues[i * itemSize]);\r\n          if (itemSize >= 2) bufferAttribute.setY(index, sparseValues[i * itemSize + 1]);\r\n          if (itemSize >= 3) bufferAttribute.setZ(index, sparseValues[i * itemSize + 2]);\r\n          if (itemSize >= 4) bufferAttribute.setW(index, sparseValues[i * itemSize + 3]);\r\n          if (itemSize >= 5)\r\n            throw new Error('THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.');\r\n        }\r\n      }\r\n\r\n      return bufferAttribute;\r\n    });\r\n  };\r\n\r\n  /**\r\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#textures\r\n   * @param {number} textureIndex\r\n   * @return {Promise<THREE.Texture>}\r\n   */\r\n  GLTFParser.prototype.loadTexture = function (textureIndex) {\r\n    var parser = this;\r\n    var json = this.json;\r\n    var options = this.options;\r\n    var textureLoader = this.textureLoader;\r\n\r\n    var URL = self.URL || self.webkitURL;\r\n\r\n    var textureDef = json.textures[textureIndex];\r\n\r\n    var textureExtensions = textureDef.extensions || {};\r\n\r\n    var source;\r\n\r\n    if (textureExtensions[EXTENSIONS.MSFT_TEXTURE_DDS]) {\r\n      source = json.images[textureExtensions[EXTENSIONS.MSFT_TEXTURE_DDS].source];\r\n    } else {\r\n      source = json.images[textureDef.source];\r\n    }\r\n\r\n    var sourceURI = source.uri;\r\n    var isObjectURL = false;\r\n\r\n    if (source.bufferView !== undefined) {\r\n      // Load binary image data from bufferView, if provided.\r\n\r\n      sourceURI = parser.getDependency('bufferView', source.bufferView).then(function (bufferView) {\r\n        isObjectURL = true;\r\n        var blob = new Blob([bufferView], { type: source.mimeType });\r\n        sourceURI = URL.createObjectURL(blob);\r\n        return sourceURI;\r\n      });\r\n    }\r\n\r\n    return Promise.resolve(sourceURI)\r\n      .then(function (sourceURI) {\r\n        // Load Texture resource.\r\n\r\n        var loader = options.manager.getHandler(sourceURI);\r\n\r\n        if (!loader) {\r\n          loader = textureExtensions[EXTENSIONS.MSFT_TEXTURE_DDS]\r\n            ? parser.extensions[EXTENSIONS.MSFT_TEXTURE_DDS].ddsLoader\r\n            : textureLoader;\r\n        }\r\n\r\n        return new Promise(function (resolve, reject) {\r\n          loader.load(resolveURL(sourceURI, options.path), resolve, undefined, reject);\r\n        });\r\n      })\r\n      .then(function (texture) {\r\n        // Clean up resources and configure Texture.\r\n\r\n        if (isObjectURL === true) {\r\n          URL.revokeObjectURL(sourceURI);\r\n        }\r\n\r\n        texture.flipY = false;\r\n\r\n        if (textureDef.name) texture.name = textureDef.name;\r\n\r\n        // Ignore unknown mime types, like DDS files.\r\n        if (source.mimeType in MIME_TYPE_FORMATS) {\r\n          texture.format = MIME_TYPE_FORMATS[source.mimeType];\r\n        }\r\n\r\n        var samplers = json.samplers || {};\r\n        var sampler = samplers[textureDef.sampler] || {};\r\n\r\n        texture.magFilter = WEBGL_FILTERS[sampler.magFilter] || LinearFilter;\r\n        texture.minFilter = WEBGL_FILTERS[sampler.minFilter] || LinearMipmapLinearFilter;\r\n        texture.wrapS = WEBGL_WRAPPINGS[sampler.wrapS] || RepeatWrapping;\r\n        texture.wrapT = WEBGL_WRAPPINGS[sampler.wrapT] || RepeatWrapping;\r\n\r\n        return texture;\r\n      });\r\n  };\r\n\r\n  /**\r\n   * Asynchronously assigns a texture to the given material parameters.\r\n   * @param {Object} materialParams\r\n   * @param {string} mapName\r\n   * @param {Object} mapDef\r\n   * @return {Promise}\r\n   */\r\n  GLTFParser.prototype.assignTexture = function (materialParams, mapName, mapDef) {\r\n    var parser = this;\r\n\r\n    return this.getDependency('texture', mapDef.index).then(function (texture) {\r\n      if (!texture.isCompressedTexture) {\r\n        switch (mapName) {\r\n          case 'aoMap':\r\n          case 'emissiveMap':\r\n          case 'metalnessMap':\r\n          case 'normalMap':\r\n          case 'roughnessMap':\r\n            texture.format = RGBFormat;\r\n            break;\r\n        }\r\n      }\r\n\r\n      // Materials sample aoMap from UV set 1 and other maps from UV set 0 - this can't be configured\r\n      // However, we will copy UV set 0 to UV set 1 on demand for aoMap\r\n      if (\r\n        mapDef.texCoord !== undefined &&\r\n        mapDef.texCoord != 0 &&\r\n        !(mapName === 'aoMap' && mapDef.texCoord == 1)\r\n      ) {\r\n        console.warn(\r\n          'THREE.GLTFLoader: Custom UV set ' +\r\n          mapDef.texCoord +\r\n          ' for texture ' +\r\n          mapName +\r\n          ' not yet supported.'\r\n        );\r\n      }\r\n\r\n      if (parser.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM]) {\r\n        var transform =\r\n              mapDef.extensions !== undefined\r\n                ? mapDef.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM]\r\n                : undefined;\r\n\r\n        if (transform) {\r\n          texture = parser.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM].extendTexture(\r\n            texture,\r\n            transform\r\n          );\r\n        }\r\n      }\r\n\r\n      materialParams[mapName] = texture;\r\n    });\r\n  };\r\n\r\n  /**\r\n   * Assigns final material to a Mesh, Line, or Points instance. The instance\r\n   * already has a material (generated from the glTF material options alone)\r\n   * but reuse of the same glTF material may require multiple threejs materials\r\n   * to accomodate different primitive types, defines, etc. New materials will\r\n   * be created if necessary, and reused from a cache.\r\n   * @param  {Object3D} mesh Mesh, Line, or Points instance.\r\n   */\r\n  GLTFParser.prototype.assignFinalMaterial = function (mesh) {\r\n    var geometry = mesh.geometry;\r\n    var material = mesh.material;\r\n\r\n    var useVertexTangents = geometry.attributes.tangent !== undefined;\r\n    var useVertexColors = geometry.attributes.color !== undefined;\r\n    var useFlatShading = geometry.attributes.normal === undefined;\r\n    var useSkinning = mesh.isSkinnedMesh === true;\r\n    var useMorphTargets = Object.keys(geometry.morphAttributes).length > 0;\r\n    var useMorphNormals = useMorphTargets && geometry.morphAttributes.normal !== undefined;\r\n\r\n    if (mesh.isPoints) {\r\n      var cacheKey = 'PointsMaterial:' + material.uuid;\r\n\r\n      var pointsMaterial = this.cache.get(cacheKey);\r\n\r\n      if (!pointsMaterial) {\r\n        pointsMaterial = new PointsMaterial();\r\n        Material.prototype.copy.call(pointsMaterial, material);\r\n        pointsMaterial.color.copy(material.color);\r\n        pointsMaterial.map = material.map;\r\n        pointsMaterial.sizeAttenuation = false; // glTF spec says points should be 1px\r\n\r\n        this.cache.add(cacheKey, pointsMaterial);\r\n      }\r\n\r\n      material = pointsMaterial;\r\n    } else if (mesh.isLine) {\r\n      var cacheKey = 'LineBasicMaterial:' + material.uuid;\r\n\r\n      var lineMaterial = this.cache.get(cacheKey);\r\n\r\n      if (!lineMaterial) {\r\n        lineMaterial = new LineBasicMaterial();\r\n        Material.prototype.copy.call(lineMaterial, material);\r\n        lineMaterial.color.copy(material.color);\r\n\r\n        this.cache.add(cacheKey, lineMaterial);\r\n      }\r\n\r\n      material = lineMaterial;\r\n    }\r\n\r\n    // Clone the material if it will be modified\r\n    if (useVertexTangents || useVertexColors || useFlatShading || useSkinning || useMorphTargets) {\r\n      var cacheKey = 'ClonedMaterial:' + material.uuid + ':';\r\n\r\n      if (material.isGLTFSpecularGlossinessMaterial) cacheKey += 'specular-glossiness:';\r\n      if (useSkinning) cacheKey += 'skinning:';\r\n      if (useVertexTangents) cacheKey += 'vertex-tangents:';\r\n      if (useVertexColors) cacheKey += 'vertex-colors:';\r\n      if (useFlatShading) cacheKey += 'flat-shading:';\r\n      if (useMorphTargets) cacheKey += 'morph-targets:';\r\n      if (useMorphNormals) cacheKey += 'morph-normals:';\r\n\r\n      var cachedMaterial = this.cache.get(cacheKey);\r\n\r\n      if (!cachedMaterial) {\r\n        cachedMaterial = material.clone();\r\n\r\n        if (useSkinning) cachedMaterial.skinning = true;\r\n        if (useVertexTangents) cachedMaterial.vertexTangents = true;\r\n        if (useVertexColors) cachedMaterial.vertexColors = true;\r\n        if (useFlatShading) cachedMaterial.flatShading = true;\r\n        if (useMorphTargets) cachedMaterial.morphTargets = true;\r\n        if (useMorphNormals) cachedMaterial.morphNormals = true;\r\n\r\n        this.cache.add(cacheKey, cachedMaterial);\r\n      }\r\n\r\n      material = cachedMaterial;\r\n    }\r\n\r\n    // workarounds for mesh and geometry\r\n\r\n    if (\r\n      material.aoMap &&\r\n      geometry.attributes.uv2 === undefined &&\r\n      geometry.attributes.uv !== undefined\r\n    ) {\r\n      geometry.setAttribute('uv2', geometry.attributes.uv);\r\n    }\r\n\r\n    // https://github.com/mrdoob/three.js/issues/11438#issuecomment-507003995\r\n    if (material.normalScale && !useVertexTangents) {\r\n      material.normalScale.y = -material.normalScale.y;\r\n    }\r\n\r\n    if (material.clearcoatNormalScale && !useVertexTangents) {\r\n      material.clearcoatNormalScale.y = -material.clearcoatNormalScale.y;\r\n    }\r\n\r\n    mesh.material = material;\r\n  };\r\n\r\n  /**\r\n   * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#materials\r\n   * @param {number} materialIndex\r\n   * @return {Promise<Material>}\r\n   */\r\n  GLTFParser.prototype.loadMaterial = function (materialIndex) {\r\n    var parser = this;\r\n    var json = this.json;\r\n    var extensions = this.extensions;\r\n    var materialDef = json.materials[materialIndex];\r\n\r\n    var materialType;\r\n    var materialParams = {};\r\n    var materialExtensions = materialDef.extensions || {};\r\n\r\n    var pending = [];\r\n\r\n    if (materialExtensions[EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]) {\r\n      var sgExtension = extensions[EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];\r\n      materialType = sgExtension.getMaterialType();\r\n      pending.push(sgExtension.extendParams(materialParams, materialDef, parser));\r\n    } else if (materialExtensions[EXTENSIONS.KHR_MATERIALS_UNLIT]) {\r\n      var kmuExtension = extensions[EXTENSIONS.KHR_MATERIALS_UNLIT];\r\n      materialType = kmuExtension.getMaterialType();\r\n      pending.push(kmuExtension.extendParams(materialParams, materialDef, parser));\r\n    } else {\r\n      // Specification:\r\n      // https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#metallic-roughness-material\r\n\r\n      materialType = MeshStandardMaterial;\r\n\r\n      var metallicRoughness = materialDef.pbrMetallicRoughness || {};\r\n\r\n      materialParams.color = new Color(1.0, 1.0, 1.0);\r\n      materialParams.opacity = 1.0;\r\n\r\n      if (Array.isArray(metallicRoughness.baseColorFactor)) {\r\n        var array = metallicRoughness.baseColorFactor;\r\n\r\n        materialParams.color.fromArray(array);\r\n        materialParams.opacity = array[3];\r\n      }\r\n\r\n      if (metallicRoughness.baseColorTexture !== undefined) {\r\n        pending.push(\r\n          parser.assignTexture(materialParams, 'map', metallicRoughness.baseColorTexture)\r\n        );\r\n      }\r\n\r\n      materialParams.metalness =\r\n        metallicRoughness.metallicFactor !== undefined ? metallicRoughness.metallicFactor : 1.0;\r\n      materialParams.roughness =\r\n        metallicRoughness.roughnessFactor !== undefined ? metallicRoughness.roughnessFactor : 1.0;\r\n\r\n      if (metallicRoughness.metallicRoughnessTexture !== undefined) {\r\n        pending.push(\r\n          parser.assignTexture(\r\n            materialParams,\r\n            'metalnessMap',\r\n            metallicRoughness.metallicRoughnessTexture\r\n          )\r\n        );\r\n        pending.push(\r\n          parser.assignTexture(\r\n            materialParams,\r\n            'roughnessMap',\r\n            metallicRoughness.metallicRoughnessTexture\r\n          )\r\n        );\r\n      }\r\n    }\r\n\r\n    if (materialDef.doubleSided === true) {\r\n      materialParams.side = DoubleSide;\r\n    }\r\n\r\n    var alphaMode = materialDef.alphaMode || ALPHA_MODES.OPAQUE;\r\n\r\n    if (alphaMode === ALPHA_MODES.BLEND) {\r\n      materialParams.transparent = true;\r\n\r\n      // See: https://github.com/mrdoob/three.js/issues/17706\r\n      materialParams.depthWrite = false;\r\n    } else {\r\n      materialParams.transparent = false;\r\n\r\n      if (alphaMode === ALPHA_MODES.MASK) {\r\n        materialParams.alphaTest =\r\n          materialDef.alphaCutoff !== undefined ? materialDef.alphaCutoff : 0.5;\r\n      }\r\n    }\r\n\r\n    if (materialDef.normalTexture !== undefined && materialType !== MeshBasicMaterial) {\r\n      pending.push(parser.assignTexture(materialParams, 'normalMap', materialDef.normalTexture));\r\n\r\n      materialParams.normalScale = new Vector2(1, 1);\r\n\r\n      if (materialDef.normalTexture.scale !== undefined) {\r\n        materialParams.normalScale.set(\r\n          materialDef.normalTexture.scale,\r\n          materialDef.normalTexture.scale\r\n        );\r\n      }\r\n    }\r\n\r\n    if (materialDef.occlusionTexture !== undefined && materialType !== MeshBasicMaterial) {\r\n      pending.push(parser.assignTexture(materialParams, 'aoMap', materialDef.occlusionTexture));\r\n\r\n      if (materialDef.occlusionTexture.strength !== undefined) {\r\n        materialParams.aoMapIntensity = materialDef.occlusionTexture.strength;\r\n      }\r\n    }\r\n\r\n    if (materialDef.emissiveFactor !== undefined && materialType !== MeshBasicMaterial) {\r\n      materialParams.emissive = new Color().fromArray(materialDef.emissiveFactor);\r\n    }\r\n\r\n    if (materialDef.emissiveTexture !== undefined && materialType !== MeshBasicMaterial) {\r\n      pending.push(\r\n        parser.assignTexture(materialParams, 'emissiveMap', materialDef.emissiveTexture)\r\n      );\r\n    }\r\n\r\n    if (materialExtensions[EXTENSIONS.KHR_MATERIALS_CLEARCOAT]) {\r\n      var clearcoatExtension = extensions[EXTENSIONS.KHR_MATERIALS_CLEARCOAT];\r\n      materialType = clearcoatExtension.getMaterialType();\r\n      pending.push(\r\n        clearcoatExtension.extendParams(materialParams, { extensions: materialExtensions }, parser)\r\n      );\r\n    }\r\n\r\n    return Promise.all(pending).then(function () {\r\n      var material;\r\n\r\n      if (materialType === GLTFMeshStandardSGMaterial) {\r\n        material = extensions[EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(\r\n          materialParams\r\n        );\r\n      } else {\r\n        material = new materialType(materialParams);\r\n      }\r\n\r\n      if (materialDef.name) material.name = materialDef.name;\r\n\r\n      // baseColorTexture, emissiveTexture, and specularGlossinessTexture use sRGB encoding.\r\n      if (material.map) material.map.encoding = sRGBEncoding;\r\n      if (material.emissiveMap) material.emissiveMap.encoding = sRGBEncoding;\r\n\r\n      assignExtrasToUserData(material, materialDef);\r\n\r\n      if (materialDef.extensions) addUnknownExtensionsToUserData(extensions, material, materialDef);\r\n\r\n      return material;\r\n    });\r\n  };\r\n\r\n  /**\r\n   * @param {BufferGeometry} geometry\r\n   * @param {GLTF.Primitive} primitiveDef\r\n   * @param {GLTFParser} parser\r\n   */\r\n  function computeBounds(geometry, primitiveDef, parser) {\r\n    var attributes = primitiveDef.attributes;\r\n\r\n    var box = new Box3();\r\n\r\n    if (attributes.POSITION !== undefined) {\r\n      var accessor = parser.json.accessors[attributes.POSITION];\r\n\r\n      var min = accessor.min;\r\n      var max = accessor.max;\r\n\r\n      // glTF requires 'min' and 'max', but VRM (which extends glTF) currently ignores that requirement.\r\n\r\n      if (min !== undefined && max !== undefined) {\r\n        box.set(new Vector3(min[0], min[1], min[2]), new Vector3(max[0], max[1], max[2]));\r\n      } else {\r\n        console.warn('THREE.GLTFLoader: Missing min/max properties for accessor POSITION.');\r\n\r\n        return;\r\n      }\r\n    } else {\r\n      return;\r\n    }\r\n\r\n    var targets = primitiveDef.targets;\r\n\r\n    if (targets !== undefined) {\r\n      var maxDisplacement = new Vector3();\r\n      var vector = new Vector3();\r\n\r\n      for (var i = 0, il = targets.length; i < il; i++) {\r\n        var target = targets[i];\r\n\r\n        if (target.POSITION !== undefined) {\r\n          var accessor = parser.json.accessors[target.POSITION];\r\n          var min = accessor.min;\r\n          var max = accessor.max;\r\n\r\n          // glTF requires 'min' and 'max', but VRM (which extends glTF) currently ignores that requirement.\r\n\r\n          if (min !== undefined && max !== undefined) {\r\n            // we need to get max of absolute components because target weight is [-1,1]\r\n            vector.setX(Math.max(Math.abs(min[0]), Math.abs(max[0])));\r\n            vector.setY(Math.max(Math.abs(min[1]), Math.abs(max[1])));\r\n            vector.setZ(Math.max(Math.abs(min[2]), Math.abs(max[2])));\r\n\r\n            // Note: this assumes that the sum of all weights is at most 1. This isn't quite correct - it's more conservative\r\n            // to assume that each target can have a max weight of 1. However, for some use cases - notably, when morph targets\r\n            // are used to implement key-frame animations and as such only two are active at a time - this results in very large\r\n            // boxes. So for now we make a box that's sometimes a touch too small but is hopefully mostly of reasonable size.\r\n            maxDisplacement.max(vector);\r\n          } else {\r\n            console.warn('THREE.GLTFLoader: Missing min/max properties for accessor POSITION.');\r\n          }\r\n        }\r\n      }\r\n\r\n      // As per comment above this box isn't conservative, but has a reasonable size for a very large number of morph targets.\r\n      box.expandByVector(maxDisplacement);\r\n    }\r\n\r\n    geometry.boundingBox = box;\r\n\r\n    var sphere = new Sphere();\r\n\r\n    box.getCenter(sphere.center);\r\n    sphere.radius = box.min.distanceTo(box.max) / 2;\r\n\r\n    geometry.boundingSphere = sphere;\r\n  }\r\n\r\n  /**\r\n   * @param {BufferGeometry} geometry\r\n   * @param {GLTF.Primitive} primitiveDef\r\n   * @param {GLTFParser} parser\r\n   * @return {Promise<BufferGeometry>}\r\n   */\r\n  function addPrimitiveAttributes(geometry, primitiveDef, parser) {\r\n    var attributes = primitiveDef.attributes;\r\n\r\n    var pending = [];\r\n\r\n    function assignAttributeAccessor(accessorIndex, attributeName) {\r\n      return parser.getDependency('accessor', accessorIndex).then(function (accessor) {\r\n        geometry.setAttribute(attributeName, accessor);\r\n      });\r\n    }\r\n\r\n    for (var gltfAttributeName in attributes) {\r\n      var threeAttributeName = ATTRIBUTES[gltfAttributeName] || gltfAttributeName.toLowerCase();\r\n\r\n      // Skip attributes already provided by e.g. Draco extension.\r\n      if (threeAttributeName in geometry.attributes) continue;\r\n\r\n      pending.push(assignAttributeAccessor(attributes[gltfAttributeName], threeAttributeName));\r\n    }\r\n\r\n    if (primitiveDef.indices !== undefined && !geometry.index) {\r\n      var accessor = parser\r\n        .getDependency('accessor', primitiveDef.indices)\r\n        .then(function (accessor) {\r\n          geometry.setIndex(accessor);\r\n        });\r\n\r\n      pending.push(accessor);\r\n    }\r\n\r\n    assignExtrasToUserData(geometry, primitiveDef);\r\n\r\n    computeBounds(geometry, primitiveDef, parser);\r\n\r\n    return Promise.all(pending).then(function () {\r\n      return primitiveDef.targets !== undefined\r\n        ? addMorphTargets(geometry, primitiveDef.targets, parser)\r\n        : geometry;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * @param {BufferGeometry} geometry\r\n   * @param {Number} drawMode\r\n   * @return {BufferGeometry}\r\n   */\r\n  function toTrianglesDrawMode(geometry, drawMode) {\r\n    var index = geometry.getIndex();\r\n\r\n    // generate index if not present\r\n\r\n    if (index === null) {\r\n      var indices = [];\r\n\r\n      var position = geometry.getAttribute('position');\r\n\r\n      if (position !== undefined) {\r\n        for (var i = 0; i < position.count; i++) {\r\n          indices.push(i);\r\n        }\r\n\r\n        geometry.setIndex(indices);\r\n        index = geometry.getIndex();\r\n      } else {\r\n        console.error(\r\n          'THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible.'\r\n        );\r\n        return geometry;\r\n      }\r\n    }\r\n\r\n    //\r\n\r\n    var numberOfTriangles = index.count - 2;\r\n    var newIndices = [];\r\n\r\n    if (drawMode === TriangleFanDrawMode) {\r\n      // gl.TRIANGLE_FAN\r\n\r\n      for (var i = 1; i <= numberOfTriangles; i++) {\r\n        newIndices.push(index.getX(0));\r\n        newIndices.push(index.getX(i));\r\n        newIndices.push(index.getX(i + 1));\r\n      }\r\n    } else {\r\n      // gl.TRIANGLE_STRIP\r\n\r\n      for (var i = 0; i < numberOfTriangles; i++) {\r\n        if (i % 2 === 0) {\r\n          newIndices.push(index.getX(i));\r\n          newIndices.push(index.getX(i + 1));\r\n          newIndices.push(index.getX(i + 2));\r\n        } else {\r\n          newIndices.push(index.getX(i + 2));\r\n          newIndices.push(index.getX(i + 1));\r\n          newIndices.push(index.getX(i));\r\n        }\r\n      }\r\n    }\r\n\r\n    if (newIndices.length / 3 !== numberOfTriangles) {\r\n      console.error(\r\n        'THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.'\r\n      );\r\n    }\r\n\r\n    // build final geometry\r\n\r\n    var newGeometry = geometry.clone();\r\n    newGeometry.setIndex(newIndices);\r\n\r\n    return newGeometry;\r\n  }\r\n\r\n  /**\r\n   * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#geometry\r\n   *\r\n   * Creates BufferGeometries from primitives.\r\n   *\r\n   * @param {Array<GLTF.Primitive>} primitives\r\n   * @return {Promise<Array<BufferGeometry>>}\r\n   */\r\n  GLTFParser.prototype.loadGeometries = function (primitives) {\r\n    var parser = this;\r\n    var extensions = this.extensions;\r\n    var cache = this.primitiveCache;\r\n\r\n    function createDracoPrimitive(primitive) {\r\n      return extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION]\r\n        .decodePrimitive(primitive, parser)\r\n        .then(function (geometry) {\r\n          return addPrimitiveAttributes(geometry, primitive, parser);\r\n        });\r\n    }\r\n\r\n    var pending = [];\r\n\r\n    for (var i = 0, il = primitives.length; i < il; i++) {\r\n      var primitive = primitives[i];\r\n      var cacheKey = createPrimitiveKey(primitive);\r\n\r\n      // See if we've already created this geometry\r\n      var cached = cache[cacheKey];\r\n\r\n      if (cached) {\r\n        // Use the cached geometry if it exists\r\n        pending.push(cached.promise);\r\n      } else {\r\n        var geometryPromise;\r\n\r\n        if (primitive.extensions && primitive.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION]) {\r\n          // Use DRACO geometry if available\r\n          geometryPromise = createDracoPrimitive(primitive);\r\n        } else {\r\n          // Otherwise create a new geometry\r\n          geometryPromise = addPrimitiveAttributes(new BufferGeometry(), primitive, parser);\r\n        }\r\n\r\n        // Cache this geometry\r\n        cache[cacheKey] = { primitive: primitive, promise: geometryPromise };\r\n\r\n        pending.push(geometryPromise);\r\n      }\r\n    }\r\n\r\n    return Promise.all(pending);\r\n  };\r\n\r\n  /**\r\n   * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#meshes\r\n   * @param {number} meshIndex\r\n   * @return {Promise<Group|Mesh|SkinnedMesh>}\r\n   */\r\n  GLTFParser.prototype.loadMesh = function (meshIndex) {\r\n    var parser = this;\r\n    var json = this.json;\r\n\r\n    var meshDef = json.meshes[meshIndex];\r\n    var primitives = meshDef.primitives;\r\n\r\n    var pending = [];\r\n\r\n    for (var i = 0, il = primitives.length; i < il; i++) {\r\n      var material =\r\n            primitives[i].material === undefined\r\n              ? createDefaultMaterial(this.cache)\r\n              : this.getDependency('material', primitives[i].material);\r\n\r\n      pending.push(material);\r\n    }\r\n\r\n    pending.push(parser.loadGeometries(primitives));\r\n\r\n    return Promise.all(pending).then(function (results) {\r\n      var materials = results.slice(0, results.length - 1);\r\n      var geometries = results[results.length - 1];\r\n\r\n      var meshes = [];\r\n\r\n      for (var i = 0, il = geometries.length; i < il; i++) {\r\n        var geometry = geometries[i];\r\n        var primitive = primitives[i];\r\n\r\n        // 1. create Mesh\r\n\r\n        var mesh;\r\n\r\n        var material = materials[i];\r\n\r\n        if (\r\n          primitive.mode === WEBGL_CONSTANTS.TRIANGLES ||\r\n          primitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP ||\r\n          primitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN ||\r\n          primitive.mode === undefined\r\n        ) {\r\n          // .isSkinnedMesh isn't in glTF spec. See .markDefs()\r\n          mesh =\r\n            meshDef.isSkinnedMesh === true\r\n              ? new SkinnedMesh(geometry, material)\r\n              : new Mesh(geometry, material);\r\n\r\n          if (mesh.isSkinnedMesh === true && !mesh.geometry.attributes.skinWeight.normalized) {\r\n            // we normalize floating point skin weight array to fix malformed assets (see #15319)\r\n            // it's important to skip this for non-float32 data since normalizeSkinWeights assumes non-normalized inputs\r\n            mesh.normalizeSkinWeights();\r\n          }\r\n\r\n          if (primitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP) {\r\n            mesh.geometry = toTrianglesDrawMode(mesh.geometry, TriangleStripDrawMode);\r\n          } else if (primitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN) {\r\n            mesh.geometry = toTrianglesDrawMode(mesh.geometry, TriangleFanDrawMode);\r\n          }\r\n        } else if (primitive.mode === WEBGL_CONSTANTS.LINES) {\r\n          mesh = new LineSegments(geometry, material);\r\n        } else if (primitive.mode === WEBGL_CONSTANTS.LINE_STRIP) {\r\n          mesh = new Line(geometry, material);\r\n        } else if (primitive.mode === WEBGL_CONSTANTS.LINE_LOOP) {\r\n          mesh = new LineLoop(geometry, material);\r\n        } else if (primitive.mode === WEBGL_CONSTANTS.POINTS) {\r\n          mesh = new Points(geometry, material);\r\n        } else {\r\n          throw new Error('THREE.GLTFLoader: Primitive mode unsupported: ' + primitive.mode);\r\n        }\r\n\r\n        if (Object.keys(mesh.geometry.morphAttributes).length > 0) {\r\n          updateMorphTargets(mesh, meshDef);\r\n        }\r\n\r\n        mesh.name = meshDef.name || 'mesh_' + meshIndex;\r\n\r\n        if (geometries.length > 1) mesh.name += '_' + i;\r\n\r\n        assignExtrasToUserData(mesh, meshDef);\r\n\r\n        parser.assignFinalMaterial(mesh);\r\n\r\n        meshes.push(mesh);\r\n      }\r\n\r\n      if (meshes.length === 1) {\r\n        return meshes[0];\r\n      }\r\n\r\n      var group = new Group();\r\n\r\n      for (var i = 0, il = meshes.length; i < il; i++) {\r\n        group.add(meshes[i]);\r\n      }\r\n\r\n      return group;\r\n    });\r\n  };\r\n\r\n  /**\r\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#cameras\r\n   * @param {number} cameraIndex\r\n   * @return {Promise<THREE.Camera>}\r\n   */\r\n  GLTFParser.prototype.loadCamera = function (cameraIndex) {\r\n    var camera;\r\n    var cameraDef = this.json.cameras[cameraIndex];\r\n    var params = cameraDef[cameraDef.type];\r\n\r\n    if (!params) {\r\n      console.warn('THREE.GLTFLoader: Missing camera parameters.');\r\n      return;\r\n    }\r\n\r\n    if (cameraDef.type === 'perspective') {\r\n      camera = new PerspectiveCamera(\r\n        MathUtils.radToDeg(params.yfov),\r\n        params.aspectRatio || 1,\r\n        params.znear || 1,\r\n        params.zfar || 2e6\r\n      );\r\n    } else if (cameraDef.type === 'orthographic') {\r\n      camera = new OrthographicCamera(\r\n        -params.xmag,\r\n        params.xmag,\r\n        params.ymag,\r\n        -params.ymag,\r\n        params.znear,\r\n        params.zfar\r\n      );\r\n    }\r\n\r\n    if (cameraDef.name) camera.name = cameraDef.name;\r\n\r\n    assignExtrasToUserData(camera, cameraDef);\r\n\r\n    return Promise.resolve(camera);\r\n  };\r\n\r\n  /**\r\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#skins\r\n   * @param {number} skinIndex\r\n   * @return {Promise<Object>}\r\n   */\r\n  GLTFParser.prototype.loadSkin = function (skinIndex) {\r\n    var skinDef = this.json.skins[skinIndex];\r\n\r\n    var skinEntry = { joints: skinDef.joints };\r\n\r\n    if (skinDef.inverseBindMatrices === undefined) {\r\n      return Promise.resolve(skinEntry);\r\n    }\r\n\r\n    return this.getDependency('accessor', skinDef.inverseBindMatrices).then(function (accessor) {\r\n      skinEntry.inverseBindMatrices = accessor;\r\n\r\n      return skinEntry;\r\n    });\r\n  };\r\n\r\n  /**\r\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#animations\r\n   * @param {number} animationIndex\r\n   * @return {Promise<AnimationClip>}\r\n   */\r\n  GLTFParser.prototype.loadAnimation = function (animationIndex) {\r\n    var json = this.json;\r\n\r\n    var animationDef = json.animations[animationIndex];\r\n\r\n    var pendingNodes = [];\r\n    var pendingInputAccessors = [];\r\n    var pendingOutputAccessors = [];\r\n    var pendingSamplers = [];\r\n    var pendingTargets = [];\r\n\r\n    for (var i = 0, il = animationDef.channels.length; i < il; i++) {\r\n      var channel = animationDef.channels[i];\r\n      var sampler = animationDef.samplers[channel.sampler];\r\n      var target = channel.target;\r\n      var name = target.node !== undefined ? target.node : target.id; // NOTE: target.id is deprecated.\r\n      var input =\r\n            animationDef.parameters !== undefined\r\n              ? animationDef.parameters[sampler.input]\r\n              : sampler.input;\r\n      var output =\r\n            animationDef.parameters !== undefined\r\n              ? animationDef.parameters[sampler.output]\r\n              : sampler.output;\r\n\r\n      pendingNodes.push(this.getDependency('node', name));\r\n      pendingInputAccessors.push(this.getDependency('accessor', input));\r\n      pendingOutputAccessors.push(this.getDependency('accessor', output));\r\n      pendingSamplers.push(sampler);\r\n      pendingTargets.push(target);\r\n    }\r\n\r\n    return Promise.all([\r\n      Promise.all(pendingNodes),\r\n      Promise.all(pendingInputAccessors),\r\n      Promise.all(pendingOutputAccessors),\r\n      Promise.all(pendingSamplers),\r\n      Promise.all(pendingTargets),\r\n    ]).then(function (dependencies) {\r\n      var nodes = dependencies[0];\r\n      var inputAccessors = dependencies[1];\r\n      var outputAccessors = dependencies[2];\r\n      var samplers = dependencies[3];\r\n      var targets = dependencies[4];\r\n\r\n      var tracks = [];\r\n\r\n      for (var i = 0, il = nodes.length; i < il; i++) {\r\n        var node = nodes[i];\r\n        var inputAccessor = inputAccessors[i];\r\n        var outputAccessor = outputAccessors[i];\r\n        var sampler = samplers[i];\r\n        var target = targets[i];\r\n\r\n        if (node === undefined) continue;\r\n\r\n        node.updateMatrix();\r\n        node.matrixAutoUpdate = true;\r\n\r\n        var TypedKeyframeTrack;\r\n\r\n        switch (PATH_PROPERTIES[target.path]) {\r\n          case PATH_PROPERTIES.weights:\r\n            TypedKeyframeTrack = NumberKeyframeTrack;\r\n            break;\r\n\r\n          case PATH_PROPERTIES.rotation:\r\n            TypedKeyframeTrack = QuaternionKeyframeTrack;\r\n            break;\r\n\r\n          case PATH_PROPERTIES.position:\r\n          case PATH_PROPERTIES.scale:\r\n          default:\r\n            TypedKeyframeTrack = VectorKeyframeTrack;\r\n            break;\r\n        }\r\n\r\n        var targetName = node.name ? node.name : node.uuid;\r\n\r\n        var interpolation =\r\n              sampler.interpolation !== undefined\r\n                ? INTERPOLATION[sampler.interpolation]\r\n                : InterpolateLinear;\r\n\r\n        var targetNames = [];\r\n\r\n        if (PATH_PROPERTIES[target.path] === PATH_PROPERTIES.weights) {\r\n          // Node may be a Group (glTF mesh with several primitives) or a Mesh.\r\n          node.traverse(function (object) {\r\n            if (object.isMesh === true && object.morphTargetInfluences) {\r\n              targetNames.push(object.name ? object.name : object.uuid);\r\n            }\r\n          });\r\n        } else {\r\n          targetNames.push(targetName);\r\n        }\r\n\r\n        var outputArray = outputAccessor.array;\r\n\r\n        if (outputAccessor.normalized) {\r\n          var scale;\r\n\r\n          if (outputArray.constructor === Int8Array) {\r\n            scale = 1 / 127;\r\n          } else if (outputArray.constructor === Uint8Array) {\r\n            scale = 1 / 255;\r\n          } else if (outputArray.constructor == Int16Array) {\r\n            scale = 1 / 32767;\r\n          } else if (outputArray.constructor === Uint16Array) {\r\n            scale = 1 / 65535;\r\n          } else {\r\n            throw new Error('THREE.GLTFLoader: Unsupported output accessor component type.');\r\n          }\r\n\r\n          var scaled = new Float32Array(outputArray.length);\r\n\r\n          for (var j = 0, jl = outputArray.length; j < jl; j++) {\r\n            scaled[j] = outputArray[j] * scale;\r\n          }\r\n\r\n          outputArray = scaled;\r\n        }\r\n\r\n        for (var j = 0, jl = targetNames.length; j < jl; j++) {\r\n          var track = new TypedKeyframeTrack(\r\n            targetNames[j] + '.' + PATH_PROPERTIES[target.path],\r\n            inputAccessor.array,\r\n            outputArray,\r\n            interpolation\r\n          );\r\n\r\n          // Override interpolation with custom factory method.\r\n          if (sampler.interpolation === 'CUBICSPLINE') {\r\n            track.createInterpolant = function InterpolantFactoryMethodGLTFCubicSpline(result) {\r\n              // A CUBICSPLINE keyframe in glTF has three output values for each input value,\r\n              // representing inTangent, splineVertex, and outTangent. As a result, track.getValueSize()\r\n              // must be divided by three to get the interpolant's sampleSize argument.\r\n\r\n              return new GLTFCubicSplineInterpolant(\r\n                this.times,\r\n                this.values,\r\n                this.getValueSize() / 3,\r\n                result\r\n              );\r\n            };\r\n\r\n            // Mark as CUBICSPLINE. `track.getInterpolation()` doesn't support custom interpolants.\r\n            track.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline = true;\r\n          }\r\n\r\n          tracks.push(track);\r\n        }\r\n      }\r\n\r\n      var name = animationDef.name ? animationDef.name : 'animation_' + animationIndex;\r\n\r\n      return new AnimationClip(name, undefined, tracks);\r\n    });\r\n  };\r\n\r\n  /**\r\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#nodes-and-hierarchy\r\n   * @param {number} nodeIndex\r\n   * @return {Promise<Object3D>}\r\n   */\r\n  GLTFParser.prototype.loadNode = function (nodeIndex) {\r\n    var json = this.json;\r\n    var extensions = this.extensions;\r\n    var parser = this;\r\n\r\n    var meshReferences = json.meshReferences;\r\n    var meshUses = json.meshUses;\r\n\r\n    var nodeDef = json.nodes[nodeIndex];\r\n\r\n    return (function () {\r\n      var pending = [];\r\n\r\n      if (nodeDef.mesh !== undefined) {\r\n        pending.push(\r\n          parser.getDependency('mesh', nodeDef.mesh).then(function (mesh) {\r\n            var node;\r\n\r\n            if (meshReferences[nodeDef.mesh] > 1) {\r\n              var instanceNum = meshUses[nodeDef.mesh]++;\r\n\r\n              node = mesh.clone();\r\n              node.name += '_instance_' + instanceNum;\r\n            } else {\r\n              node = mesh;\r\n            }\r\n\r\n            // if weights are provided on the node, override weights on the mesh.\r\n            if (nodeDef.weights !== undefined) {\r\n              node.traverse(function (o) {\r\n                if (!o.isMesh) return;\r\n\r\n                for (var i = 0, il = nodeDef.weights.length; i < il; i++) {\r\n                  o.morphTargetInfluences[i] = nodeDef.weights[i];\r\n                }\r\n              });\r\n            }\r\n\r\n            return node;\r\n          })\r\n        );\r\n      }\r\n\r\n      if (nodeDef.camera !== undefined) {\r\n        pending.push(parser.getDependency('camera', nodeDef.camera));\r\n      }\r\n\r\n      if (\r\n        nodeDef.extensions &&\r\n        nodeDef.extensions[EXTENSIONS.KHR_LIGHTS_PUNCTUAL] &&\r\n        nodeDef.extensions[EXTENSIONS.KHR_LIGHTS_PUNCTUAL].light !== undefined\r\n      ) {\r\n        pending.push(\r\n          parser.getDependency('light', nodeDef.extensions[EXTENSIONS.KHR_LIGHTS_PUNCTUAL].light)\r\n        );\r\n      }\r\n\r\n      return Promise.all(pending);\r\n    })().then(function (objects) {\r\n      var node;\r\n\r\n      // .isBone isn't in glTF spec. See .markDefs\r\n      if (nodeDef.isBone === true) {\r\n        node = new Bone();\r\n      } else if (objects.length > 1) {\r\n        node = new Group();\r\n      } else if (objects.length === 1) {\r\n        node = objects[0];\r\n      } else {\r\n        node = new Object3D();\r\n      }\r\n\r\n      if (node !== objects[0]) {\r\n        for (var i = 0, il = objects.length; i < il; i++) {\r\n          node.add(objects[i]);\r\n        }\r\n      }\r\n\r\n      if (nodeDef.name) {\r\n        node.userData.name = nodeDef.name;\r\n        node.name = PropertyBinding.sanitizeNodeName(nodeDef.name);\r\n      }\r\n\r\n      assignExtrasToUserData(node, nodeDef);\r\n\r\n      if (nodeDef.extensions) addUnknownExtensionsToUserData(extensions, node, nodeDef);\r\n\r\n      if (nodeDef.matrix !== undefined) {\r\n        var matrix = new Matrix4();\r\n        matrix.fromArray(nodeDef.matrix);\r\n        node.applyMatrix4(matrix);\r\n      } else {\r\n        if (nodeDef.translation !== undefined) {\r\n          node.position.fromArray(nodeDef.translation);\r\n        }\r\n\r\n        if (nodeDef.rotation !== undefined) {\r\n          node.quaternion.fromArray(nodeDef.rotation);\r\n        }\r\n\r\n        if (nodeDef.scale !== undefined) {\r\n          node.scale.fromArray(nodeDef.scale);\r\n        }\r\n      }\r\n\r\n      return node;\r\n    });\r\n  };\r\n\r\n  /**\r\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#scenes\r\n   * @param {number} sceneIndex\r\n   * @return {Promise<Group>}\r\n   */\r\n  GLTFParser.prototype.loadScene = (function () {\r\n    // scene node hierachy builder\r\n\r\n    function buildNodeHierachy(nodeId, parentObject, json, parser) {\r\n      var nodeDef = json.nodes[nodeId];\r\n\r\n      return parser\r\n        .getDependency('node', nodeId)\r\n        .then(function (node) {\r\n          if (nodeDef.skin === undefined) return node;\r\n\r\n          // build skeleton here as well\r\n\r\n          var skinEntry;\r\n\r\n          return parser\r\n            .getDependency('skin', nodeDef.skin)\r\n            .then(function (skin) {\r\n              skinEntry = skin;\r\n\r\n              var pendingJoints = [];\r\n\r\n              for (var i = 0, il = skinEntry.joints.length; i < il; i++) {\r\n                pendingJoints.push(parser.getDependency('node', skinEntry.joints[i]));\r\n              }\r\n\r\n              return Promise.all(pendingJoints);\r\n            })\r\n            .then(function (jointNodes) {\r\n              node.traverse(function (mesh) {\r\n                if (!mesh.isMesh) return;\r\n\r\n                var bones = [];\r\n                var boneInverses = [];\r\n\r\n                for (var j = 0, jl = jointNodes.length; j < jl; j++) {\r\n                  var jointNode = jointNodes[j];\r\n\r\n                  if (jointNode) {\r\n                    bones.push(jointNode);\r\n\r\n                    var mat = new Matrix4();\r\n\r\n                    if (skinEntry.inverseBindMatrices !== undefined) {\r\n                      mat.fromArray(skinEntry.inverseBindMatrices.array, j * 16);\r\n                    }\r\n\r\n                    boneInverses.push(mat);\r\n                  } else {\r\n                    console.warn(\r\n                      'THREE.GLTFLoader: Joint \"%s\" could not be found.',\r\n                      skinEntry.joints[j]\r\n                    );\r\n                  }\r\n                }\r\n\r\n                mesh.bind(new Skeleton(bones, boneInverses), mesh.matrixWorld);\r\n              });\r\n\r\n              return node;\r\n            });\r\n        })\r\n        .then(function (node) {\r\n          // build node hierachy\r\n\r\n          parentObject.add(node);\r\n\r\n          var pending = [];\r\n\r\n          if (nodeDef.children) {\r\n            var children = nodeDef.children;\r\n\r\n            for (var i = 0, il = children.length; i < il; i++) {\r\n              var child = children[i];\r\n              pending.push(buildNodeHierachy(child, node, json, parser));\r\n            }\r\n          }\r\n\r\n          return Promise.all(pending);\r\n        });\r\n    }\r\n\r\n    return function loadScene(sceneIndex) {\r\n      var json = this.json;\r\n      var extensions = this.extensions;\r\n      var sceneDef = this.json.scenes[sceneIndex];\r\n      var parser = this;\r\n\r\n      // Loader returns Group, not Scene.\r\n      // See: https://github.com/mrdoob/three.js/issues/18342#issuecomment-578981172\r\n      var scene = new Group();\r\n      if (sceneDef.name) scene.name = sceneDef.name;\r\n\r\n      assignExtrasToUserData(scene, sceneDef);\r\n\r\n      if (sceneDef.extensions) addUnknownExtensionsToUserData(extensions, scene, sceneDef);\r\n\r\n      var nodeIds = sceneDef.nodes || [];\r\n\r\n      var pending = [];\r\n\r\n      for (var i = 0, il = nodeIds.length; i < il; i++) {\r\n        pending.push(buildNodeHierachy(nodeIds[i], scene, json, parser));\r\n      }\r\n\r\n      return Promise.all(pending).then(function () {\r\n        return scene;\r\n      });\r\n    };\r\n  })();\r\n\r\n  return GLTFLoader;\r\n})();\r\n\r\nexport { GLTFLoader };\r\n","import Config from '../../data/config';\r\n\r\n// Manages all dat.GUI interactions\r\nexport default class DatGUI {\r\n  constructor(main) {\r\n    this.gui = new dat.GUI();\r\n\r\n    this.camera = main.camera.threeCamera;\r\n    this.controls = main.controls.threeControls;\r\n    this.light = main.light;\r\n    this.scene = main.scene;\r\n\r\n    this.model = null;\r\n    this.meshHelper = null;\r\n  }\r\n\r\n  load(main, mesh) {\r\n    /* Global */\r\n    //this.gui.close();\r\n\r\n    this.model = main.model;\r\n    this.meshHelper = main.meshHelper;\r\n\r\n    /* Camera */\r\n    const cameraFolder = this.gui.addFolder('Camera');\r\n    const cameraFOVGui = cameraFolder.add(Config.camera, 'fov', 0, 180).name('Camera FOV');\r\n    cameraFOVGui.onChange((value) => {\r\n      this.controls.enableRotate = false;\r\n\r\n      this.camera.fov = value;\r\n    });\r\n    cameraFOVGui.onFinishChange(() => {\r\n      this.camera.updateProjectionMatrix();\r\n\r\n      this.controls.enableRotate = true;\r\n    });\r\n    const cameraAspectGui = cameraFolder.add(Config.camera, 'aspect', 0, 4).name('Camera Aspect');\r\n    cameraAspectGui.onChange((value) => {\r\n      this.controls.enableRotate = false;\r\n\r\n      this.camera.aspect = value;\r\n    });\r\n    cameraAspectGui.onFinishChange(() => {\r\n      this.camera.updateProjectionMatrix();\r\n\r\n      this.controls.enableRotate = true;\r\n    });\r\n    const cameraFogColorGui = cameraFolder.addColor(Config.fog, 'color').name('Fog Color');\r\n    cameraFogColorGui.onChange((value) => {\r\n      this.scene.fog.color.setHex(value);\r\n    });\r\n    const cameraFogNearGui = cameraFolder.add(Config.fog, 'near', 0.000, 0.010).name('Fog Near');\r\n    cameraFogNearGui.onChange((value) => {\r\n      this.controls.enableRotate = false;\r\n\r\n      this.scene.fog.density = value;\r\n    });\r\n    cameraFogNearGui.onFinishChange(() => {\r\n      this.controls.enableRotate = true;\r\n    });\r\n\r\n\r\n    /* Controls */\r\n    const controlsFolder = this.gui.addFolder('Controls');\r\n    controlsFolder.add(Config.controls, 'autoRotate').name('Auto Rotate').onChange((value) => {\r\n      this.controls.autoRotate = value;\r\n    });\r\n    const controlsAutoRotateSpeedGui = controlsFolder.add(Config.controls, 'autoRotateSpeed', -1, 1).name('Rotation Speed');\r\n    controlsAutoRotateSpeedGui.onChange((value) => {\r\n      this.controls.enableRotate = false;\r\n      this.controls.autoRotateSpeed = value;\r\n    });\r\n    controlsAutoRotateSpeedGui.onFinishChange(() => {\r\n      this.controls.enableRotate = true;\r\n    });\r\n\r\n\r\n    /* Model */\r\n    const modelFolder = this.gui.addFolder('Model');\r\n    modelFolder.add(Config.model, 'type', [...Config.model.initialTypes]).name('Select Model').onChange((value) => {\r\n      if (value) {\r\n        if (Config.mesh.enableHelper)\r\n          this.meshHelper.disable();\r\n\r\n        Config.model.selected = Config.model.initialTypes.indexOf(value);\r\n        this.unload();\r\n        this.model.unload();\r\n        this.model.load(value);\r\n      }\r\n    });\r\n\r\n    /* Mesh */\r\n    const meshFolder = this.gui.addFolder('Mesh');\r\n    meshFolder.add(Config.mesh, 'enableHelper', true).name('Enable Helpers').onChange((value) => {\r\n      if(value) {\r\n        this.meshHelper.enable();\r\n      } else {\r\n        this.meshHelper.disable();\r\n      }\r\n    });\r\n    meshFolder.add(Config.mesh, 'translucent', true).name('Translucent').onChange((value) => {\r\n      if(value) {\r\n        mesh.material.transparent = true;\r\n        mesh.material.opacity = 0.5;\r\n      } else {\r\n        mesh.material.opacity = 1.0;\r\n      }\r\n    });\r\n    meshFolder.add(Config.mesh, 'wireframe', true).name('Wireframe').onChange((value) => {\r\n      mesh.material.wireframe = value;\r\n    });\r\n\r\n\r\n    /* Lights */\r\n    // Ambient Light\r\n    const ambientLightFolder = this.gui.addFolder('Ambient Light');\r\n    ambientLightFolder.add(Config.ambientLight, 'enabled').name('Enabled').onChange((value) => {\r\n      this.light.ambientLight.visible = value;\r\n    });\r\n    ambientLightFolder.addColor(Config.ambientLight, 'color').name('Color').onChange((value) => {\r\n      this.light.ambientLight.color.setHex(value);\r\n    });\r\n\r\n\r\n    // Directional Light\r\n    const directionalLightFolder = this.gui.addFolder('Directional Light');\r\n    directionalLightFolder.add(Config.directionalLight, 'enabled').name('Enabled').onChange((value) => {\r\n      this.light.directionalLight.visible = value;\r\n    });\r\n    directionalLightFolder.addColor(Config.directionalLight, 'color').name('Color').onChange((value) => {\r\n      this.light.directionalLight.color.setHex(value);\r\n    });\r\n    const directionalLightIntensityGui = directionalLightFolder.add(Config.directionalLight, 'intensity', 0, 2).name('Intensity');\r\n    directionalLightIntensityGui.onChange((value) => {\r\n      this.controls.enableRotate = false;\r\n\r\n      this.light.directionalLight.intensity = value;\r\n    });\r\n    directionalLightIntensityGui.onFinishChange(() => {\r\n      this.controls.enableRotate = true;\r\n    });\r\n    const directionalLightPositionXGui = directionalLightFolder.add(Config.directionalLight, 'x', -1000, 1000).name('Position X');\r\n    directionalLightPositionXGui.onChange((value) => {\r\n      this.controls.enableRotate = false;\r\n\r\n      this.light.directionalLight.position.x = value;\r\n    });\r\n    directionalLightPositionXGui.onFinishChange(() => {\r\n      this.controls.enableRotate = true;\r\n    });\r\n    const directionalLightPositionYGui = directionalLightFolder.add(Config.directionalLight, 'y', -1000, 1000).name('Position Y');\r\n    directionalLightPositionYGui.onChange((value) => {\r\n      this.controls.enableRotate = false;\r\n\r\n      this.light.directionalLight.position.y = value;\r\n    });\r\n    directionalLightPositionYGui.onFinishChange(() => {\r\n      this.controls.enableRotate = true;\r\n    });\r\n    const directionalLightPositionZGui = directionalLightFolder.add(Config.directionalLight, 'z', -1000, 1000).name('Position Z');\r\n    directionalLightPositionZGui.onChange((value) => {\r\n      this.controls.enableRotate = false;\r\n\r\n      this.light.directionalLight.position.z = value;\r\n    });\r\n    directionalLightPositionZGui.onFinishChange(() => {\r\n      this.controls.enableRotate = true;\r\n    });\r\n\r\n    // Shadow Map\r\n    const shadowFolder = this.gui.addFolder('Shadow Map');\r\n    shadowFolder.add(Config.shadow, 'enabled').name('Enabled').onChange((value) => {\r\n      this.light.directionalLight.castShadow = value;\r\n    });\r\n    shadowFolder.add(Config.shadow, 'helperEnabled').name('Helper Enabled').onChange((value) => {\r\n      this.light.directionalLightHelper.visible = value;\r\n    });\r\n    const shadowNearGui = shadowFolder.add(Config.shadow, 'near', 0, 400).name('Near');\r\n    shadowNearGui.onChange((value) => {\r\n      this.controls.enableRotate = false;\r\n\r\n      this.light.directionalLight.shadow.camera.near = value;\r\n    });\r\n    shadowNearGui.onFinishChange(() => {\r\n      this.controls.enableRotate = true;\r\n      this.light.directionalLight.shadow.map.dispose();\r\n      this.light.directionalLight.shadow.map = null;\r\n      this.light.directionalLightHelper.update();\r\n    });\r\n    const shadowFarGui = shadowFolder.add(Config.shadow, 'far', 0, 1200).name('Far');\r\n    shadowFarGui.onChange((value) => {\r\n      this.controls.enableRotate = false;\r\n\r\n      this.light.directionalLight.shadow.camera.far = value;\r\n    });\r\n    shadowFarGui.onFinishChange(() => {\r\n      this.controls.enableRotate = true;\r\n      this.light.directionalLight.shadow.map.dispose();\r\n      this.light.directionalLight.shadow.map = null;\r\n      this.light.directionalLightHelper.update();\r\n    });\r\n    const shadowTopGui = shadowFolder.add(Config.shadow, 'top', -400, 400).name('Top');\r\n    shadowTopGui.onChange((value) => {\r\n      this.controls.enableRotate = false;\r\n\r\n      this.light.directionalLight.shadow.camera.top = value;\r\n    });\r\n    shadowTopGui.onFinishChange(() => {\r\n      this.controls.enableRotate = true;\r\n      this.light.directionalLight.shadow.map.dispose();\r\n      this.light.directionalLight.shadow.map = null;\r\n      this.light.directionalLightHelper.update();\r\n    });\r\n    const shadowRightGui = shadowFolder.add(Config.shadow, 'right', -400, 400).name('Right');\r\n    shadowRightGui.onChange((value) => {\r\n      this.controls.enableRotate = false;\r\n\r\n      this.light.directionalLight.shadow.camera.right = value;\r\n    });\r\n    shadowRightGui.onFinishChange(() => {\r\n      this.controls.enableRotate = true;\r\n      this.light.directionalLight.shadow.map.dispose();\r\n      this.light.directionalLight.shadow.map = null;\r\n      this.light.directionalLightHelper.update();\r\n    });\r\n    const shadowBottomGui = shadowFolder.add(Config.shadow, 'bottom', -400, 400).name('Bottom');\r\n    shadowBottomGui.onChange((value) => {\r\n      this.controls.enableRotate = false;\r\n\r\n      this.light.directionalLight.shadow.camera.bottom = value;\r\n    });\r\n    shadowBottomGui.onFinishChange(() => {\r\n      this.controls.enableRotate = true;\r\n      this.light.directionalLight.shadow.map.dispose();\r\n      this.light.directionalLight.shadow.map = null;\r\n      this.light.directionalLightHelper.update();\r\n    });\r\n    const shadowLeftGui = shadowFolder.add(Config.shadow, 'left', -400, 400).name('Left');\r\n    shadowLeftGui.onChange((value) => {\r\n      this.controls.enableRotate = false;\r\n\r\n      this.light.directionalLight.shadow.camera.left = value;\r\n    });\r\n    shadowLeftGui.onFinishChange(() => {\r\n      this.controls.enableRotate = true;\r\n      this.light.directionalLight.shadow.map.dispose();\r\n      this.light.directionalLight.shadow.map = null;\r\n      this.light.directionalLightHelper.update();\r\n    });\r\n    const shadowBiasGui = shadowFolder.add(Config.shadow, 'bias', -0.000010, 1).name('Bias');\r\n    shadowBiasGui.onChange((value) => {\r\n      this.controls.enableRotate = false;\r\n\r\n      this.light.directionalLight.shadow.bias = value;\r\n    });\r\n    shadowBiasGui.onFinishChange(() => {\r\n      this.controls.enableRotate = true;\r\n      this.light.directionalLight.shadow.map.dispose();\r\n      this.light.directionalLight.shadow.map = null;\r\n      this.light.directionalLightHelper.update();\r\n    });\r\n\r\n\r\n    // Point Light\r\n    const pointLightFolder = this.gui.addFolder('Point Light');\r\n    pointLightFolder.add(Config.pointLight, 'enabled').name('Enabled').onChange((value) => {\r\n      this.light.pointLight.visible = value;\r\n    });\r\n    pointLightFolder.addColor(Config.pointLight, 'color').name('Color').onChange((value) => {\r\n      this.light.pointLight.color.setHex(value);\r\n    });\r\n    const pointLightIntensityGui = pointLightFolder.add(Config.pointLight, 'intensity', 0, 2).name('Intensity');\r\n    pointLightIntensityGui.onChange((value) => {\r\n      this.controls.enableRotate = false;\r\n\r\n      this.light.pointLight.intensity = value;\r\n    });\r\n    pointLightIntensityGui.onFinishChange(() => {\r\n      this.controls.enableRotate = true;\r\n    });\r\n    const pointLightDistanceGui = pointLightFolder.add(Config.pointLight, 'distance', 0, 1000).name('Distance');\r\n    pointLightDistanceGui.onChange((value) => {\r\n      this.controls.enableRotate = false;\r\n\r\n      this.light.pointLight.distance = value;\r\n    });\r\n    pointLightDistanceGui.onFinishChange(() => {\r\n      this.controls.enableRotate = true;\r\n    });\r\n    const pointLightPositionXGui = pointLightFolder.add(Config.pointLight, 'x', -1000, 1000).name('Position X');\r\n    pointLightPositionXGui.onChange((value) => {\r\n      this.controls.enableRotate = false;\r\n\r\n      this.light.pointLight.position.x = value;\r\n    });\r\n    pointLightPositionXGui.onFinishChange(() => {\r\n      this.controls.enableRotate = true;\r\n    });\r\n    const pointLightPositionYGui = pointLightFolder.add(Config.pointLight, 'y', -1000, 1000).name('Position Y');\r\n    pointLightPositionYGui.onChange((value) => {\r\n      this.controls.enableRotate = false;\r\n\r\n      this.light.pointLight.position.y = value;\r\n    });\r\n    pointLightPositionYGui.onFinishChange(() => {\r\n      this.controls.enableRotate = true;\r\n    });\r\n    const pointLightPositionZGui = pointLightFolder.add(Config.pointLight, 'z', -1000, 1000).name('Position Z');\r\n    pointLightPositionZGui.onChange((value) => {\r\n      this.controls.enableRotate = false;\r\n\r\n      this.light.pointLight.position.z = value;\r\n    });\r\n    pointLightPositionZGui.onFinishChange(() => {\r\n      this.controls.enableRotate = true;\r\n    });\r\n\r\n\r\n    // Hemi Light\r\n    const hemiLightFolder = this.gui.addFolder('Hemi Light');\r\n    hemiLightFolder.add(Config.hemiLight, 'enabled').name('Enabled').onChange((value) => {\r\n      this.light.hemiLight.visible = value;\r\n    });\r\n    hemiLightFolder.addColor(Config.hemiLight, 'color').name('Color').onChange((value) => {\r\n      this.light.hemiLight.color.setHex(value);\r\n    });\r\n    hemiLightFolder.addColor(Config.hemiLight, 'groundColor').name('ground Color').onChange((value) => {\r\n      this.light.hemiLight.groundColor.setHex(value);\r\n    });\r\n    const hemiLightIntensityGui = hemiLightFolder.add(Config.hemiLight, 'intensity', 0, 2).name('Intensity');\r\n    hemiLightIntensityGui.onChange((value) => {\r\n      this.controls.enableRotate = false;\r\n\r\n      this.light.hemiLight.intensity = value;\r\n    });\r\n    hemiLightIntensityGui.onFinishChange(() => {\r\n      this.controls.enableRotate = true;\r\n    });\r\n    const hemiLightPositionXGui = hemiLightFolder.add(Config.hemiLight, 'x', -1000, 1000).name('Position X');\r\n    hemiLightPositionXGui.onChange((value) => {\r\n      this.controls.enableRotate = false;\r\n\r\n      this.light.hemiLight.position.x = value;\r\n    });\r\n    hemiLightPositionXGui.onFinishChange(() => {\r\n      this.controls.enableRotate = true;\r\n    });\r\n    const hemiLightPositionYGui = hemiLightFolder.add(Config.hemiLight, 'y', -500, 1000).name('Position Y');\r\n    hemiLightPositionYGui.onChange((value) => {\r\n      this.controls.enableRotate = false;\r\n\r\n      this.light.hemiLight.position.y = value;\r\n    });\r\n    hemiLightPositionYGui.onFinishChange(() => {\r\n      this.controls.enableRotate = true;\r\n    });\r\n    const hemiLightPositionZGui = hemiLightFolder.add(Config.hemiLight, 'z', -1000, 1000).name('Position Z');\r\n    hemiLightPositionZGui.onChange((value) => {\r\n      this.controls.enableRotate = false;\r\n\r\n      this.light.hemiLight.position.z = value;\r\n    });\r\n    hemiLightPositionZGui.onFinishChange(() => {\r\n      this.controls.enableRotate = true;\r\n    });\r\n  }\r\n\r\n  unload() {\r\n    this.gui.destroy();\r\n    this.gui = new dat.GUI();\r\n  }\r\n}\r\n","// Global imports -\r\nimport * as THREE from 'three';\r\nimport TWEEN from '@tweenjs/tween.js';\r\n\r\n// Local imports -\r\n// Components\r\nimport Renderer from './components/renderer';\r\nimport Camera from './components/camera';\r\nimport Light from './components/light';\r\nimport Controls from './components/controls';\r\nimport Geometry from './components/geometry';\r\n\r\nimport WalkMan from './components/walkman';\r\nimport Cinemachine from './components/cinemachine';\r\n\r\n// Helpers\r\nimport Stats from './helpers/stats';\r\nimport MeshHelper from './helpers/meshHelper';\r\n\r\n// Model\r\nimport Texture from './model/texture';\r\nimport Model from './model/model';\r\n\r\n// Managers\r\nimport Interaction from './managers/interaction';\r\nimport DatGUI from './managers/datGUI';\r\n\r\n// data\r\nimport Config from './../data/config';\r\nimport GlobalVars from './../data/globalVars';\r\n\r\n\r\n// -- End of imports\r\n\r\nlet vis = false;\r\nlet cam = 0;\r\nlet self = null;\r\n\r\n\r\n// This class instantiates and ties all of the components together, starts the loading process and renders the main loop\r\nexport default class Main {\r\n    constructor(container) {\r\n        // Set container property to container element\r\n        this.container = container;\r\n\r\n        // Start Three clock\r\n        this.clock = new THREE.Clock();\r\n\r\n        // Main scene creation\r\n        this.scene = new THREE.Scene();\r\n        this.scene.background = new THREE.Color( 0x1d2329 );\r\n        this.scene.fog = new THREE.FogExp2(Config.fog.color, Config.fog.near);\r\n\r\n        // Get Device Pixel Ratio first for retina\r\n        if(window.devicePixelRatio) {\r\n            Config.dpr = window.devicePixelRatio;\r\n        }\r\n\r\n        // Main renderer constructor\r\n        this.renderer = new Renderer(this.scene, container);\r\n\r\n        // Components instantiations\r\n        this.camera = new Camera(this.renderer.threeRenderer);\r\n        this.controls = new Controls(this.camera.threeCamera, container);\r\n        this.light = new Light(this.scene);\r\n        this.currentCam = this.camera.threeCamera;\r\n\r\n        // Create and place lights in scene\r\n        const lights = ['ambient', 'directional', 'point', 'hemi'];\r\n        lights.forEach((light) => this.light.place(light));\r\n\r\n        // Create and place geo in scene\r\n        this.geometry = new Geometry(this.scene);\r\n        this.geometry.make('plane')(20, 20, 10, 10);\r\n        this.geometry.place([0, 0, 0], [Math.PI / 2, 0, 0]);\r\n\r\n\r\n        // Set up rStats if dev environment\r\n        if(Config.isDev && Config.isShowingStats) {\r\n            this.stats = new Stats(this.renderer);\r\n            this.stats.setUp();\r\n        }\r\n\r\n        // Set up gui\r\n        if (Config.isDev) {\r\n            this.gui = new DatGUI(this)\r\n            Config.isLoaded = true;\r\n            this.container.querySelector('#loading').style.display = 'none';\r\n        }\r\n\r\n        this.man = new THREE.Object3D();\r\n        //--------\r\n        this.man_chido = new WalkMan(this.man);\r\n\r\n        // this.mans = [];\r\n        // for (let i = 0; i < 10; i++) {\r\n        //     this.mans.push( new WalkMan(this.man));\r\n        //     this.mans[i]._waist.obj.position.add(new THREE.Vector3((i+1)*5, 0, 0));\r\n        // }\r\n\r\n        this.man.position.set(0, -20, 0);\r\n        this.man.add(this.man_chido);\r\n\r\n        this.superman = new THREE.Object3D();\r\n        this.superman.add(this.man);\r\n\r\n        this.scene.add(this.superman);\r\n\r\n        self = this;\r\n        //--------\r\n        this.man2 = new THREE.Object3D();\r\n        this.manChido2 = new WalkMan(this.man2);\r\n        this.scene.add(this.man2);\r\n\r\n\r\n\r\n\r\n\r\n        const _donutGeo = new THREE.TorusGeometry( 25.5, 6, 16, 100 );\r\n        const material = new THREE.MeshBasicMaterial( { color: 0xfacfe5, wireframe: true } );\r\n        this.donut = new THREE.Mesh( _donutGeo, material );\r\n        this.scene.add(this.donut);\r\n\r\n        this.switchElmnts(vis);\r\n\r\n        //--------\r\n        this.cinemachine = new Cinemachine(this);\r\n\r\n\r\n        document.addEventListener('keydown', e => {\r\n\r\n            if(e.which == 83) this.switchV();\r\n            if(e.which == 67) this.switchCam();\r\n\r\n        });\r\n\r\n        // Start render which does not wait for model fully loaded\r\n        this.render();\r\n    }\r\n\r\n    render() {\r\n        // Render rStats if Dev\r\n        if(Config.isDev && Config.isShowingStats) {\r\n            Stats.start();\r\n        }\r\n\r\n        // Call render function and pass in created scene and camera\r\n        this.renderer.render(this.scene, this.currentCam);\r\n\r\n        // rStats has finished determining render call now\r\n        if(Config.isDev && Config.isShowingStats) {\r\n            Stats.end();\r\n        }\r\n\r\n        // Delta time is sometimes needed for certain updates\r\n        //const delta = this.clock.getDelta();\r\n\r\n        this.superman.rotation.z = -GlobalVars.t/6;\r\n        this.man_chido.update();\r\n\r\n\r\n        this.manChido2.update();\r\n\r\n        GlobalVars.t+= 0.125;\r\n\r\n        // Call any vendor or module frame updates here\r\n        TWEEN.update();\r\n        this.cinemachine.update();\r\n        this.controls.threeControls.update();\r\n\r\n\r\n        // RAF\r\n        requestAnimationFrame(this.render.bind(this)); // Bind the main class instead of window object\r\n    }\r\n\r\n    switchV () {\r\n        vis = !vis;\r\n        self.switchElmnts(vis);\r\n    }\r\n\r\n    switchElmnts(state){\r\n\r\n        this.man.visible = !state;\r\n        this.donut.visible = !state;\r\n\r\n        this.man2.visible = state;\r\n        this.geometry.mesh.visible = state;\r\n\r\n    }\r\n\r\n    switchCam(){\r\n\r\n        cam++;\r\n        cam = cam % 2;\r\n\r\n        switch (cam) {\r\n\r\n            default:\r\n            case 0:\r\n                this.currentCam = this.camera.threeCamera;\r\n                break;\r\n\r\n            case 1:\r\n                this.currentCam = this.cinemachine.cam;\r\n                break;\r\n        }\r\n    }\r\n\r\n}\r\n","import * as THREE from 'three';\r\n\r\nimport $ from 'jquery';\r\n\r\nconst info = 'Oprime la tecla [S] para cambiar de escena';\r\nconst info2 = '</br> Oprime la tecla [C] para cambiar de camara';\r\nconst info3 = '</br></br> Usa el mouse para desplazarte por la escena';\r\nconst t = info+info2+info3;\r\n\r\nexport default class UI {\r\n\r\n    constructor() {\r\n        $( document ).ready(() =>{\r\n\r\n            let infoDiv = $('<div class=\"infodiv\">')\r\n                .html(t)\r\n                .css({\r\n                    position: 'absolute',\r\n                    width: '350px',\r\n                    height: '50px',\r\n                    bottom: '0',\r\n                    left: '0',\r\n                    background: 'RGBA(34, 34, 34, 0.5)',\r\n                    color: 'white',\r\n                    padding: '20px'\r\n                });\r\n\r\n\r\n            $('body').append(infoDiv);\r\n\r\n        });\r\n    }\r\n}\r\n","import Config from './data/config';\r\nimport Detector from './utils/detector';\r\nimport Main from './app/main';\r\nimport UI from './app/components/ui';\r\n\r\n\r\n// Styles\r\nimport './../css/app.scss';\r\n\r\n// Check environment and set the Config helper\r\nif(__ENV__ === 'dev') {\r\n  console.log('----- RUNNING IN DEV ENVIRONMENT! -----');\r\n\r\n  Config.isDev = true;\r\n}\r\n\r\nfunction init() {\r\n  // Check for webGL capabilities\r\n  if(!Detector.webgl) {\r\n    Detector.addGetWebGLMessage();\r\n  } else {\r\n    const container = document.getElementById('appContainer');\r\n    new Main(container);\r\n    new UI();\r\n\r\n  }\r\n}\r\n\r\ninit();\r\n"],"sourceRoot":""}